<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="乘风破浪">
<meta property="og:type" content="website">
<meta property="og:title" content="小寒">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="小寒">
<meta property="og:description" content="乘风破浪">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小寒">
<meta name="twitter:description" content="乘风破浪">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>小寒</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">小寒</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-窝">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            窝
          </a>
        </li>
      
        
        <li class="menu-item menu-item-类">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-档">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-于">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/02/19/younontknowjs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/02/19/younontknowjs/" itemprop="url">younontknowjs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-02-19T10:36:26+08:00">
                2021-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/基础/" itemprop="url" rel="index">
                    <span itemprop="name">基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第一部分-作用域和闭包"><a href="#第一部分-作用域和闭包" class="headerlink" title="第一部分 作用域和闭包"></a><font color="#ffd11a">第一部分 作用域和闭包</font></h1><h2 id="作用域是什么"><a href="#作用域是什么" class="headerlink" title="作用域是什么"></a>作用域是什么</h2><p>   存储和访问变量的规则，称为作用域。</p>
<p>   一、  编译原理<br>   事实上，js是一门编译语言，但又与传统的编译语言不同，它不是提前编译的，编译结果也不能在分布式系统中进行移植。</p>
<p>   传统的而变异与雅安在执行前会经历三个步骤，统称为“编译”。<br>   1）分词/词法分析（Tokenizing/Lexing）<br>      这个过程是将由字符组成的字符串，分解成（对编程语言来说）有意义的代码块，这些代码块称为词法单元。例如：var a = 2;。会被分解成 var、  a、 =、 2、；具体空格是否会被解析成词法单元，取决于空格在这门语言中是否具有意义。<br>   2）解析/语法分析（Parsing）</p>
<h2 id="词法作用域"><a href="#词法作用域" class="headerlink" title="词法作用域"></a>词法作用域</h2><h2 id="函数作用域和块作用域"><a href="#函数作用域和块作用域" class="headerlink" title="函数作用域和块作用域"></a>函数作用域和块作用域</h2><h2 id="提升"><a href="#提升" class="headerlink" title="提升"></a>提升</h2><h2 id="作用域闭包"><a href="#作用域闭包" class="headerlink" title="作用域闭包"></a>作用域闭包</h2><h1 id="第二部分-this和对象原型"><a href="#第二部分-this和对象原型" class="headerlink" title="第二部分 this和对象原型"></a><font color="#ffd11a">第二部分 this和对象原型</font></h1><h2 id="关于-this"><a href="#关于-this" class="headerlink" title="关于 this"></a>关于 this</h2><h2 id="this全面解析"><a href="#this全面解析" class="headerlink" title="this全面解析"></a>this全面解析</h2><h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><h2 id="混合对象“类”"><a href="#混合对象“类”" class="headerlink" title="混合对象“类”"></a>混合对象“类”</h2><h2 id="原型"><a href="#原型" class="headerlink" title="原型"></a>原型</h2><h2 id="行为委托"><a href="#行为委托" class="headerlink" title="行为委托"></a>行为委托</h2><h1 id="第三部分-类型和语法"><a href="#第三部分-类型和语法" class="headerlink" title="第三部分 类型和语法"></a><font color="#ffd11a">第三部分 类型和语法</font></h1><h1 id="第四部分-异步和性能"><a href="#第四部分-异步和性能" class="headerlink" title="第四部分 异步和性能"></a><font color="#ffd11a">第四部分 异步和性能</font></h1><h2 id="异步：现在与将来"><a href="#异步：现在与将来" class="headerlink" title="异步：现在与将来"></a>异步：现在与将来</h2><p>   事实上，程序中现在运行和将来运行的部分之间的关系就是异步编程的核心。</p>
<p>   <font color="red">分块的程序</font><br>   最常见的块单位是函数。</p>
<p>   <font color="red">事件循环</font><br>   js引擎本身并没有时间的概念，只是一个按需执行js任意代码片段的环境。<br>   “事件”调度总是由包含它的环境进行。<br>   以Ajax回调举例，如果js程序发出一个Ajax请求，js引擎会通知宿主环境：‘hello，你一旦完成网络请求，拿到了数据，就请调用这个回调函数’。然后浏览器就会设置侦听来自网络的响应，拿到数据之后就会把回调函数插入到事件循环中，以此实现对这个回调的调度执行。</p>
<p>   <font color="red">并行线程</font><br>   异步和并行的意义完全是不同的。异步是关于现在和将来的时间间隙，而并行是关于能能够同时发生的事情。<br>   并行计算最常见的工具就是进程和线程。进程和线程独立运行，并可能同时运行：在不同的处理器，甚至不同的计算机上，但多个线程能够共享单个进程的内存。<br>   事件循环把自身的工作分成一个个任务并顺序执行，不允许对共享内存的并行访问和修改。通过分立线程中彼此合作的事件循环，并行和顺序执行可以共存。并行线程的交替执行和异步事件的交替调度，其粒度是完全不同的。<br>   js从不跨线程共享数据，这意味着不需要考虑这一层次的不确定性。但是这并不意味着js总是确定性的。<br>   在js的特性中，函数顺序带来的不确定性就是通常所说的“竞态条件”。</p>
<p>   <font color="red">并发</font><br>   并发是指两个或多个事件链随时间发展交替执行，以至于从更高的层次来看，就像是同时在运行（尽管在任意时刻只处理一个事件）。通常需要对并发的程序进行某种形式的交互协调，比如需要确保执行顺序或者需要防止竞态出现。</p>
<p>   <font color="red">任务队列</font><br>   对于任务队列最好的理解方式就是，它是挂在事件循环队列的每个tick之后的一个队列。在事件循环的每个tick中，可能出现的异步动作不会导致一个完整的新事件添加到事件循环队列中，而会在当前tick的任务的任务队列末尾添加一个项目（一个任务）。<br>   类似于游乐园游戏：玩过一个游戏之后，你需要重新到队尾排队才能再玩一次，而任务队列类似于玩过了游戏之后，插队接着继续玩。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;A&apos;);</span><br><span class="line"></span><br><span class="line">setTimeout(()=&gt;console.log(&apos;B&apos;), 0);</span><br><span class="line"></span><br><span class="line">schedule(function() &#123;</span><br><span class="line">   console.log(&apos;C&apos;);</span><br><span class="line">   schedule(function()&#123;</span><br><span class="line">      console.log(&apos;D&apos;);</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>   <font color="red">语句顺序</font><br>   js引擎会在编译期间执行优化。尽管我们是看不到的，但是代码编写的方式（从上到下的模式）和编译后执行的方式之间的联系非常脆弱，理解这一点能够更好地理解异步js代码流问题。编译器语句重排序几乎就是并发和交互的微型隐喻。</p>
<p>   <font color="yellow">异步控制台：</font><br>   并没有什么规范或一组需求制定console.*方法族如何工作–它们并不是js正式的一部分，而是由宿主环境添加到js中的。因此，不同的浏览器和js环境可以按照自己的医院来实现。尤其要提出的是，在某些条件下，某些浏览器的console.log(..)会在后台异步处理控制台I/O，以提高性能。如果遇见这种少见的情况，最好的选择是在js调试器中使用断点，次优的方案是把对象序列化到一个字符串中，以强制执行一次“快照”，比如通过JSON.stringfy(..)。</p>
<h2 id="回调"><a href="#回调" class="headerlink" title="回调"></a>回调</h2><p>   回调函数是js异步的基本单元，但是因为它一不符合我们大脑的思考方式（线性的、阻塞的、单线程），二是存在控制反转的信任问题，即使可以尝试挽救回调，但是可能会产生更笨重，更难以维护的代码。所以回调已经在异步编程领域不够用了。</p>
<h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><h3 id="什么是Promise"><a href="#什么是Promise" class="headerlink" title="什么是Promise"></a>什么是Promise</h3><p>   Promise封装了依赖时间的状态–等待底层值的完成或拒绝，所以Promise本身是与时间无关的。因此，Promise可以按照可预测的方式组成（组合），而不关心时序和底层的结果，</p>
<p>   Promise（一旦决议）一直保持其决议结果（完成或拒绝）不变，可以按照需要多次查看。</p>
<h3 id="具有then方法的亚子类型"><a href="#具有then方法的亚子类型" class="headerlink" title="具有then方法的亚子类型"></a>具有then方法的亚子类型</h3><p>   p instaceof Promise 无法识别和判断真正的Promise。</p>
<p>   thenable</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if (p!==null &amp;&amp; (typeof p === &apos;object&apos; || typeof p ==== &apos;function&apos;) &amp;&amp; typeof p.then === &apos;function&apos;)&#123;</span><br><span class="line">  // 假定则是一个thenable</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  // 不是 thenable</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h2><h2 id="程序性能"><a href="#程序性能" class="headerlink" title="程序性能"></a>程序性能</h2><h2 id="性能测试与调优"><a href="#性能测试与调优" class="headerlink" title="性能测试与调优"></a>性能测试与调优</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/20/es6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/20/es6/" itemprop="url">es6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-20T14:33:08+08:00">
                2021-01-20
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/基础/" itemprop="url" rel="index">
                    <span itemprop="name">基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="第一节、-块级作用域"><a href="#第一节、-块级作用域" class="headerlink" title="第一节、 块级作用域"></a><font color="#1B90D6">第一节、 块级作用域</font></h2><blockquote>
<p>ES5，以function来划分作用域，但是{}却限定不了var的作用域。<br>ES6，增加了let和const，声明在{} -&gt; “function、if、for等”的变量作用域被限制在块级</p>
</blockquote>
<h3 id="let-和-const"><a href="#let-和-const" class="headerlink" title="let 和 const"></a>let 和 const</h3><blockquote>
<p>生命周期在块级作用域中<br>没有变量提升，不可重复声明<br>let声明变量，const声明常量</p>
</blockquote>
<ul>
<li>块级作用域的出现，实际上使用广泛的立即执行匿名函数不在必要了。防止变量污染。<br></li>
</ul>
<h2 id="第二节、-解构赋值"><a href="#第二节、-解构赋值" class="headerlink" title="第二节、 解构赋值"></a><font color="#1B90D6">第二节、 解构赋值</font></h2><ol>
<li><p>本质上属于模式匹配，也就是只要等号两边的模式相同，左边的变量就会被赋予对应的值。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var [a, b, c] = [1, 2, 3];                  // 1, 2, 3</span><br><span class="line"><span class="built_in">let</span> [foo, [[bar], bax]] = [1, [[2], 3]];    // 1, 2, 3</span><br></pre></td></tr></table></figure>
</li>
<li><p>解构失败则为undefined，也存在不完全解构。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const [a, b, c] = [1];       // 1, undefined, undefined  解构失败</span><br><span class="line"><span class="built_in">let</span> [foo, [[bar], bax]] = [1, [[2, 3], 4]];  // 1, 2, 4  不完全解构</span><br></pre></td></tr></table></figure>
</li>
<li><p>赋默认值（只有右侧严格等于undefined的时候才生效）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const [a, b=123, c] = [1];   // 1, 123, undefined</span><br><span class="line"><span class="built_in">let</span> [foo=1] = [null];        // null</span><br><span class="line"></span><br><span class="line">// 惰性求值</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fn</span></span> () &#123; <span class="built_in">return</span> <span class="string">'abc'</span>; &#125;</span><br><span class="line"><span class="built_in">let</span> [a=fn()] = [1];          // 1</span><br><span class="line"><span class="built_in">let</span> [b=fn()] = [];           // <span class="string">'abc'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对象的解构赋值(按照属性名来决定)</p>
<ul>
<li><p>注意：一个已声明的变量用于解构赋值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var x;</span><br><span class="line">&#123; x &#125; = &#123; x: 1 &#125;;    // Uncaught SyntaxError: Unexpected token <span class="string">'='</span></span><br><span class="line">                     // js引擎会将&#123;x&#125;理解成一个代码块，从而发生语法错误</span><br><span class="line">(&#123; x &#125; = &#123; x: 1 &#125;);  // ()将其转换为表达式，从而避免上述语法问题</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果变量名和属性名不一致，必须（属性名不是变量，我们可以理解成一种模式）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var &#123; foo: bar &#125; = &#123; foo: 1,  bar: 2 &#125;;</span><br><span class="line">foo;       // Uncaught ReferenceError: foo is not defined</span><br><span class="line">bar;       // 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>和数组的解构赋值一样，对象的解构赋值也可嵌套</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var obj = &#123; P: [<span class="string">'hello'</span>, &#123;y: <span class="string">'world'</span>&#125;] &#125;;</span><br><span class="line">var &#123; P: [x, &#123;y&#125;] &#125; = obj;</span><br><span class="line"></span><br><span class="line">obj;      // &#123;P: Array(2)&#125;</span><br><span class="line">x;        // <span class="string">'hello'</span></span><br><span class="line">y;        // <span class="string">'world'</span></span><br><span class="line">P;        // Uncaught ReferenceError: P is not defined</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var &#123; x, y=x, z &#125; = &#123; x: 1 &#125;;</span><br><span class="line">x;       // 1</span><br><span class="line">y;       // 1</span><br><span class="line">z;       // undefined</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>字符串的解构赋值，字符串会转化成一个类数组的对象</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var [a,b,c,d,e,f] = <span class="string">"hello"</span>;</span><br><span class="line">var &#123; length: len &#125; = <span class="string">"hello"</span>;</span><br><span class="line">a;      // h</span><br><span class="line">b;      // e</span><br><span class="line">c;      // l</span><br><span class="line">d;      // l</span><br><span class="line">e;      // o</span><br><span class="line">f;      // undefined</span><br><span class="line">len;    // 5</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="6">
<li><p>数值和布尔值的解构赋值，如果等号右边是数值或者布尔值，则会先转为对象</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var &#123; toString: a &#125; = 123;</span><br><span class="line">var &#123; toString: b &#125; = <span class="literal">true</span>;</span><br><span class="line">a;                                 // ƒ <span class="function"><span class="title">toString</span></span>() &#123; [native code] &#125;</span><br><span class="line">b;                                 // ƒ <span class="function"><span class="title">toString</span></span>() &#123; [native code] &#125;</span><br><span class="line">a === Number.prototype.toString;   // <span class="literal">true</span></span><br><span class="line">b === Boolean.prototype.toString;  // <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数参数的解构赋值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="built_in">test</span>(&#123; x=0, y=0 &#125; = &#123;&#125;) &#123;</span><br><span class="line">  console.log([x ,y]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">test</span>(&#123;x: 1, y: 2&#125;);  // [1, 2]</span><br><span class="line"><span class="built_in">test</span>(&#123;x: 1&#125;);        // [1, 0]</span><br><span class="line"><span class="built_in">test</span>(&#123;&#125;);            // [0, 0]</span><br><span class="line"><span class="built_in">test</span>();              // [0, 0]</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> move(&#123; x, y &#125; = &#123;x: 0, y: 0&#125;) &#123;</span><br><span class="line">  console.log([x ,y]);</span><br><span class="line">&#125;</span><br><span class="line">move(&#123;x: 1, y: 2&#125;);  // [1, 2]</span><br><span class="line">move(&#123;x: 1&#125;);        // [1, undefined]</span><br><span class="line">move(&#123;&#125;);            // [undefined, undefined]</span><br><span class="line">move();              // [0, 0]</span><br></pre></td></tr></table></figure>
</li>
<li><p>解构赋值的应用</p>
<ul>
<li><p>交换变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var a = 1;</span><br><span class="line">var b = 2;</span><br><span class="line">[a, b] = [b, a];</span><br><span class="line">a, b;            // 2, 1</span><br></pre></td></tr></table></figure>
</li>
<li><p>函数参数的定义</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> fn (&#123;x=1, y, z&#125; = &#123;&#125;)&#123;console.log(x, y, z);&#125;</span><br><span class="line">fn();    // 1, undefined, undefined</span><br></pre></td></tr></table></figure>
</li>
<li><p>从函数中返回多个值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">example</span></span> () &#123;</span><br><span class="line">  <span class="built_in">return</span> [1, 2, 3];</span><br><span class="line">&#125;</span><br><span class="line">const [a, b, c] = example();</span><br><span class="line">a, b, c           // 1, 2, 3</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<ul>
<li>提交数据<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var jsonData = &#123;</span><br><span class="line">  id: 42,</span><br><span class="line">  status: 2000,</span><br><span class="line">&#125;;</span><br><span class="line">const &#123; id, status &#125; = jsonData;</span><br><span class="line">id, status;       // 42, 2000</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="第三节、-数组扩展"><a href="#第三节、-数组扩展" class="headerlink" title="第三节、 数组扩展"></a><font color="#1B90D6">第三节、 数组扩展</font></h2><h3 id="Array-from"><a href="#Array-from" class="headerlink" title="Array.from()"></a>Array.from()</h3><p>用于将两类对象转化为真正的数组</p>
<ol>
<li>类数组 （所谓类似数组的对象，本质上必须有length属性）</li>
<li>可遍历对象 （ES6新增Set和Map两种数据结构）</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var sameArr = &#123;</span><br><span class="line">  0: 1,</span><br><span class="line">  a: <span class="string">'b'</span>,</span><br><span class="line">  5: <span class="string">'c'</span>,</span><br><span class="line">  length: 6,</span><br><span class="line">  splice: <span class="function"><span class="title">function</span></span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">var arr = Array.from(sameArr);</span><br><span class="line"></span><br><span class="line">sameArr       // Object(6) [1, empty × 4, <span class="string">"c"</span>, a: <span class="string">"b"</span>, splice: ƒ]</span><br><span class="line">                 0: 1 5: <span class="string">"c"</span> a: <span class="string">"b"</span> length: 6 splice: ƒ ()__proto__: Object </span><br><span class="line"></span><br><span class="line">arr;          // [1, undefined, undefined, undefined, undefined, <span class="string">"c"</span>]</span><br><span class="line"></span><br><span class="line">sameArr.forEach(item =&gt; console.log(item)); // Uncaught TypeError: sameArr.forEach is not a <span class="keyword">function</span></span><br><span class="line"></span><br><span class="line">arr.forEach(item =&gt; console.log(item)); // 1  undefined undefined undefined undefined  c</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Array.from 还接受第二个参数，作用类似于数组的map方法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var arr = Array.from(sameArr, (item) =&gt; item + 123);</span><br><span class="line">arr;           // [124, NaN, NaN, NaN, NaN, <span class="string">"c123"</span>]</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of()"></a>Array.of()</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var arr = new Array();            // [undefined * 10]</span><br><span class="line">var arr1 = Array.of(10, 2, 3);    // [10, 2, 3]</span><br></pre></td></tr></table></figure>
<h3 id="copyWithin"><a href="#copyWithin" class="headerlink" title="copyWithin()"></a>copyWithin()</h3><p>  在当前数组内部，将指定位置的成员复制到其他位置（会覆盖原来成员），然后返回当前数组，也就是说，copyWithin()方法会修改当前数组。</p>
<ul>
<li>接受三个参数：<br>target（必需）：从该位置开始替换数据<br>start（可选）：从该位置开始读取数据，默认为0，如果为负值，表示倒数。<br>end（可选）：到该位置前停止读取数据，默认等于数组长度，如果为负值，表示倒数。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];</span><br><span class="line">arr.copyWithin(0, 2, 4);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="find-和-findIndex"><a href="#find-和-findIndex" class="headerlink" title="find() 和 findIndex()"></a>find() 和 findIndex()</h3><ul>
<li>find       用于找出第一个符合条件的数组成员。没有则返回undefined。<br>findIndex  类似，返回第一个符合条件的数组成员的位置。没有则返回-1。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var arr = [1, 2, 3, 4, 5, 6, 7, 8, 9];</span><br><span class="line">var newArr = arr.find((item) =&gt; item &gt; 5);         // 6</span><br><span class="line">var newIndex = arr.findIndex((item) =&gt; item &gt; 5);  // 5</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="fill"><a href="#fill" class="headerlink" title="fill()"></a>fill()</h3><p>填充数组<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var arr = [1, 2, 3, 4, 5];</span><br><span class="line">arr.fill(<span class="string">'a'</span>);                // [<span class="string">"a"</span>, <span class="string">"a"</span>, <span class="string">"a"</span>, <span class="string">"a"</span>, <span class="string">"a"</span>]</span><br><span class="line">arr.fill(<span class="string">'a'</span>, 2);             // [1, 2, <span class="string">"a"</span>, <span class="string">"a"</span>, <span class="string">"a"</span>]</span><br><span class="line">arr.fill(<span class="string">'a'</span>, 2, 4);          // [1, 2, <span class="string">"a"</span>, <span class="string">"a"</span>, 5]</span><br></pre></td></tr></table></figure></p>
<h3 id="entries-keys-valueof"><a href="#entries-keys-valueof" class="headerlink" title="entries() keys() valueof()"></a>entries() keys() valueof()</h3><p>ES6提供三个新的方法 – entries, keys()和values() – 用于遍历数组。它们都返回一个遍历器对象，可以用for…of循环进行遍历，唯一的区别是keys()是对键名的遍历,values()是对键值的遍历，entries()是对键值对的遍历。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">let</span> index of [<span class="string">'a'</span>, <span class="string">'b'</span>].keys()) &#123; console.log(index); &#125;     // 0 1</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">let</span> elem of [<span class="string">'a'</span>, <span class="string">'b'</span>].values()) &#123; console.log(elem); &#125;      // <span class="string">'a'</span> <span class="string">'b'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">let</span> [index, elem] of [<span class="string">'a'</span>, <span class="string">'b'</span>].entries()) &#123; console.log(index, elem); &#125;      // 0 <span class="string">"a"</span>    1 <span class="string">"b"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="includes"><a href="#includes" class="headerlink" title="includes()"></a>includes()</h3><p>某个数组是否包含给定的值，与字符串的includes方法类似。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, NaN];</span><br><span class="line">console.log(arr.indexOf(<span class="string">'c'</span>));    // 2</span><br><span class="line">console.log(arr.indexOf(NaN));    // -1    NaN不等于NaN</span><br><span class="line">console.log(arr.includes(<span class="string">'c'</span>));   // <span class="literal">true</span></span><br><span class="line">console.log(arr.includes(NaN));   // <span class="literal">true</span>  includes没有这个问题</span><br></pre></td></tr></table></figure></p>
<h2 id="第四节、-对象扩展"><a href="#第四节、-对象扩展" class="headerlink" title="第四节、 对象扩展"></a><font color="#1B90D6">第四节、 对象扩展</font></h2><h3 id="1-属性"><a href="#1-属性" class="headerlink" title="1. 属性"></a>1. 属性</h3><p>ES6 允许直接写入变量和函数，作为对象的属性和方法。（ES6允许在对象中，只写属性名不写属性值，这时属性值等于属性名所代表的的变量）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const obj = &#123; name&#125;;                                 // &#123;name: <span class="string">""</span>&#125;</span><br><span class="line"></span><br><span class="line">const name = <span class="string">'hahaha'</span>;</span><br><span class="line">const obj = &#123; name &#125;;                                // &#123;name: <span class="string">"hahaha"</span>&#125;</span><br><span class="line"></span><br><span class="line">const name = <span class="function"><span class="title">function</span></span>()&#123;sonsole.log(<span class="string">'name:test'</span>);&#125;;</span><br><span class="line">const obj = &#123; name &#125;;                                // &#123;name: ƒ&#125;</span><br><span class="line"></span><br><span class="line">const obj = &#123; <span class="function"><span class="title">name</span></span>()&#123;console.log(<span class="string">'name:test'</span>);&#125; &#125;;   // &#123;name: ƒ&#125;</span><br></pre></td></tr></table></figure></p>
<p>属性表达式：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const name = <span class="string">'test'</span>;</span><br><span class="line">const obj = &#123;             // &#123;<span class="built_in">test</span>: <span class="string">"haha"</span>, test1: <span class="string">"heihei"</span>, test2: <span class="string">"houhou"</span>&#125;</span><br><span class="line">  [name]: <span class="string">'haha'</span>,</span><br><span class="line">  [name+<span class="string">'1'</span>]: <span class="string">'heihei'</span>,</span><br><span class="line">  [name+<span class="string">'2'</span>]: <span class="string">'houhou'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-Object-is"><a href="#2-Object-is" class="headerlink" title="2. Object.is()"></a>2. Object.is()</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+0 === -0              // <span class="literal">true</span></span><br><span class="line">NaN === NaN            // <span class="literal">false</span></span><br><span class="line">Object.is(+0, -0);     // <span class="literal">false</span></span><br><span class="line">Object.is(NaN, NaN);   // <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="3-Object-assign"><a href="#3-Object-assign" class="headerlink" title="3. Object.assign()"></a>3. Object.assign()</h3><p>对象合并（浅拷贝）<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const a = &#123; a: 1, b: <span class="string">'xxx'</span> &#125;;</span><br><span class="line">const b = &#123; b: <span class="string">'bbb'</span>, c: &#123; d: 1, e: 2 &#125; &#125;;</span><br><span class="line">const f = &#123; c: &#123; d: 2, e: 2, g: 3 &#125;, h: <span class="string">'hahaha'</span> &#125;;</span><br><span class="line"></span><br><span class="line">Object.assign(f, b, a);   // &#123;c: &#123;&#123;d: 1, e: 2&#125;&#125;, h: <span class="string">"hahaha"</span>, b: <span class="string">"xxx"</span>, a: 1&#125;</span><br></pre></td></tr></table></figure></p>
<font size="1">$.extend({}) 扩展<br>$.extend({}, {}) 浅拷贝<br>$.extend(true, {}, {}) 深拷贝</font>

<h3 id="4-Object-entries-Object-keys-Object-valueof"><a href="#4-Object-entries-Object-keys-Object-valueof" class="headerlink" title="4. Object.entries()  Object.keys()  Object.valueof()"></a>4. Object.entries()  Object.keys()  Object.valueof()</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const obj = &#123; b: <span class="string">'bbb'</span>, c: &#123; d: 1, e: 2 &#125; &#125;;</span><br><span class="line">  </span><br><span class="line">Object.keys(obj);      // [<span class="string">"b"</span>, <span class="string">"c"</span>]</span><br><span class="line">Object.values(obj);    // [<span class="string">"bbb"</span>, &#123;d: 1, e: 2&#125;]</span><br><span class="line">Object.entries(obj);   // [[<span class="string">"b"</span>, <span class="string">"bbb"</span>], [<span class="string">"c"</span>, &#123;d: 1, e: 2&#125;]]</span><br></pre></td></tr></table></figure>
<h3 id="5-Object-getPrototypeOf-Object-setPrototypeOf"><a href="#5-Object-getPrototypeOf-Object-setPrototypeOf" class="headerlink" title="5. Object.getPrototypeOf()   Object.setPrototypeOf()"></a>5. Object.getPrototypeOf()   Object.setPrototypeOf()</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const obj = &#123; a: 1 &#125;;</span><br><span class="line">const obj1 = &#123; b: <span class="function"><span class="title">function</span></span>()&#123;console.log(<span class="string">'bbb'</span>);&#125; &#125;;</span><br><span class="line"></span><br><span class="line">obj.__proto__ = obj1;</span><br><span class="line">Object.setPrototypeOf(obj, obj1);</span><br><span class="line"></span><br><span class="line">obj.b();                              // <span class="string">'bbb'</span></span><br><span class="line">Object.getPrototypeOf(obj);           // &#123;b: ƒ&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-扩展运算符-…"><a href="#6-扩展运算符-…" class="headerlink" title="6. 扩展运算符 …"></a>6. 扩展运算符 …</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const arr = [1,2,3];</span><br><span class="line">const arr1 = [...arr, <span class="string">'c'</span>];      // [1, 2, 3, <span class="string">"c"</span>]</span><br></pre></td></tr></table></figure>
<h2 id="第五节、-函数扩展"><a href="#第五节、-函数扩展" class="headerlink" title="第五节、 函数扩展"></a><font color="#1B90D6">第五节、 函数扩展</font></h2><h3 id="1-扩展运算符-…"><a href="#1-扩展运算符-…" class="headerlink" title="1. 扩展运算符 …"></a>1. 扩展运算符 …</h3><p>ES6韵如rest参数（形式为“…变量名”），用于获取函数的多余参数，这样就不需要使用arguments对象了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const a = (...values) =&gt; &#123;console.log(values);&#125;</span><br><span class="line">a(1,2,3,4,5);     // [1,2,3,4,5]</span><br><span class="line"></span><br><span class="line">const a = (a, ...values) =&gt; &#123;console.log(values);&#125;</span><br><span class="line">a(1,2,3,4,5);     // [2,3,4,5]</span><br></pre></td></tr></table></figure></p>
<h3 id="2-箭头函数"><a href="#2-箭头函数" class="headerlink" title="2. 箭头函数"></a>2. 箭头函数</h3><ol>
<li>箭头函数内的this值不会改变<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">const id = 10;</span><br><span class="line">const fn = () =&gt; &#123;console.log(this.id);&#125;   // this指向window</span><br><span class="line">const obj = &#123; id: 20, fn &#125;;</span><br><span class="line">const obj1 = &#123; id: 30 &#125;;</span><br><span class="line">fn();                          // undefined</span><br><span class="line">obj.fn();                      // undefined</span><br><span class="line">obj.fn.call(obj1);             // undefined</span><br><span class="line"></span><br><span class="line">var id = 10;</span><br><span class="line">const fn = () =&gt; &#123;console.log(this.id);&#125;</span><br><span class="line">const obj = &#123; id: 20, fn &#125;;</span><br><span class="line">const obj1 = &#123; id: 30 &#125;;</span><br><span class="line">fn();                          // 10</span><br><span class="line">obj.fn();                      // 10</span><br><span class="line">obj.fn.call(obj1);             // 10</span><br><span class="line"></span><br><span class="line">var id = 10;</span><br><span class="line">const fn = () =&gt; &#123;this.id = 1; console.log(this.id);&#125;</span><br><span class="line">const obj = &#123; id: 20, fn &#125;;</span><br><span class="line">const obj1 = &#123; id: 30 &#125;;</span><br><span class="line">fn();                          // 1</span><br><span class="line">obj.fn();                      // 1</span><br><span class="line">obj.fn.call(obj1);             // 1</span><br><span class="line"></span><br><span class="line">const id = 10;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fn</span></span> () &#123;console.log(this.id);&#125;</span><br><span class="line">const obj = &#123; id: 20, fn  &#125;;</span><br><span class="line">const obj1 = &#123; id: 30 &#125;;</span><br><span class="line">obj.fn();                      // 20</span><br><span class="line">obj.fn.call(obj1);             // 30</span><br><span class="line"></span><br><span class="line">const fn1 = obj.fn;</span><br><span class="line">fn1();                         // undefined</span><br><span class="line"></span><br><span class="line">const fn2 = obj.fn.bind(obj1);</span><br><span class="line">fn2();                         // 30</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>全局定义的const和let不会被挂载到全局对象（如window）下，而是存在于块作用域（Script）中。<br>我们可以用debugger在控制台测一下</p>
<p>这里不是太理解，埋个？<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 定义时</span><br><span class="line">const id = 10;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fn</span></span> () &#123;setTimeout(<span class="function"><span class="title">function</span></span>()&#123;console.log(this.id)&#125;, 0);&#125;       // undefined</span><br><span class="line">const obj1 = &#123; id: 30 &#125;;</span><br><span class="line">fn.call(obj1);</span><br><span class="line"></span><br><span class="line">const id = 10;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fn</span></span> () &#123;setTimeout(()=&gt;console.log(this.id), 0);&#125;               // 30</span><br><span class="line">const obj1 = &#123; id: 30 &#125;;</span><br><span class="line">fn.call(obj1);</span><br></pre></td></tr></table></figure></p>
<h2 id="第六节、-类-class"><a href="#第六节、-类-class" class="headerlink" title="第六节、 类  class"></a><font color="#1B90D6">第六节、 类  class</font></h2><h3 id="class基本语法"><a href="#class基本语法" class="headerlink" title="class基本语法"></a>class基本语法</h3><blockquote>
<p>JS的传统方法是通过构造函数，定义并生成新对象。<br>构造函数的prototype属性，在ES6的类上面继续存在（事实上，类的所有方法都定义在类的prototype属性上）。<br>类的内部所有定义的方法都是不可枚举的。<br>类的实例共享一个原型对象。<br>class 的本质是 function。</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Person &#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span></span>() &#123; // 不写默认为&#123;&#125;</span><br><span class="line">    this.name = <span class="string">'Person Class'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">operate</span></span>()&#123;</span><br><span class="line">    console.log(<span class="string">'laugh smile cry fire happy sad'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const child = new Person(); // Person &#123;name: <span class="string">"Person Class"</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="class的继承"><a href="#class的继承" class="headerlink" title="class的继承"></a>class的继承</h3><p>extends supor<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">class Ancestors &#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span></span>() &#123;</span><br><span class="line">    this.level = <span class="string">'Ancestors Class'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">create</span></span>() &#123;</span><br><span class="line">    console.log(<span class="string">'Creating the world'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Person extends Ancestors &#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span></span>() &#123;</span><br><span class="line">    super();  // 必须</span><br><span class="line">    this.name = <span class="string">'Person Class'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="title">operate</span></span>()&#123;</span><br><span class="line">    console.log(<span class="string">'laugh smile cry fire happy sad'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const child = new Person(); // Person &#123;level: <span class="string">"Ancestors Class"</span>, name: <span class="string">"Person Class"</span>&#125;</span><br><span class="line">child.operate();            // 可调用</span><br><span class="line">child.create();             // 可调用</span><br></pre></td></tr></table></figure></p>
<h3 id="class的静态方法-static"><a href="#class的静态方法-static" class="headerlink" title="class的静态方法 static"></a>class的静态方法 static</h3><p>不需要实例化。 ES6 中规定，Class 内部只有静态方法，没有静态属性。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Person&#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    this.name = &apos;Person Class&apos;;</span><br><span class="line">  &#125;</span><br><span class="line">  operate()&#123;</span><br><span class="line">    console.log(&apos;laugh smile cry fire happy sad&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">  static originLook() &#123;</span><br><span class="line">    console.log(&apos;nature is new&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const child = new Person();</span><br><span class="line">child.originLook();       // Uncaught TypeError: child.originLook is not a function</span><br></pre></td></tr></table></figure></p>
<h2 id="第七节、-Set-和-Map"><a href="#第七节、-Set-和-Map" class="headerlink" title="第七节、 Set 和 Map"></a><font color="#1B90D6">第七节、 Set 和 Map</font></h2><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><blockquote>
<p> ES6提供了新的数据结构Set，类似于数组，但是成员的值都是唯一的，没有重复的值。<br> Set本身是构造函数，用来生成Set数据结构，Set函数可以接受数组（或类数组）作为参数，用来初始化。<br>可以用来去除数组中重复的成员。</p>
</blockquote>
<blockquote>
<p>Set.prototype.constructor： 构造函数，默认就是Set函数<br>Set.prototype.size：返回Set实例的成员总数</p>
</blockquote>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const arr = [1,2,3,3,3,2,1];</span><br><span class="line">const a = new Set(arr);                // Set(3) &#123;1, 2, 3&#125; </span><br><span class="line">const b = Array.from(new Set(arr));    // [1, 2, 3]   将Set结构转换为数组，也算是一种数组去重的方法</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Set数据的四个操作方法：<br>add()<br>delete()<br>has()<br>clear()</p>
</li>
<li><p>Set数据的四个遍历方法：<br>keys()<br>values()<br>entries()<br>forEach()</p>
</li>
</ul>
<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>Map 对象保存键值对。任何值(对象或者原始值) 都可以作为一个键或一个值。</p>
<h4 id="Maps-和-Objects-的区别"><a href="#Maps-和-Objects-的区别" class="headerlink" title="Maps 和 Objects 的区别"></a>Maps 和 Objects 的区别</h4><p>  一个 Object 的键只能是字符串或者 Symbols，但一个 Map 的<strong>键可以是任意值</strong>。<br>  Map 中的键值是<strong>有序</strong>的（FIFO 原则），而添加到对象中的键则不是。<br>  Map 的键值对个数可以从 <strong>size</strong> 属性获取，而 Object 的键值对个数只能手动计算。<br>  Object 都有自己的原型，原型链上的键名有可能和你自己在对象上的设置的键名产生冲突。</p>
<h4 id="key-可以是字符串、对象"><a href="#key-可以是字符串、对象" class="headerlink" title="key 可以是字符串、对象"></a>key 可以是字符串、对象</h4><ul>
<li><p>key 可以是字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var myMap = new Map();</span><br><span class="line">var keyString = <span class="string">"a string"</span>; </span><br><span class="line">myMap.set(keyString, <span class="string">"和键'a string'关联的值"</span>);</span><br><span class="line">myMap.get(keyString);         // <span class="string">"和键'a string'关联的值"</span></span><br><span class="line">myMap.get(<span class="string">"a string"</span>);        // <span class="string">"和键'a string'关联的值"</span>,因为 keyString === <span class="string">'a string'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>key 是对象</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var myMap = new Map();</span><br><span class="line">var keyObj = &#123;&#125;, </span><br><span class="line">myMap.set(keyObj, <span class="string">"和键 keyObj 关联的值"</span>);</span><br><span class="line">myMap.get(keyObj);             // <span class="string">"和键 keyObj 关联的值"</span></span><br><span class="line">myMap.get(&#123;&#125;);                 // undefined, 因为 keyObj !== &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>key 是函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var myMap = new Map();</span><br><span class="line">var keyFunc = <span class="function"><span class="title">function</span></span> () &#123;&#125;;</span><br><span class="line">myMap.set(keyFunc, <span class="string">"和键 keyFunc 关联的值"</span>);</span><br><span class="line">myMap.get(keyFunc);              // <span class="string">"和键 keyFunc 关联的值"</span></span><br><span class="line">myMap.get(<span class="function"><span class="title">function</span></span>() &#123;&#125;)         // undefined, 因为 keyFunc !== <span class="function"><span class="title">function</span></span> () &#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>key 是 NaN<br><em>虽然NaN和任何值甚至和自己都不相等，但是NaN作为Map的键来说是没有区别的。</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var myMap = new Map();</span><br><span class="line">myMap.set(NaN, <span class="string">"not a number"</span>);</span><br><span class="line">myMap.get(NaN);                   // <span class="string">"not a number"</span></span><br><span class="line">var otherNaN = Number(<span class="string">"foo"</span>);</span><br><span class="line">myMap.get(otherNaN);              // <span class="string">"not a number"</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="Set数据的四个操作方法："><a href="#Set数据的四个操作方法：" class="headerlink" title="Set数据的四个操作方法："></a>Set数据的四个操作方法：</h4><p>  add()<br>  delete()<br>  has()<br>  clear()</p>
<h4 id="Set数据的四个遍历方法："><a href="#Set数据的四个遍历方法：" class="headerlink" title="Set数据的四个遍历方法："></a>Set数据的四个遍历方法：</h4><p>  keys()<br>  values()<br>  entries()<br>  forEach()</p>
<h2 id="第八节、-Promise"><a href="#第八节、-Promise" class="headerlink" title="第八节、 Promise"></a><font color="#1B90D6">第八节、 Promise</font></h2><p>Promise是异步编程的一种解决方案。</p>
<h3 id="1、Promise-的含义"><a href="#1、Promise-的含义" class="headerlink" title="1、Promise 的含义"></a>1、Promise 的含义</h3><p>所谓Promise，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。从语法上说，Promise 是一个对象，从它可以获取异步操作的消息。</p>
<ul>
<li><p><strong>对象的状态不受外界影响。</strong> Promise对象代表一个异步操作，有三种状态：pending（进行中）、fulfilled（已成功）和rejected（已失败）。只有异步操作的结果，可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是Promise这个名字的由来，它的英语意思就是“承诺”，表示其他手段无法改变。</p>
</li>
<li><p><strong>一旦状态改变，就不会再变，任何时候都可以得到这个结果</strong>。Promise对象的状态改变，只有两种可能：从pending变为fulfilled和从pending变为rejected。只要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果，这时就称为 resolved（已定型）。如果改变已经发生了，你再对Promise对象添加回调函数，也会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了它，再去监听，是得不到结果的。<br>注意，为了行文方便，本章后面的resolved统一只指fulfilled状态，不包含rejected状态。</p>
</li>
</ul>
<h3 id="2、基本用法"><a href="#2、基本用法" class="headerlink" title="2、基本用法"></a>2、基本用法</h3><p>ES6 规定，Promise对象是一个构造函数，用来生成Promise实例。</p>
<h2 id="第九节、-Iterator"><a href="#第九节、-Iterator" class="headerlink" title="第九节、 Iterator"></a><font color="#1B90D6">第九节、 Iterator</font></h2><h2 id="第十节、-Symbol"><a href="#第十节、-Symbol" class="headerlink" title="第十节、 Symbol"></a><font color="#1B90D6">第十节、 Symbol</font></h2><!-- 




1. function和箭头函数的区别
> this的指向： 使用function定义的函数，this的指向随着调用环境的变化而变化的，而箭头函数中的this指向是固定不变的，一直指向的是定义函数的环境。
>
> 构造函数： function是可以定义构造函数的，而箭头函数是不行的。
>
> 变量提升： 由于js的内存机制，function的级别最高，而用箭头函数定义函数的时候，需要var(let const定义的时候更不必说)关键词，而var所定义的变量不能得到变量提升，故箭头函数一定要定义于调用之前！

 -->
<p><style>.post-tip{background-color: #eaf8ff;color: #4e7182;border-left: 5px solid #1eb4ff;padding: 10px;}</style><br><!-- 
  一级 #0472B4
  二级 #1B90D6
--></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/13/html-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/13/html-1/" itemprop="url">你不知道的html</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-13T15:14:18+08:00">
                2021-01-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/专题/" itemprop="url" rel="index">
                    <span itemprop="name">专题</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="a标签的download属性"><a href="#a标签的download属性" class="headerlink" title="a标签的download属性"></a>a标签的download属性</h1><p>a标签的download属性，想必大家都知道它的意义是改变文件下载的名称。但是当跨域下载远程文件的时候，这个属性会存在失效问题。我们今天就来看看，在不用服务器协调的情况下，前端如何自行处理这个问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">const handleDownLoad = () =&gt; &#123;</span><br><span class="line">  const template = &apos;https://festatic-1254389369.cos.ap-guangzhou.myqcloud.com/science/otms/importTemplatestationCreate.csv&apos;;</span><br><span class="line">  const download = &apos;模板.csv&apos;;</span><br><span class="line"></span><br><span class="line">  const x = new XMLHttpRequest();</span><br><span class="line">  x.open(&apos;GET&apos;, template, true);</span><br><span class="line">  x.responseType = &apos;blob&apos;;</span><br><span class="line">  x.onload = () =&gt; &#123;</span><br><span class="line">    const url = window.URL.createObjectURL(x.response);</span><br><span class="line">    const a = document.createElement(&apos;a&apos;);</span><br><span class="line">    a.href = url;</span><br><span class="line">    a.download = download;</span><br><span class="line">    a.click();</span><br><span class="line">  &#125;;</span><br><span class="line">  x.send();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const handleDownLoad = async () =&gt; &#123;</span><br><span class="line">  const template = &apos;https://festatic-1254389369.cos.ap-guangzhou.myqcloud.com/science/otms/importTemplatestationCreate.csv&apos;;</span><br><span class="line">  const download = &apos;模板.csv&apos;;</span><br><span class="line"></span><br><span class="line">  const response = await fetch(template);</span><br><span class="line">  const blob = await response.blob();</span><br><span class="line">  const objectUrl = window.URL.createObjectURL(blob);</span><br><span class="line">  const a = document.createElement(&apos;a&apos;);</span><br><span class="line">  a.href = objectUrl;</span><br><span class="line">  a.download = download;</span><br><span class="line">  document.body.appendChild(a);</span><br><span class="line">  a.click();</span><br><span class="line">  setTimeout(() =&gt; document.body.removeChild(a), 1000);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<div class="post-warning">注意：代码中对创建的&lt;a> 进行的 appendChild 和 remove 操作主要是为了兼容 FireFox 浏览器，在 FireFox 浏览器下调用该方法如果不将创建的&lt;a>标签添加到 body 里，点击链接不会有任何反应，无法触发下载，而在 Chrome 浏览器中则不受此影响。</div>


          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/08/pdf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/08/pdf/" itemprop="url">前端生成二维码/图片/pdf</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-08T19:05:21+08:00">
                2021-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/专题/" itemprop="url" rel="index">
                    <span itemprop="name">专题</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、生成二维码-QRCode"><a href="#一、生成二维码-QRCode" class="headerlink" title="一、生成二维码: QRCode"></a>一、生成二维码: QRCode</h1><p>  PC端：qrcode.react<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import QRCode from &apos;qrcode.react&apos;;</span><br><span class="line">&lt;QRCode value=&#123; &apos;xxx&apos; &#125; size=&#123;100&#125; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>  微信小程序：<a href="https://github.com/yingye/weapp-qrcode" target="_blank" rel="noopener">weapp-qrcode</a><br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import drawQrcode from &apos;weapp-qrcode&apos;;</span><br><span class="line"></span><br><span class="line">drawQrcode(&#123;</span><br><span class="line">  width: 131,</span><br><span class="line">  height: 131,</span><br><span class="line">  canvasId: &apos;myQrcode&apos;,</span><br><span class="line">  _this: this.$scope,</span><br><span class="line">  text: `xxxxxxx`</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&lt;Canvas style=&quot;width: 131px; height: 131px; transform: translateX(-65.5px);&quot; canvasId=&apos;myQrcode&apos; /&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="二、html生成图片，下载-保存到本地"><a href="#二、html生成图片，下载-保存到本地" class="headerlink" title="二、html生成图片，下载/保存到本地"></a>二、html生成图片，下载/保存到本地</h1><p>  PC端：html2canvas<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import html2canvas from &apos;html2canvas&apos;;</span><br><span class="line"></span><br><span class="line">html2canvas(document.querySelector(&apos;.save-png-wrap&apos;)).then((canvas) =&gt; &#123;</span><br><span class="line">  const base64Url = canvas.toDataURL(&apos;image/png&apos;, 1);</span><br><span class="line">  const a = document.createElement(&apos;a&apos;);</span><br><span class="line">  (a.href as any) = base64Url;</span><br><span class="line">  a.download = &apos;交接码.png&apos;;</span><br><span class="line">  a.click();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>  微信小程序：<a href="https://github.com/Kujiale-Mobile/Painter" target="_blank" rel="noopener">painter</a><br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">card.tsx</span><br><span class="line"></span><br><span class="line">function _stationAddress(text: string, css: any) &#123;</span><br><span class="line">  const des = &#123;</span><br><span class="line">    type: &apos;text&apos;,</span><br><span class="line">    text: &apos;&apos;,</span><br><span class="line">    css: [&#123;...css&#125;],</span><br><span class="line">  &#125;;</span><br><span class="line">  let textArr = text.split(&apos;&apos;);</span><br><span class="line">  for (let i = 1; i &lt;= (String(text).length/21); i++) &#123;</span><br><span class="line">    textArr.splice(i*21,1,&apos;\n&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">  des.text = textArr.join(&apos;&apos;)</span><br><span class="line">  return des;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const handleText = (text: string) =&gt; &#123;</span><br><span class="line">  let showText = text;</span><br><span class="line">  if (showText.length &gt; 20) &#123;</span><br><span class="line">    showText = showText.substring(0, 20) + &apos;...&apos;;</span><br><span class="line">  &#125;</span><br><span class="line">  return showText;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default class Card &#123;</span><br><span class="line">  palette(data: any) &#123;</span><br><span class="line">    return (&#123;</span><br><span class="line">      width: &apos;750rpx&apos;,</span><br><span class="line">      height: &apos;1334rpx&apos;,</span><br><span class="line">      background: &apos;#eee&apos;,</span><br><span class="line">      views: [</span><br><span class="line">        &#123;</span><br><span class="line">          type: &apos;image&apos;,</span><br><span class="line">          url: &apos;xxxx.png&apos;,</span><br><span class="line">          css: &#123;</span><br><span class="line">            top: &apos;0rpx&apos;,</span><br><span class="line">            left: &apos;0rpx&apos;,</span><br><span class="line">            width: &apos;100%&apos;,</span><br><span class="line">            height: &apos;100%&apos;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          type: &apos;text&apos;,</span><br><span class="line">          text: `单号 $&#123;data.waybill_id ? data.waybill_id : &apos;&apos;&#125;`,</span><br><span class="line">          css: [&#123;</span><br><span class="line">            top: &apos;174rpx&apos;,</span><br><span class="line">            left: &apos;70rpx&apos;,</span><br><span class="line">            fontSize: &apos;36rpx&apos;,</span><br><span class="line">            color: &apos;rgba(51,51,51,1)&apos;,</span><br><span class="line">          &#125;],</span><br><span class="line">        &#125;,</span><br><span class="line">        _stationAddress(data.start_station_address ? String(data.start_station_address) : &apos;-&apos;, &#123;</span><br><span class="line">          top: &apos;294rpx&apos;,</span><br><span class="line">          left: &apos;116rpx&apos;,</span><br><span class="line">          fontSize: &apos;28rpx&apos;,</span><br><span class="line">          color: &apos;rgba(153,153,153,1)&apos;,</span><br><span class="line">        &#125;),</span><br><span class="line">        data.qrcode ? &#123;</span><br><span class="line">          type: &apos;qrcode&apos;,</span><br><span class="line">          content: `xxxxxxxx`,</span><br><span class="line">          css: &#123;</span><br><span class="line">            top: &apos;606rpx&apos;,</span><br><span class="line">            left: &apos;244rpx&apos;,</span><br><span class="line">            width: &apos;262rpx&apos;,</span><br><span class="line">            height: &apos;262rpx&apos;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;: null,</span><br><span class="line">      ],</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">import Painter from &apos;mina-painter&apos;;</span><br><span class="line">import Card from &quot;./card&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">export default class HandoverCodeModal extends Component&lt;Props, &#123;&#125;&gt; &#123;</span><br><span class="line">  static defaultProps = &#123; &#125;;</span><br><span class="line"></span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123;</span><br><span class="line">      template: &#123;&#125;,</span><br><span class="line">      imagePath: &quot;&quot;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      template: new Card().palette(data),</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onImgOK = (path: any) =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      imagePath: path</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 保存图片</span><br><span class="line">  handleSave = () =&gt; &#123;</span><br><span class="line">    // 方式一：Element is not attached to a Document</span><br><span class="line">    // const query = Taro.createSelectorQuery();</span><br><span class="line">    // const img = query.select(&apos;.save-png-wrap&apos;);</span><br><span class="line"></span><br><span class="line">    // 方式二：Element is not attached to a Document</span><br><span class="line">    // this.refs.img</span><br><span class="line"></span><br><span class="line">    // 方式三： painter</span><br><span class="line">    if ((this.state as any).imagePath) &#123;</span><br><span class="line">      Taro.saveImageToPhotosAlbum(&#123;</span><br><span class="line">        filePath: (this.state as any).imagePath,</span><br><span class="line">        success: function () &#123;</span><br><span class="line">          Taro.showToast(&#123;</span><br><span class="line">            title: &apos;已成功保存到本地相册&apos;,</span><br><span class="line">            icon: &apos;none&apos;,</span><br><span class="line">            duration: 2000</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        fail: function () &#123;</span><br><span class="line">          Taro.showToast(&#123;</span><br><span class="line">            title: &apos;保存失败&apos;,</span><br><span class="line">            icon: &apos;none&apos;,</span><br><span class="line">            duration: 2000</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; template, imagePath &#125; = this.state as any;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;View&gt;</span><br><span class="line">        &lt;Image src=&#123;imagePath&#125; mode=&quot;aspectFill&quot; /&gt;</span><br><span class="line">        &lt;Painter</span><br><span class="line">          palette=&#123;template&#125;</span><br><span class="line">          onImgOK=&#123;this.onImgOK&#125;</span><br><span class="line">          widthPixels=&#123;1000&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="三、html生成pdf"><a href="#三、html生成pdf" class="headerlink" title="三、html生成pdf"></a>三、html生成pdf</h1><p>  html2pdf，它将html生成pdf的原理是：</p>
<ul>
<li>将DOM树转换为canvas对象，可使用html2canvas完成</li>
<li>将canvas转换为图片，可使用canvas.toDataURL完成</li>
<li><p>将图片转换为PDF，可使用<strong>jsPDF</strong>完成</p>
<p>所以，如果系统本身已经使用过html2canvas，那我们直接引用 jsPDF就可以了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import html2canvas from &apos;html2canvas&apos;;</span><br><span class="line">import &#123; jsPDF &#125; from &apos;jspdf&apos;;</span><br><span class="line"></span><br><span class="line">const handleExportPod = () =&gt; &#123;</span><br><span class="line">  // 滚动到页面顶部，避免导出不全</span><br><span class="line">  document.documentElement.scrollTop = 0;</span><br><span class="line"></span><br><span class="line">  html2canvas(document.querySelector(&apos;.ant-layout-content&apos;)).then((canvas) =&gt; &#123;</span><br><span class="line">    const A4_WIDTH = 595.28;</span><br><span class="line">    const A4_HEIGHT = 841.89;</span><br><span class="line">    const contentWidth = canvas.width;</span><br><span class="line">    const contentHeight = canvas.height;</span><br><span class="line"></span><br><span class="line">    // 一页pdf显示html页面生成的canvas高度;</span><br><span class="line">    const pageHeight = (contentWidth / A4_WIDTH) * A4_HEIGHT;</span><br><span class="line">    // 未生成pdf的html页面高度</span><br><span class="line">    let leftHeight = contentHeight;</span><br><span class="line">    // 页面偏移</span><br><span class="line">    let position = 0;</span><br><span class="line">    // a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高</span><br><span class="line">    const imgWidth = A4_WIDTH;</span><br><span class="line">    const imgHeight = (A4_WIDTH / contentWidth) * contentHeight;</span><br><span class="line"></span><br><span class="line">    const pageData = canvas.toDataURL(&apos;image/jpeg&apos;, 1.0);</span><br><span class="line"></span><br><span class="line">    // eslint-disable-next-line new-cap</span><br><span class="line">    const doc = new jsPDF(&apos;p&apos;, &apos;pt&apos;, &apos;a4&apos;);</span><br><span class="line"></span><br><span class="line">    // 有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)</span><br><span class="line">    // 当内容未超过pdf一页显示的范围，无需分页</span><br><span class="line">    if (leftHeight &lt; pageHeight) &#123;</span><br><span class="line">      doc.addImage(pageData, &apos;JPEG&apos;, 0, 0, imgWidth, imgHeight);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      while (leftHeight &gt; 0) &#123;</span><br><span class="line">        doc.addImage(pageData, &apos;JPEG&apos;, 0, position, imgWidth, imgHeight);</span><br><span class="line">        leftHeight -= pageHeight;</span><br><span class="line">        position -= 841.89;</span><br><span class="line">        // 避免添加空白页</span><br><span class="line">        if (leftHeight &gt; 0) &#123;</span><br><span class="line">          doc.addPage();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    doc.save(&apos;Test.pdf&apos;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><button id="switch">close/open</button></p>
<script>let flag=false;const oFigure=document.getElementsByClassName('plain');const oSwitch=document.getElementById('switch');oSwitch.onclick=()=>{flag=!flag;const tipEle=[...oFigure];(tipEle || []).forEach((item) => {if(flag){item.style.display='none';}else{item.style.display='block';}})}</script>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/07/js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/07/js/" itemprop="url">js基础篇</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-07T17:20:03+08:00">
                2021-01-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/基础/" itemprop="url" rel="index">
                    <span itemprop="name">基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>js，前端三大基本语言之一。</p>
<p><strong>javaScript是单线程 、解释性、弱类型、兼容于ECMA标准的脚本语言</strong></p>
<ul>
<li>编译性语言：C    C++<br>先把语言编译一遍，形成一个新的文件，再执行。执行速度快、跨平台性差。</li>
<li>解释性语言：js    php     python<br>不需要编译成文件。跨平台性好、执行速度慢。</li>
<li>java结合两者优点，效率折中，java通过javac编译成.class语言，在jvm(Java Virtual Machine)中执行。</li>
</ul>
<blockquote>
<p><strong>ECMA标准</strong> - 为了取得技术优势，微软推出JScript，CEnvi推出ScriptEase，与javaScript一样可在浏览器中运行。为了统一规格，javascript兼容于ECMA（European Computer Manufacturers Association，欧洲计算机制造联合会）标准，因此也称为ECMAScript。<br><strong>DOM</strong>  Document Object Model<br><strong>BOM</strong>  Browser Object Model</p>
</blockquote>
<h1 id="ECMAScript"><a href="#ECMAScript" class="headerlink" title="ECMAScript"></a><font color="#1B90D6">ECMAScript</font></h1><p>行间样式、页面内嵌标签、外部引入（为符合W3C标准：结构、样式、行为相分离，通常会采用外部引入）</p>
<h2 id="一、基础语法"><a href="#一、基础语法" class="headerlink" title="一、基础语法"></a><font color="#5EA4CE">一、基础语法</font></h2><h3 id="1-变量（variable）"><a href="#1-变量（variable）" class="headerlink" title="1. 变量（variable）"></a><strong>1. 变量（variable）</strong></h3><ul>
<li>1) 变量声明</li>
<li><p>2）命名规则<br>变量名只能以英文字母、 _ 、 $开头<br>变量名可以包括英文字母、 _ 、 $和数字<br>不可以用系统的关键字、保留字作为变量名</p>
<p>关键字<br>var void if else switch case default do while try catch throw for continue break return in delete typeof instanceof new this with finally function</p>
<p>保留字<br>boolean const char byte double float int long short enum interface static private protected package public import class super extends throws debugger export implements abstract final goto native synchronized transient volatile</p>
</li>
</ul>
<h3 id="2-值类型"><a href="#2-值类型" class="headerlink" title="2. 值类型"></a><strong>2. 值类型</strong></h3><ul>
<li>不可改变的原始值（栈类型 stack）： number string Boolean undefined null Symbol</li>
<li><p>引用值（堆数据 heap）： object</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. num1和num2分别是什么？</span><br><span class="line">    var a = 1;</span><br><span class="line">    var b = 2;</span><br><span class="line">    var num1 = a,b;</span><br><span class="line">    var num2 = (a,b);</span><br><span class="line">2. x的最终值是什么？</span><br><span class="line">    var x = 1;</span><br><span class="line">    if (function f() &#123;&#125;) &#123;</span><br><span class="line">      x += typeof f;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-js语法基本规则"><a href="#3-js语法基本规则" class="headerlink" title="3.  js语法基本规则"></a><strong>3.  js语法基本规则</strong></h3><pre><code>语句后面用分号结束；
书写格式要规范，“ + - = /”两边都应有空格；
js语法错误会引发后续代码终止，但不会影响其他js代码块；
</code></pre><h3 id="4-js运算符"><a href="#4-js运算符" class="headerlink" title="4. js运算符"></a><strong>4. js运算符</strong></h3>  <div class="post-tip">运算操作符:<br>    +                         1）数字运算，字符串连接   2）任何数据+字符串都等于字符串<br>    - * / % = ()             1）优先级“=”最弱  “()”较高<br>    ++ – += -= /= *= %=<br><br>    比较运算符: &gt; &lt; == &gt;= &lt;= != === !==  1）结果为boolean值<br><br>    逻辑运算符: &amp;&amp; || ！ 1）结果为真实值<br><br>    被认定为false的值: undefined null NaN ‘’ “” 0 false<br><br>    typeof: number 、 string 、 boolean 、 undefined 、 object 、 function六种数据类型<br>  </div>

<h3 id="5-类型转换"><a href="#5-类型转换" class="headerlink" title="5. 类型转换"></a><strong>5. 类型转换</strong></h3><pre><code>- 显示类型转换
    Number() String() Boolean() toString() parseInt() parseFloat()
- 隐式类型转换
    isNaN()     被认定NaN:undefined 、 NaN 、{}
    ++  --  +  -（一元正负）
    +
    *、/ %
    &amp;&amp; || !
    &lt;   &gt;   &lt;=   &gt;=
    ==   !=
- 不发生类型转换
    === !==
</code></pre><p>  思考：<br>  1) 请问以下c的值分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = 1;            var a = 0;              var a = 1;</span><br><span class="line">var b = 2;            var b = 2;              var b = 0;</span><br><span class="line">var c = a &amp;&amp; b;       var c = a &amp;&amp; b;         var c = a &amp;&amp; b;</span><br></pre></td></tr></table></figure></p>
<p>  2) 请问以下c的值分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = 1;            var a = 0;              var a = 1;</span><br><span class="line">var b = 2;            var b = 2;              var b = 0;</span><br><span class="line">var c = a || b;       var c = a || b;         var c = a || b;</span><br></pre></td></tr></table></figure></p>
<p>  3) 请问以下结果分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = 0;                       var a = 0;             </span><br><span class="line">var b = 2;                       var b = 2;        </span><br><span class="line">a &lt; b &amp;&amp; document.write(b)       a &gt; b &amp;&amp; document.write(b)</span><br></pre></td></tr></table></figure></p>
<p>  4) 请问以下结果分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NaN == NaN  [] == []  undefined == undefined  undefined == null</span><br></pre></td></tr></table></figure></p>
<p>  5) 请问以下的值分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var a = 1 + 1 + <span class="string">'aini'</span> + 1 + 1;</span><br><span class="line">var b = 1 + 1 + <span class="string">'aini'</span> + ( 1 + 1 );</span><br></pre></td></tr></table></figure></p>
<p>  6) 请问以下结果是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = 1 / 0;</span><br><span class="line">var b = 1 / 0;</span><br><span class="line">document.write(a - b);</span><br></pre></td></tr></table></figure></p>
<p>  7) 请问以下结果分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var a = 0;                          var a = 0;</span><br><span class="line">var b = 10;                         var b = 10;</span><br><span class="line">b += a++;                           b += ++a;</span><br><span class="line">document.write(b,a);                document.write(b,a);</span><br></pre></td></tr></table></figure></p>
<p>  8) 请问以下结果分别是什么？<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var a = ( 10 * 3 - 4 / 2 + 1 ) % 2,</span><br><span class="line">    b = 3;</span><br><span class="line">b %= a;</span><br><span class="line">document.write(a++, --b);</span><br></pre></td></tr></table></figure></p>
<p>  9) var a = 123; var b = 234;请交换a 和 b的值。</p>
<h3 id="6-条件语句"><a href="#6-条件语句" class="headerlink" title="6. 条件语句"></a><strong>6. 条件语句</strong></h3><p>  if 、 if else 、 if else if<br>  for 、 while 、do while<br>  switch  case default<br>  break 、 continue</p>
<h3 id="7-引用值"><a href="#7-引用值" class="headerlink" title="7. 引用值"></a><strong>7. 引用值</strong></h3><p>1）数组<br>2）对象<br>3）函数</p>
<ol>
<li>函数声明、函数表达式</li>
<li>参数(形参、实参、实参列表)</li>
<li>返回值<br>return什么，函数就等于什么（函数名用小驼峰式 写法）</li>
<li><p>作用域<br>定义：变量（变量作用域又称上下文）和函数生效（能被访问）的区域<br>全局变量、局部变量<br>作用域的访问顺序</p>
<p><em>注意：形参、实参、实参列表（arguments）的映射关系。</em></p>
<blockquote>
<p>大加法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">BigAdd</span></span>() &#123;</span><br><span class="line">  var sum = 0;</span><br><span class="line">  <span class="keyword">for</span> (var i = 0 ; i &lt; arguments.length ; i++) &#123;</span><br><span class="line">    sum += arguments[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> sum; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ol>
<h2 id="二、复杂数据类型"><a href="#二、复杂数据类型" class="headerlink" title="二、复杂数据类型"></a>二、复杂数据类型</h2><h3 id="2-1）函数"><a href="#2-1）函数" class="headerlink" title="2.1）函数"></a>2.1）函数</h3><h4 id="1、预编译"><a href="#1、预编译" class="headerlink" title="1、预编译"></a>1、预编译</h4><p>  （规律）函数声明提升、变量声明提升<br>  （原理）预编译发生在执行的前一刻。一个函数执行，函数会先发生预编译，预编译过程中会产生执行期上下文对象。Activation Object 活动对象（AO）</p>
<blockquote>
<p>四部曲<br>    1、创建AO对象<br>    2、找形参和变量声明，将变量和形参名作为AO属性名，值为undefined<br>    3、将实参值和形参统一<br>    4、在函数体里面找函数声明，值赋予函数体</p>
<pre><code>* 每个函数最后都有一个return，当执行到这一步时，AO被处理掉，函数就不执行了。*
</code></pre></blockquote>
<blockquote>
<p>全局也能预编译<br>    三步：<br>    1、创建GO（Global Object）对象<br>    2、找变量声明，将变量名作为GO属性名，值为undefined<br>    3、找函数声明，值赋予函数体</p>
</blockquote>
<h4 id="2、作用域"><a href="#2、作用域" class="headerlink" title="2、作用域"></a>2、作用域</h4><ul>
<li><p>[[scope]]：每个js函数都是一个对象，对象中有些属性我们可以访问，有些不可以，这些属性仅供js引擎存取，[[scope]]就是其中一个。[[scope]]指的就是我们所说的作用域，存储了运行期上下文对象的集合。</p>
</li>
<li><p>作用域链：[[scope]]这个集合呈链式链接。我们把这个链式链接叫做作用域链。</p>
</li>
<li><p>运行期上下文：当函数执行时，会创建一个称为执行期上下文的内部对象。一个执行期上下文定义了一个函数执行时的环境，函数每次执行时对象的执行期上下文都是独一无二的，所以多次调用一个函数会导致创建多个执行期上下文，当函数执行完，执行上下文被销毁。</p>
</li>
<li><p>查找变量：从作用域链的顶端依次向下查找。</p>
</li>
</ul>
<h4 id="3、闭包"><a href="#3、闭包" class="headerlink" title="3、闭包"></a>3、闭包</h4><blockquote>
<p>当内部函数被保存到外部时，会生成闭包，闭包会导致原有作用域链不释放，造成内存泄露</p>
</blockquote>
<h5 id="闭包的作用"><a href="#闭包的作用" class="headerlink" title="闭包的作用"></a>闭包的作用</h5><p>a) 可以实现公有变量<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">函数累加器（公有变量）</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">a</span></span>()&#123;                               <span class="keyword">function</span> <span class="function"><span class="title">a</span></span>()&#123;</span><br><span class="line">  var num = 0;                                var num = 0;</span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">b</span></span>()&#123;                               <span class="keyword">function</span> <span class="function"><span class="title">b</span></span>()&#123;</span><br><span class="line">    console.log(++num);                          console.log(++num);</span><br><span class="line">  &#125;                                           &#125;</span><br><span class="line">  <span class="built_in">return</span>  b;                                  <span class="keyword">function</span> <span class="function"><span class="title">c</span></span>()&#123;</span><br><span class="line">&#125;                                                console.log(--num);</span><br><span class="line">var getCounter = a();                          &#125;</span><br><span class="line">getCounter();    ---&gt; 1                        <span class="built_in">return</span> [b,c];</span><br><span class="line">getCounter();    ---&gt; 2                      &#125;</span><br><span class="line">getCounter();    ---&gt; 3                      var getCounterArr = a();  </span><br><span class="line">                                             getCounterArr[0]();    ---&gt; 1   </span><br><span class="line">                                             getCounterArr[1]();    ---&gt; 0</span><br></pre></td></tr></table></figure></p>
<p>b) 可以做缓存<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">eater</span></span>()&#123;</span><br><span class="line">  var food = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">eat</span></span>()&#123;</span><br><span class="line">    console.log(food);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">function</span> buy(foods)&#123;</span><br><span class="line">    food = foods;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> &#123; eat: eat, buy: buy &#125;;</span><br><span class="line">&#125;</span><br><span class="line">var person = eater();</span><br><span class="line">person.buy(<span class="string">'apple'</span>);</span><br><span class="line">person.eat();          ----&gt; <span class="string">'apple'</span></span><br></pre></td></tr></table></figure></p>
<p>c) 可以实现封装、属性私有化<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">wrapper</span></span>()&#123;</span><br><span class="line">  var slice = Array.prototype.slice;</span><br><span class="line">  ...很多变量</span><br><span class="line">  <span class="keyword">function</span> $()&#123;</span><br><span class="line">    ...很多变量</span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">add</span></span>()&#123;...&#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">show</span></span>()&#123;...&#125;</span><br><span class="line">    ...很多函数</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> &#123;add: add,show: show...很多函数&#125;;</span><br><span class="line">&#125;</span><br><span class="line">var $ = wrapper();</span><br><span class="line">var obj = $();</span><br></pre></td></tr></table></figure></p>
<font color="red">注：闭包会大量占用内存资源（作用域链不释放），要了解闭包的原理再使用，否则浪费内存。</font>

<h5 id="闭包的高级应用"><a href="#闭包的高级应用" class="headerlink" title="闭包的高级应用"></a>闭包的高级应用</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">test</span></span> () &#123;</span><br><span class="line">  var arr = [];</span><br><span class="line">  <span class="keyword">for</span> (var i = 0 ; i &lt; 10 ; i ++) &#123;</span><br><span class="line">    arr[i] = <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">      console.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line">var outerArr = <span class="built_in">test</span>();</span><br><span class="line"><span class="keyword">for</span> (var j = 0 ; j &lt; 10 ; j++) &#123;</span><br><span class="line">  outerArr[j]();</span><br><span class="line">&#125;</span><br><span class="line">结果是10个10 ，这是为什么呢？</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">test</span></span>() &#123;</span><br><span class="line">  var arr = [];</span><br><span class="line">  <span class="keyword">for</span> (var i = 0 ; i &lt; 10 ; i++ ) &#123;</span><br><span class="line">    arr[i] =(<span class="keyword">function</span>(j)&#123;</span><br><span class="line">      console.log(j);</span><br><span class="line">    &#125;(i))</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line">var outerArr = <span class="built_in">test</span>();</span><br><span class="line"><span class="keyword">for</span> (var j = 0 ; j &lt; 10 ; j++) &#123;</span><br><span class="line">  outerArr[j]();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4、立即执行函数"><a href="#4、立即执行函数" class="headerlink" title="4、立即执行函数"></a>4、立即执行函数</h4><ul>
<li><p>此类函数没有生命，在一次执行完后立即释放，适合做初始化工作。</p>
</li>
<li><p>写法：(function())  或   (function)()</p>
<pre><code>函数声明 ❌  函数表达式 ✅
只有函数表达式+()才能执行（能被执行符号执行的表达式，执行一次，函数就被忽略，不能再使用）
</code></pre></li>
<li><p>+ - ！ &amp;&amp; ||可以是一个函数声明变成一个表达式<br>+function test(){}();          —&gt; 可以执行，但是再test()会报错<br>true &amp;&amp; function test(){}();   —&gt; ✅<br>false || function test(){}();  —&gt; ✅</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jQuery中用到的就是闭包，立即执行函数和原型</span><br><span class="line">(<span class="function"><span class="title">function</span></span> ()&#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">jQuery</span></span>()&#123;</span><br><span class="line">    <span class="built_in">return</span> jQuery.prototype.init();</span><br><span class="line">  &#125;</span><br><span class="line">  jQuery.prototype.init = <span class="function"><span class="title">funtcion</span></span>()&#123;...&#125;</span><br><span class="line">  jQuery.prototype.init.prototype = jQuery.prototype;</span><br><span class="line"></span><br><span class="line">  window.$ = jQuery;</span><br><span class="line">&#125;())</span><br><span class="line">这样后续，$就替代jQuery。</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-2）对象"><a href="#2-2）对象" class="headerlink" title="2.2）对象"></a>2.2）对象</h3><h4 id="1、对象"><a href="#1、对象" class="headerlink" title="1、对象"></a>1、对象</h4><h5 id="1）对象的创建方法"><a href="#1）对象的创建方法" class="headerlink" title="1）对象的创建方法"></a>1）对象的创建方法</h5><ul>
<li>字面量<ul>
<li>var obj = {}</li>
<li>缺点：每创建一次只对应一个对象，比较局限。</li>
</ul>
</li>
<li>构造函数<ul>
<li>系统自带：new Object(); Array(); Number(); Boolean; Date();</li>
<li>自定义：一般以一个函数为构造函数，函数名要大写</li>
</ul>
</li>
<li>Object.create(原型)方法</li>
</ul>
<h5 id="2）属性的增删改查"><a href="#2）属性的增删改查" class="headerlink" title="2）属性的增删改查"></a>2）属性的增删改查</h5><blockquote>
<p> 增 obj.attrValue = ‘hahaha’;<br>   删 delete obj.attrValue;<br>   改 obj.haha = ‘heihei’;   obj[haha] = ‘heihei’;  obj[‘haha’] = ‘heihei’;<br>   查 obj.haha   obj[haha]  obj[‘haha’]</p>
</blockquote>
<h5 id="3）包装类"><a href="#3）包装类" class="headerlink" title="3）包装类"></a>3）包装类</h5><p>  String();  Boolean();   Number();</p>
<h5 id="4）对象的枚举"><a href="#4）对象的枚举" class="headerlink" title="4）对象的枚举"></a>4）对象的枚举</h5><ol>
<li><p>for （ in ）<br>不仅可以遍历对象，还可以遍历数组</p>
</li>
<li><p>对象的枚举</p>
<ul>
<li><font color="red">hasOwnProperty</font><br>是否是对象自己的属性。只对自己对象的属性为true，对自己原型上的属性为false，其他更为false。</li>
<li><font color="red">for（ in ）</font><br>可以遍历自己及原型的属性。但是，当原型是系统的Object.prototype的时候不会遍历。</li>
<li><font color="red">in</font><br>是否是对象上或者原型链上的属性。换句话说，只要对象能调用的属性就是true。</li>
<li><font color="red">instanceof</font><br>浅：A是否是B构造函数的构造出来的<br>深：A原型链上有没有B的原型</li>
</ul>
</li>
</ol>
<h4 id="2、原型及原型链"><a href="#2、原型及原型链" class="headerlink" title="2、原型及原型链"></a>2、原型及原型链</h4><h5 id="原型"><a href="#原型" class="headerlink" title="原型"></a>原型</h5><blockquote>
<p>定义：原型是function对象的一个属性，它定义了构造函数制造出的对象的公共祖先，通过该构造函数产生的对象，可以继承该原型的属性和方法，原型也是对象。</p>
</blockquote>
<blockquote>
<p>每个构造函数都有原型prototype，prototype也是对象<br>  每个对象都有<strong>proto</strong>属性， __proto__ 的值就是构造函数的原型prototype<br>  prototype 下有个属性：constructor指向该对象的构造函数 或 该构造函数自己。</p>
</blockquote>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Factory</span></span>()&#123;&#125;</span><br><span class="line">Factory.prototype.name = <span class="string">'wang'</span></span><br><span class="line">var obj = new Factory();</span><br><span class="line"></span><br><span class="line">obj.__proto__                  ---&gt;      &#123;name: <span class="string">"wang"</span>, constructor: ƒ&#125;</span><br><span class="line">Factory.prototype              ---&gt;      &#123;name: <span class="string">"wang"</span>, constructor: ƒ&#125;</span><br><span class="line">obj.__proto__.constructor      ---&gt;       ƒ <span class="function"><span class="title">Factory</span></span>()&#123;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>1） 构造函数.prototype.属性  是增加或修改原型的属性<br>      构造函数.prototype = {…} 是重写，覆盖本来的原型<br>  2） 构造函数构造出的对象，在出生（定义）时就知道了原型的地址。这时是谁就是谁，你可以给我的原型prototype增加或修改属性，但是如果你在我出生后在修改构造函数的原型，就和我没关系了。我的原型还是我出生时候的原型。</p>
</blockquote>
<h5 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h5><ul>
<li><p>谁调用的方法，方法内部的this就指向谁，没人调用则指向全局对象（window）</p>
</li>
<li><p>绝大多数对象的最终都会继承自Object.prototype</p>
</li>
<li><p>Object.create(null)，null创建出来的对象没有原型，NoPrototies</p>
</li>
</ul>
<h4 id="3、this指向问题"><a href="#3、this指向问题" class="headerlink" title="3、this指向问题"></a>3、this指向问题</h4><p>以下结果是什么，为什么？<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var num = 123;</span><br><span class="line">num.toString();</span><br></pre></td></tr></table></figure></p>
<p>结果是”123”，因为原型链中从底部向顶部查找toString()方法，数字的Number包装类里就有toString()方法，所以没有继续找Object的toString()方法。</p>
<h5 id="1）-call的实现原理"><a href="#1）-call的实现原理" class="headerlink" title="1） call的实现原理"></a>1） call的实现原理</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Function.prototype.myCall = <span class="keyword">function</span>(thisArg, ...args) &#123;</span><br><span class="line">  <span class="keyword">if</span> (typeof this !== <span class="string">'function'</span>) &#123;</span><br><span class="line">    throw new TypeError(<span class="string">'error'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  thisArg = thisArg || window;</span><br><span class="line">  thisArg.func = this;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">let</span> fn = thisArg.func(...args);</span><br><span class="line">  delete thisArg.func;</span><br><span class="line">  <span class="built_in">return</span> fn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="built_in">test</span>(params) &#123;</span><br><span class="line">  console.log(this.name, params);</span><br><span class="line">&#125;</span><br><span class="line">var name = <span class="string">'全局的名字'</span>;</span><br><span class="line">var obj = &#123;</span><br><span class="line">  name: <span class="string">'obj的名字'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">test</span>(<span class="string">'测试参数-无人调用'</span>);                    ----&gt;    全局的名字   测试参数-无人调用</span><br><span class="line">test.call(obj, <span class="string">'测试参数-obj调用'</span>);          ----&gt;    obj的名字    测试参数-obj调用</span><br></pre></td></tr></table></figure>
<h5 id="2）apply的实现原理"><a href="#2）apply的实现原理" class="headerlink" title="2）apply的实现原理"></a>2）apply的实现原理</h5><p>apply的实现原理和call一样，只不过是传入的参数不同处理不同而已。<br>其实,apply应该还要校验：参数只能有两个，且第二个参数必须是数组，否则会报错。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//Function.prototype.apply = <span class="keyword">function</span>(thisArg,args)</span><br><span class="line">//去除参数的第一个值后执行这个添加的函数</span><br><span class="line">const res = thisArg.fn(...args);//只是参数处理不用，args这里只接受数组</span><br></pre></td></tr></table></figure></p>
<h5 id="3）bind的实现原理"><a href="#3）bind的实现原理" class="headerlink" title="3）bind的实现原理"></a>3）bind的实现原理</h5><p>将绑定函数当作构造函数使用，bind 提供的 this 指向无效，但是还是可以预设参数<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> Test3(a, b) &#123;</span><br><span class="line">  this.a = a;</span><br><span class="line">  this.b = b;</span><br><span class="line">&#125;</span><br><span class="line">Test3.prototype.add = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">  <span class="built_in">return</span> this.a + this.b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果不用 bind，正常来说这样处理</span></span><br><span class="line">var t1 = new Test3(1, 2);</span><br><span class="line">t1.add(); <span class="comment"># 3, this 指向 t1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 bind</span></span><br><span class="line">var NewTest3 = Test3.bind(null, 3);</span><br><span class="line">var t2 = new NewTest3(4);</span><br><span class="line">t2.add(); <span class="comment"># 7, this 指向 t2</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Function.prototype.bind = <span class="keyword">function</span> (oThis) &#123;</span><br><span class="line">  <span class="keyword">if</span>(typeof this !== <span class="string">'function'</span>) &#123;</span><br><span class="line">    throw new TypeError(<span class="string">'Function.prototype.bind - what is trying to bebound is noe callable'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var aArgs = Array.prototype.slice.call(arguments, 1),</span><br><span class="line">      fToBind = this,</span><br><span class="line">      fNop = <span class="function"><span class="title">function</span></span> () &#123;&#125;,</span><br><span class="line">      fBound = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">        <span class="comment"># 当通过new方法调用时，this就是fNop的一个实例</span></span><br><span class="line">        <span class="built_in">return</span> fToBind.apply(this instanceof fNop ? this : (oThis || this) , aArgs.concat(Array.prototype.slice.call(arguments)));</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">  fNop.prototype = this.prototype;</span><br><span class="line">  fBound.prototype = new fNop();</span><br><span class="line">  <span class="built_in">return</span> fBound;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>call 、 apply 和 bind的区别：<br>1）apply、call 都是直接执行调用函数，并让this执行第一个参数<br>              二者只是传参格式不同：call(obj,arguments1, arguments2…)<br>                                apply(obj,[arguments1, arguments2…])<br>2）bind绑定this后返回一个函数闭包，不直接执行。（将绑定函数当做构造函数使用，bind 提供的 this 指向无效，但是还是可以预设参数）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function test()&#123;var a = 12;this.sayA = function()&#123;console.log(this.a);&#125;&#125;</span><br><span class="line">var oTest = new test()</span><br><span class="line">oTest.sayA();   ---&gt; undefined</span><br></pre></td></tr></table></figure>
<p>阿里经典面试题：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var name = &apos;222&apos;;</span><br><span class="line">var a = &#123;</span><br><span class="line">  name: &apos;111&apos;,</span><br><span class="line">  say: function () &#123;</span><br><span class="line">    console.log(this.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">a.say();</span><br><span class="line">var b = &#123;</span><br><span class="line">  name: &apos;333&apos;,</span><br><span class="line">  say: function (fun) &#123;</span><br><span class="line">    fun();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">b.say(a.say);</span><br><span class="line">b.say = a.say;</span><br><span class="line">b.say();</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function test() &#123;foo = 2; this.foo = 4; console.log(this.foo);&#125;</span><br><span class="line">test();</span><br><span class="line">new test();</span><br><span class="line"></span><br><span class="line">function test() &#123;this.foo = 4;foo = 2; console.log(this.foo);&#125;</span><br><span class="line">test();</span><br><span class="line">new test();</span><br></pre></td></tr></table></figure>
<p>先查AO，再查GO。<br>局部变量 - this - 全局</p>
<h4 id="4、继承发展史"><a href="#4、继承发展史" class="headerlink" title="4、继承发展史"></a>4、继承发展史</h4><p>1、传统形式：会沿着原型链一脉相承，继承父辈祖辈的所有属性，但是可能很多属性是没用的。<br>2、借用构造函数：不能继承借用构造函数的原型，每次构造函数都要多走一个函数。（call/apply）<br>3、共享原型：不能随便改动自己的原型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Fathor</span></span> () &#123;...&#125;</span><br><span class="line">var oFather = new Father();</span><br><span class="line"></span><br><span class="line">Son.prototype = Fathor.prototype;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Son</span></span> () &#123;...&#125;</span><br><span class="line">var oSon = new Son();</span><br></pre></td></tr></table></figure>
<p>这样，共用属性都放在原型里，再共享原型（继承），但是，如果其中更改了Son的原型,这样Father的原型也随之改变（如：Son.prototype.name = ‘wang’;则Father.prototype.name也会如上）。这样的相互影响有时并不是我们想要的。</p>
<p>4、圣杯模式<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Father</span></span> () &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Son</span></span> () &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> inherit (target, origin) &#123;</span><br><span class="line">  var oFn = <span class="function"><span class="title">function</span></span> () &#123;&#125;;</span><br><span class="line">  oFn.prototype = origin.prototype;</span><br><span class="line">  target.prototype =  new oFn();</span><br><span class="line">&#125;</span><br><span class="line">inherit(Son,Father);</span><br><span class="line">var oSon = new Son();</span><br><span class="line">var oFather = new Father();</span><br><span class="line"></span><br><span class="line">Son.prototype.name = <span class="string">'wang'</span>;</span><br><span class="line">oSon.name          ----&gt;    <span class="string">'wang'</span></span><br><span class="line">oFather.name       ----&gt;    undefined</span><br></pre></td></tr></table></figure></p>
<h4 id="5、模块化开发"><a href="#5、模块化开发" class="headerlink" title="5、模块化开发"></a>5、模块化开发</h4><h5 id="1）-命名空间"><a href="#1）-命名空间" class="headerlink" title="1） 命名空间"></a>1） 命名空间</h5><ol>
<li>污染全局<br>是指你在a.js中var a = 10; 在 b.js中var a = 20; 如果你同事应用a.js和b.js，那么变量a就会冲突，究竟用a.js里的a还是b.js里的a。（不同的人开发难免会出现相同命名） </li>
<li>模块化开发<br>将一个完整的项目，分解成多个模块，不同的人开发不同的模块，最后协同整合。</li>
<li>命名空间<br>模块化开发的方式，很容易发生全局变量污染的问题，因此我们需要管理变量，可以采用命名空间的方式管理变量。</li>
</ol>
<h5 id="2）-匿名函数自执行-封闭作用域"><a href="#2）-匿名函数自执行-封闭作用域" class="headerlink" title="2） 匿名函数自执行 封闭作用域"></a>2） 匿名函数自执行 封闭作用域</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var jQuery = (<span class="function"><span class="title">function</span></span> () &#123;                     <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">  <span class="comment"># AO -&gt; jQuery(功能)                             # AO -&gt; jQuery(功能)            </span></span><br><span class="line">  var slice=Array.prototype.slice;                var slice = Array.prototype.slice;</span><br><span class="line">  var toString=Object,prototype.toString;         var toString = Object,prototype.toString;</span><br><span class="line">  ...                                             ...</span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">jQuery</span></span> ()&#123;...使用变量slice toString&#125;     <span class="keyword">function</span> <span class="function"><span class="title">jQuery</span></span> ()&#123;...使用变量slice toString&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">return</span> jQuery;                                   window.$ = jQuery;</span><br><span class="line">&#125;)();                                            &#125;)();</span><br><span class="line">匿名函数自执行+封闭作用域+闭包                        匿名函数自执行+封闭作用域</span><br><span class="line">使原有的AO不释放，通过<span class="built_in">return</span>赋给变量                  将jQuery赋给全局变量</span><br><span class="line">该变量有函数功能，但无法使用其中的变量                  该变量有函数功能，但无法使用其中的变量</span><br></pre></td></tr></table></figure>
<ul>
<li><p>测试：这种解决办法能有效管理变量，防止变量污染</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ctl.js                                           cst.js</span><br><span class="line">(<span class="function"><span class="title">function</span></span>()&#123;                                     (<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">  var name = <span class="string">'ctl'</span>;                                var name = <span class="string">'cst'</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">show</span></span> () &#123;                               var age = 18;</span><br><span class="line">    console.log(name,  age);                       <span class="keyword">function</span> <span class="function"><span class="title">show</span></span> () &#123;</span><br><span class="line">  &#125;                                                   console.log(name,  age);&#125;</span><br><span class="line">  <span class="keyword">function</span> <span class="function"><span class="title">change</span></span>() &#123;                              <span class="keyword">function</span> <span class="function"><span class="title">change</span></span>() &#123;</span><br><span class="line">    name += <span class="string">'10'</span>;                                     name += <span class="string">'10'</span>;</span><br><span class="line">  &#125;                                                 &#125;</span><br><span class="line"></span><br><span class="line">  window.ctlMake = &#123;show: show, change: change&#125;;    window.cstMake = &#123;show: show, change: change&#125;;</span><br><span class="line">&#125;)();                                              &#125;)();</span><br><span class="line"></span><br><span class="line">index.html</span><br><span class="line">&lt;script src = <span class="string">'ctl.js'</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src = <span class="string">'cst.js'</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  cstMake.show();           -----&gt; <span class="string">"cst"</span></span><br><span class="line">  ctlMake.show();           -----&gt; 报错：age is not defined</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><font color="red">* 每一个功能入口就是执行自己的函数，调用自己的变量，不会相互污染。</font><br>PS：当然啦，现在的前端自动化构建工具是，就不用麻烦了。</p>
</li>
</ul>
<h5 id="3）-链式调用模式"><a href="#3）-链式调用模式" class="headerlink" title="3） 链式调用模式"></a>3） 链式调用模式</h5><p>思考问题：</p>
<ol>
<li>如何实现链式调用模式（模仿jquery）</li>
<li>obj.eat().drink().play().laugh().sleep();<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">var mrDeng = &#123;</span><br><span class="line">  eat: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">    console.log(<span class="string">'eat'</span>);</span><br><span class="line">    reeturn this;</span><br><span class="line">  &#125;,</span><br><span class="line">  drink: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">    console.log(<span class="string">'drink'</span>);</span><br><span class="line">    reeturn this;</span><br><span class="line">  &#125;,</span><br><span class="line">  paly: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">    console.log(<span class="string">'paly'</span>);</span><br><span class="line">    reeturn this;</span><br><span class="line">  &#125;,</span><br><span class="line">  laugh: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">    console.log(<span class="string">'laugh'</span>);</span><br><span class="line">    reeturn this;</span><br><span class="line">  &#125;,</span><br><span class="line">  sleep: <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">    console.log(<span class="string">'sleep'</span>);</span><br><span class="line">    reeturn this;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>jQuery有一个经典的使用方法：通过$()将标签选中，包装成一个对象（如$(‘div’)），这个对象中有很多方法。可以调用一些方法去操作你选中的那个标签，可.css()再。css()，链式调用<br>$(‘div’).css().css().attr().addClass();</p>
<h4 id="6、克隆"><a href="#6、克隆" class="headerlink" title="6、克隆"></a>6、克隆</h4><p>判断数据类型的四种方式：typeof toString instaceof contructor </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">浅克隆：</span><br><span class="line">function cloneFactory (copy, origin) &#123;</span><br><span class="line">  copy = copy || &#123;&#125;;</span><br><span class="line">  for (var props in origin) &#123;</span><br><span class="line">    copy[props] = origin[props];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">深克隆：</span><br><span class="line">function deepClone (copy, origin) &#123;</span><br><span class="line">  copy = copy || &#123;&#125;;</span><br><span class="line">  var arrStr = &apos;[Object Array]&apos;;</span><br><span class="line">  for (var props in origin) &#123;</span><br><span class="line">    if (origin[props] !== null &amp;&amp; (origin[props] === &apos;object&apos;) ) &#123;</span><br><span class="line">      if (Object.prototype.toString.call(origin[props]) === arrStr) &#123;</span><br><span class="line">        copy[props] = [];</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">         copy[props] = &#123;&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      deepClone(copy[props], origin[props]);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      copy[props] = origin[props];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">深克隆优化版本：</span><br><span class="line">function deepCloneFactory(copy, origin) &#123;</span><br><span class="line">  copy = copy || &#123;&#125;;</span><br><span class="line">  var arr = [],obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  for (var props in origin) &#123;</span><br><span class="line">    if (origin[props] === copy[props]) &#123;</span><br><span class="line">      continue;</span><br><span class="line">    &#125;</span><br><span class="line">    for (var attrs in copy) &#123;</span><br><span class="line">      if (attrs === props) &#123;</span><br><span class="line">        if (Object.prototype.toString.call(origin[props]) === &apos;[object Array]&apos;) &#123;</span><br><span class="line">          arr = copy[attrs];</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          obj = copy[attrs];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (origin.hasOwnProperty(props)) &#123;</span><br><span class="line">      if (origin[props] !== null &amp;&amp; typeof origin[props] === &apos;object&apos;) &#123;</span><br><span class="line">        if (Object.prototype.toString.call(origin[props] === &apos;[object Array]&apos;)) &#123;</span><br><span class="line">          copy[props] = arr;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          copy[props] = obj;</span><br><span class="line">        &#125;</span><br><span class="line">        deepCloneFactory(copy[props], origin[props]);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        copy[props] = origin[props];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JSON.parse(JSON.stringify())</p>
<h3 id="2-3）数组"><a href="#2-3）数组" class="headerlink" title="2.3）数组"></a>2.3）数组</h3><h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>1、创建方式<br>  1）new Array(length/content)<br>  2）字面量</p>
<p>2、数组的读和写<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr[num]               <span class="comment"># 不可溢出读</span></span><br><span class="line">arr[num] = xxx;        <span class="comment"># 可溢出读</span></span><br></pre></td></tr></table></figure></p>
<p>3、数组的常用方法</p>
<ol>
<li><p>改变原数组<br>push     尾部加值，改变原数组，返回数组长度<br>pop      尾部弹指，改变原数组，返回被弹出的值<br>shift    首部弹值，改变原数组，返回被弹出的值<br>unshift  首部加值，改变原数组，返回数组长度<br>splice   在数组任意位加或删，返回截取的数组<br>reverse  倒序<br>sort     只能排单位数字，可</p>
<pre><code>arr.sort(function(a,b) {
  return a-b;
})
</code></pre><p><font color="red">* 让有序数组输出乱序：</font> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var arr = [1,2,3,4,5,6,7,8,9];</span><br><span class="line">console.log(arr.sort(() =&gt; Math.random()-0.5));</span><br></pre></td></tr></table></figure>
</li>
<li><p>不改变原数组<br>concat    返回连接后的数组，不改变原数组<br>join -&gt; split<br>toString<br>slice</p>
<p><font color="orange">forEach</font>  只是简单的将数组遍历，类似于军人接受检阅，但是检阅结束并不会返回任何东西，也不会改变原数组,forEach的返回永远是undefind<br><font color="orange">map</font>      可以比喻成去超市买东西，你拿了一个物品清单，然后服务员帮你拿好东西，返回给你一个物品的新数组，但是对清单原数组不发生改变<br><font color="orange">filter</font>   就是让男生排队身高高于180的就归入到新数组中，最后返回一个里面装着所有180+的男生的数组，不改变原数组<br><font color="orange">reduce</font>    主要是为了对所有数组进行累加，最后返回一个值，不改变原数组，类似让男生把排队把把身高加起来<br><font color="orange">find</font>     就是你去找人想找一个180的男生帮你去搬砖，只要找到第一个就停止遍历，因为只要找一个，为了减少无用的操作，虽然其他方法也能实现同样的要过，但是最好用find()</p>
</li>
</ol>
<h4 id="类数组"><a href="#类数组" class="headerlink" title="类数组"></a>类数组</h4><ol>
<li>可以利用属性名模拟数组的特性</li>
<li>可以动态的增长length属性</li>
<li>如果强行让类数组调用push方法，则会根据length属性值的位置进行属性的扩充</li>
</ol>
<ul>
<li>要有索引（数字）属性，必须有length属性，最好加上push可以向数组一样用。如果再加上splice，控制台输出和数组一样。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1. 问题1:</span><br><span class="line">  var obj = &#123;</span><br><span class="line">    2: &apos;a&apos;,</span><br><span class="line">    3: &apos;b&apos;,</span><br><span class="line">    length: 2,</span><br><span class="line">    push: Array.prototype.push</span><br><span class="line">  &#125;;</span><br><span class="line">  obj.push(&apos;c&apos;);</span><br><span class="line">  obj.push(&apos;d&apos;);</span><br><span class="line">  console.log(obj);  ---&gt; &#123;2: &quot;c&quot;, 3: &quot;d&quot;, length: 4, push: ƒ&#125;</span><br><span class="line"></span><br><span class="line">2. 问题2：编写方法对所有数据类型都能判断准确。</span><br><span class="line">  function myType (myVar) &#123;</span><br><span class="line">    var cache = &#123;</span><br><span class="line">      &apos;[object Number]&apos;: &apos;number-object&apos;,</span><br><span class="line">      &apos;[object String]&apos;: &apos;string-object&apos;,</span><br><span class="line">      &apos;[object Boolean]&apos;: &apos;bool-object&apos;,</span><br><span class="line">      &apos;[object Array]&apos;: &apos;array&apos;,</span><br><span class="line">      &apos;[object Object]&apos;: &apos;object&apos;,</span><br><span class="line">    &#125;;</span><br><span class="line">    if (myVar === null) &#123;</span><br><span class="line">      return &apos;null&apos;;</span><br><span class="line">    &#125; else if (typeof myVar === &apos;object&apos;) &#123;</span><br><span class="line">      return cache[Object.prototype.toString.call(myVar)];</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      return typeof myVar;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a><font color="#FF69B4">DOM</font></h1><p>DOM（Document Object Model），定义了表达和修改文档所需对象，定义了这些对象之间的行为和属性以及这些对象之间的关系。DOM对象即为宿主对象，由浏览器厂商定义，用来操作html和css功能的一类对象的集合。也有人称DOM是对HTML以及XML的标准编程接口。</p>
<p>js不能直接操作html标签，但是浏览器提供了一类对象，可以作为js操作html的桥梁。</p>
<h2 id="一、基本操作"><a href="#一、基本操作" class="headerlink" title="一、基本操作"></a>一、基本操作</h2><h3 id="1）DOM节点"><a href="#1）DOM节点" class="headerlink" title="1）DOM节点"></a>1）DOM节点</h3><h4 id="查看元素节点"><a href="#查看元素节点" class="headerlink" title="查看元素节点"></a>查看元素节点</h4><p>  document代表整个文档</p>
<p>  document.getElementById(); 在ie8以下的浏览器，不取区分id大小写，而且也返回匹配name属性的元素。<br>  document.getElementsByClassName(); ie8及以下的ie版本中没有，可以多个class一起。<br>  document.getElementsByTagName();<br>  document.getElementsByName(); 需注意，只有部分标签name可生效（表单、表单元素、img、iframe）。<br>  querySelector(); css选择器，在ie7及以下的版本中没有。<br>  querySelectorAll(); css选择器，在ie7及以下的版本中没有。</p>
  <div class="post-warning">注：querySelector和querySelectorAll选出的元素不是实时的，是一个副本，一个快照。其他方法选出的dom都是实时的。<br>    1）querySelector()只返回一个<br>    2）querySelectorAll()返回所有但不更新<br>    3）其他返回所有并更新<br>  </div>

<h4 id="遍历节点树"><a href="#遍历节点树" class="headerlink" title="遍历节点树"></a>遍历节点树</h4><p>  parentNode 父节点（最顶端的parentNode是#document）<br>  childNodes 子节点们<br>  firstChild 第一个子节点<br>  lastChild  最后一个子节点<br>  nextSibling 后一个兄弟节点<br>  previousSibling 前一个兄弟节点</p>
<p>  节点类型：<br>  元素节点  – 1<br>  属性节点  – 2<br>  文本节点  – 3<br>  注释节点  – 8<br>  document – 9<br>  DocumentFragment – 11</p>
<p>  获取节点类型 nodeType</p>
<h4 id="基于元素节点树的遍历"><a href="#基于元素节点树的遍历" class="headerlink" title="基于元素节点树的遍历"></a>基于元素节点树的遍历</h4><p>  parentElement 返回当前元素的父节点<br>  children 只返回当前元素的元素子节点<br>  node.childElementCount === node.children.length 单签蒜素节点的子元素节点个数（IE不兼容）<br>  firstElementChild 返回第一个元素节点（IE不兼容）<br>  lastElementChild 返回最后一个元素节点（IE不兼容）<br>  nextElementSibling / previousElementSibling 返回后一个/前一个兄弟元素节点（IE不兼容）</p>
<h4 id="节点的属性和方法"><a href="#节点的属性和方法" class="headerlink" title="节点的属性和方法"></a>节点的属性和方法</h4><blockquote>
<p>属性：<br>  nodeName 元素的标签名，以大写形式表示，只读<br>  nodeValue Text节点或comment节点的文本内容，可读写<br>  nodeType 该节点的类型，只读<br>  style css属性，可读写<br>  attribute Element节点的属性集合(只有元素节点才有attribute，它是整个dom节点的属性集合，是一个类数组)</p>
</blockquote>
<blockquote>
<p>方法：<br>  Node.hasChildNodes();<br>  Node.setAttribute(‘attri-xxx’,’value-xxx’);<br>  Node.getAttribute(‘attri-xxx’);</p>
</blockquote>
<h4 id="对节点的增删改"><a href="#对节点的增删改" class="headerlink" title="对节点的增删改"></a>对节点的增删改</h4><blockquote>
<p>增<br>  document.createElement();<br>  document.createTextNode();<br>  document.createComment();<br>  document.createDocumentFragment();</p>
</blockquote>
<blockquote>
<p>插<br>  PARENTNODE.appendChild();<br>  PARENTNODE.insertBefore(a,b);</p>
</blockquote>
<blockquote>
<p>删<br>  parent.removeChild();</p>
</blockquote>
<blockquote>
<p>替换<br>  parent.replaceChild();</p>
</blockquote>
<h3 id="2-DOM树"><a href="#2-DOM树" class="headerlink" title="2) DOM树"></a>2) DOM树</h3>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DOM树：</span><br><span class="line"></span><br><span class="line">       - Document - HTMLDocument       - HTMLHeadElement </span><br><span class="line">      |                  - Text       |- HTMLBodyElement</span><br><span class="line">      |- CharactorData -|             |- HTMLTitleElement</span><br><span class="line">Node -|                  - Comment    |- HTMLParagraphElement</span><br><span class="line">      |- Element - HTMLElement ------ |- HTMLInputElement</span><br><span class="line">      |                                - ... etc</span><br><span class="line">       - Attr</span><br></pre></td></tr></table></figure>
<p>  Document是一个构造函数，但是用户不能new Document()创建新对象。<br>  document - HTMLDocument - Document:<br>  document是HTMLDocument构造函数的实例，原型是HTMLDocument.prototype。<br>  HTMLDocument.prototype也是对象，原型是Document.prototype。<br>  HTMLDocument.prototype.__proto__ -&gt; Document.prototype 构成原型链。</p>
  <div class="post-warning">观察DOM结构树，很容易发现，若在共有原型上加属性和方法，那么下面的构造函数的对象都可用。</div>

<blockquote>
</blockquote>
<pre><code>getElementById() 定义在Document.prototype上，即Element节点上不能使用。

getElementsByName() 定义在HTMLDocument.prototype上，即非html中的document意外不能使用（xml document Element）

getElementsByTagName() 定义在Document.prototype和Element.prototype上

Document.prototype上定义了documentElement属性，指代文档的根元素，在HTML文档中，他总是指代&lt; html&gt;&lt;\/html&gt;元素（只读不可写）。

HTMLDocument.prototype定义了一些常用的属性，body、head分别指代HTML文档中的&lt; body&gt;&lt;\/body&gt;&lt; head&gt;&lt;\/head&gt;标签。

getElementsByClassName()、querySelectorAll()、querySelectorAll、querySelector在Document，Element类中均有定义。
</code></pre><ul>
<li><p>节点的一些属性和方法<br>innerHTML<br>innerText(旧版本火狐不兼容)/textContent(老版本IE不兼容，主流浏览器一般用的都是innerText)</p>
<p>ele.setAttribute();<br>ele.getAttribute();</p>
</li>
</ul>
<h3 id="3-DOM基本操作"><a href="#3-DOM基本操作" class="headerlink" title="3) DOM基本操作"></a>3) DOM基本操作</h3><h4 id="日期对象"><a href="#日期对象" class="headerlink" title="日期对象"></a>日期对象</h4><blockquote>
<p>Date<br>var oDate = new Date();</p>
<p>// 获取<br>oDate.toString();<br>oDate.getFullYear(); 年<br>oDate.getMonth(); 月<br>oDate.getDate(); 日期<br>oDate.getDay(); 天数<br>oDate.getHours(); 时<br>oDate.getMinutes(); 分<br>oDate.getSeconds(); 秒<br>oDate.getMilliseconds(); 毫秒<br>oDate.getTime(); 自1970年1月1日至今的毫秒数</p>
<p>// 设置<br>oDate.setFullYear(); 年<br>oDate.setMonth(); 月<br>oDate.setDate(); 日期<br>oDate.setDay(); 天数<br>oDate.setHours(); 时<br>oDate.setMinutes(); 分<br>oDate.setSeconds(); 秒<br>oDate.setMilliseconds(); 毫秒<br>oDate.setTime(); 自1970年1月1日至今的毫秒数</p>
</blockquote>
<h4 id="js定时器"><a href="#js定时器" class="headerlink" title="js定时器"></a>js定时器</h4><p>  setInterval();<br>  setTimeout();<br>  clearInterval();<br>  clearTimeout();</p>
<p>  全局对象window上的方法，内部函数this指向window。</p>
<h4 id="查看滚动条的滚动距离"><a href="#查看滚动条的滚动距离" class="headerlink" title="查看滚动条的滚动距离"></a>查看滚动条的滚动距离</h4><p>  window.pageXOffset、window.pageXOffset (IE及IE8以下不兼容)<br>  document.body.scrollLeft、document.body.scrollTop (兼容性比较混乱)<br>  document.documentElement.scrollLeft、 document.documentElement.scrollTop (兼容性比较混乱)</p>
<h4 id="查看视口尺寸"><a href="#查看视口尺寸" class="headerlink" title="查看视口尺寸"></a>查看视口尺寸</h4><p>  window.innerWidth、window.innerHeight (IE及IE8以下不兼容)<br>  document.documentElement.clientWidth、document.documentElement.clientHeight (标准模式下，任意浏览器都兼容)<br>  document.body.clientWidth、 document.body.clientHeight (客户可视窗口，适用于怪异模式下的浏览器)</p>
<h4 id="查看元素的几何尺寸"><a href="#查看元素的几何尺寸" class="headerlink" title="查看元素的几何尺寸"></a>查看元素的几何尺寸</h4><p>  domEle.getBoundingClientRect(); </p>
<blockquote>
<p>兼容性好，该方法返回一个对象，对象里面有left、top、right、bottom等属性。left和top代表钙元素左上角的x和y坐标，right和bottom代表元素右下角的x，y坐标</p>
</blockquote>
<h4 id="查看元素尺寸"><a href="#查看元素尺寸" class="headerlink" title="查看元素尺寸"></a>查看元素尺寸</h4><p>  domEle.offsetWidth、domEle.offsetHeight</p>
<h4 id="查看元素位置"><a href="#查看元素位置" class="headerlink" title="查看元素位置"></a>查看元素位置</h4><p>  domEle.offsetLeft、 domEle.offsetTop</p>
<blockquote>
<p>对于无定位父级的元素，返回相对于文档的坐标。对于有定位的父级的元素，返回相对于最近的有定位的父级的坐标（无论是left还是margin-left等都是距离）。</p>
</blockquote>
<p>  domEle.offsetParent<br>  返回最近的有定位的父级，若无，返回body。body.offsetParent，返回null。</p>
<h4 id="让滚动条滚动"><a href="#让滚动条滚动" class="headerlink" title="让滚动条滚动"></a>让滚动条滚动</h4><p>  window上有三个方法：scroll() scrollTo() scrollBy()</p>
<h3 id="4）脚本化css"><a href="#4）脚本化css" class="headerlink" title="4）脚本化css"></a>4）脚本化css</h3><h4 id="读写元素css属性"><a href="#读写元素css属性" class="headerlink" title="读写元素css属性"></a>读写元素css属性</h4><p>  dom.style.prop 可读写样式，没有兼容性问题，碰到float这样的关键字属性，前面应加css。eg: float -&gt; cssFloat。<br>  复合属性必须拆解，组合单词变成小驼峰式写法。<br>  写入的值必须是字符串格式。</p>
<h4 id="查询计算样式"><a href="#查询计算样式" class="headerlink" title="查询计算样式"></a>查询计算样式</h4><p>  window.getComputedStyle(ele, null); 计算样式只读，返回的计算样式的值是绝对值，没有相对单位。（IE8及以下不兼容）</p>
<h4 id="查询样式"><a href="#查询样式" class="headerlink" title="查询样式"></a>查询样式</h4><p>  ele.currentStyle(了解就可以，现在都不用了，现在使用chrome会报错)</p>
<h2 id="二、事件"><a href="#二、事件" class="headerlink" title="二、事件"></a>二、事件</h2><h3 id="绑定事件处理函数"><a href="#绑定事件处理函数" class="headerlink" title="绑定事件处理函数"></a>绑定事件处理函数</h3><ul>
<li><p>ele.onxx = function (event) {};<br>兼容性好，基本等同于句柄。<br>但是一个元素的同一事件只能绑定一个处理程序。</p>
</li>
<li><p>ele.addEventListener(type, fn ,false);<br>IE9以下不兼容。<br>true：事件句柄在捕获阶段执行，false：事件句柄在冒泡阶段执行<br>一个元素的同一事件可以绑定多个处理程序，但是不能多次绑定同一处理程序。</p>
</li>
<li><p>ele.attachEvent(‘onxxx’, fn);<br>IE独有。<br>一个元素的同一事件可以绑定多个处理程序，但是不能多次绑定同一处理程序。</p>
</li>
</ul>
<blockquote>
<p>事件处理程序的运行环境（this）<br>  1、ele.onxx this指向dom元素本身<br>  2、ele.addEventListener this指向dom元素本身<br>  3、ele.attachEvent this指向window</p>
</blockquote>
<h3 id="解除事件处理函数"><a href="#解除事件处理函数" class="headerlink" title="解除事件处理函数"></a>解除事件处理函数</h3><p>  ele.onxxx = false / ‘’ / null;<br>  ele.removeEventListener(type, fn, false);<br>  ele.detachEvent(‘onxxx’, fn);</p>
  <div class="post-warning">注：若绑定匿名函数，则无法解除。</div>

<h3 id="事件冒泡-amp-捕获-gt-事件处理模型"><a href="#事件冒泡-amp-捕获-gt-事件处理模型" class="headerlink" title="事件冒泡&amp;捕获 -&gt; 事件处理模型"></a>事件冒泡&amp;捕获 -&gt; 事件处理模型</h3><ul>
<li><p>事件冒泡<br>结构上（非视觉上）嵌套关系的元素，会存在事件冒泡的功能，即同一事件，自子元素冒泡到父元素（自底向上）。</p>
</li>
<li><p>事件捕获<br>结构上（非视觉上）嵌套关系的元素，会存在事件捕获的功能，即同一事件，自父元素捕获至子元素（事件源元素）（自顶向下）。</p>
<p>触发顺序：先捕获后冒泡。<br>focus、blur、change、submit、reset、select等时间不冒泡。<br>IE没有捕获事件，就Chrome实现了捕获。</p>
</li>
</ul>
<p><br></p>
<ul>
<li><p>取消冒泡<br>W3C标准event.stopPropagation(); 但不支持IE9以下版本<br>IE独有event.cancelBubble = true;</p>
</li>
<li><p>阻止默认事件<br>默认事件 - 表单提交， a标签跳转， 右键菜单等<br>return false; 以对象属性的方式注册的事件才生效<br>event.preventDefault(); W3C标准，IE9以下不兼容<br>event.returnValue = false; 兼容IE</p>
<div class="post-warning">例如，我们来阻止【右键出菜单】这一默认事件：<br>  1、return false;是句柄方式阻止默认事件，只有用句柄的方式绑定事件，这种方式才好使。如以addEventListener注册的时间就不好使。<br>    document.oncontextmenu = function () { return false; }<br><br>  2、document.oncontextmenu = function (e) { e.preventDefault(); }<br><br>  3、document.oncontextmenu = function (e) { e.returnValue = false; }<br></div>



</li>
</ul>
<h3 id="事件对象"><a href="#事件对象" class="headerlink" title="事件对象"></a>事件对象</h3><ul>
<li>event || window.event（用于IE）</li>
<li>事件源对象：<strong>event.target</strong> 火狐只有这个、chrome两个都有<br><strong>event.srcElement</strong> IE只有这个，chrome两个都有</li>
</ul>
<h3 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h3><p>  利用事件冒泡和事件源对象进行处理<br>  优点：不需要循环所有的元素，一个一个绑定事件。当有新的子元素时不需要重新绑定事件。</p>
<h3 id="事件分类"><a href="#事件分类" class="headerlink" title="事件分类"></a>事件分类</h3><ul>
<li><strong>鼠标事件</strong><blockquote>
<p>click  mousedown  mousemove  mouseup  contextmenu<br>mouseover  mouseout  mouseenter mouseleave</p>
<ol>
<li>先 mousedown， 再mouseup， 最后click</li>
<li>鼠标移入: mouseover  mouseenter(es5新出的)<br>鼠标移出: mouseout   mouseleave(es5新出的)</li>
</ol>
</blockquote>
<div class="post-warning">移动端，mousedown和mouseup就不好用了，而是用touchstart、touchmove、touchend</div>

</li>
</ul>
<p><br></p>
<ul>
<li><p><strong>键盘事件</strong></p>
<blockquote>
<p>keydown   keypress   keyup </p>
<ol>
<li>先 keydown， 再keypress， 最后keyup</li>
<li>keydown和keypress的区别：keydown可以响应任意键盘按键，keypress只可以响应字符类键盘按键。</li>
</ol>
</blockquote>
<div class="post-warning">1. keydown可以监听处理Fn辅助键之外的所有键（which：监测108个键子），keypress只能监听字符按键。<br>2. 但是keydown记录不了字符类按键，不准。<br>   如果想监听字符类按键并区分大小写，用keypress，<br>   如果监听操作类按键，只用keydown。<br>3. 二者各有优缺。keypress能识别键盘上的每一个键子，但是返回的数字我们不知道对应的哪个键子，得测。而且它只能测每个键子，如：shift+a-&gt;A,他就测不准，出现的是shift和A，这样说来，keypress更准确，keydown更广泛。<br></div>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">document.onkeypress = function (e) &#123;</span><br><span class="line">  console.log(e.key, String.fromCharCode(e.charCode));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<ul>
<li><p><strong>文本操作事件</strong><br>input、 focus、 blur、 change</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;input <span class="built_in">type</span>=<span class="string">"text"</span> id=<span class="string">'inp'</span> /&gt;</span><br><span class="line"></span><br><span class="line">const oInp = document.getElementById(<span class="string">'inp'</span>);</span><br><span class="line">oInp.oninput = <span class="keyword">function</span> (e) &#123;</span><br><span class="line">  console.log(e.data, e.target.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>窗体操作事件</strong><br>scroll load</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">window.onscroll = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">  console.log(window.pageXOffset + <span class="string">" "</span> +window.pageYOffset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.onload = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">  var oDiv = document.getElementsByTagName(<span class="string">'div'</span>)[0];</span><br><span class="line">  oDiv.style.width = <span class="string">'100px'</span>;</span><br><span class="line">  oDiv.style.height = <span class="string">'100px'</span>;</span><br><span class="line">  oDiv.style.backgroundColor = <span class="string">'orange'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样完全好使，但是为什么我们都不这样使用。因为无意义，速度慢。整个文档解析后，renderTree构建完成后，DOM所有文档图片信息下载完成后，整个页面完成后才能出发window.onload事件。</p>
<p>当然也有用处，用load我们知道什么时候页面加载完成，我们可以把“广告”之类的功能放在load中，页面加载完再显示广告，但绝不能把主程序放在load里。</p>
<p>js有DOMTree + css有CSSTree -&gt; 渲染树 renderTree<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
</li>
</ul>
<h1 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a><font color="#FF69B4">BOM</font></h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><ol>
<li>定义：Browser Object Model（浏览器对象模型）</li>
<li>BOM对象：window、history、Nacigator、screen、location等</li>
</ol>
<div class="post-warning">注：由于浏览器厂商不同，BOM对象的兼容性极低，故我们一般只用其中的部分功能。</div>

<h2 id="二、BOM对象"><a href="#二、BOM对象" class="headerlink" title="二、BOM对象"></a>二、BOM对象</h2><h3 id="1-window对象"><a href="#1-window对象" class="headerlink" title="1. window对象"></a><font color="#1B90D6">1. window对象</font></h3><blockquote>
<p>window对象代表浏览器中打开的窗口。 如果文档中包含框架（frame或iframe标签），浏览器会为每个框架创建一个额外的window对象。<br>注：没有应用于window对象的公开标准，不过所有浏览器都支持该对象。</p>
</blockquote>
<blockquote>
<p>window对象集合：frames[]<br>返回窗口中所有命名的框架，该集合是window对象的数组，每个window对象若窗口中含有一个框架或iframe或属性frames。length存放数组frames[]中含有的元素个数。<br>注：frames[]数组中引用的框架可能还包含框架，它们自己也具有frames[]数组</p>
</blockquote>
<h4 id="window对象的属性"><a href="#window对象的属性" class="headerlink" title="window对象的属性"></a>window对象的属性</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">closed          返回窗口是否已被关闭</span><br><span class="line">defaultStatus   设置或返回窗口状态栏中的默认文本</span><br><span class="line">document        对Document对象的只读引用，请参阅Document对象</span><br><span class="line"><span class="built_in">history</span>         对History对象的只读引用，请参阅History对象</span><br><span class="line">location        用于窗口或框架的Location对象，请参阅Location对象</span><br><span class="line">Navigator       对Navigator对象的只读引用，请参阅Navigator对象</span><br><span class="line">Screen          对Screen对象的只读引用，请参阅Screen对象</span><br><span class="line">innerheight     返回窗口文档显示区的高度</span><br><span class="line">innerwidth      返回窗口文档显示区的宽度</span><br><span class="line">length          设置或返回窗口中的框架数量</span><br><span class="line">name            设置或返回窗口的名称</span><br><span class="line">opener          返回对创建此窗口的窗口引用</span><br><span class="line">outerheight     返回窗口的外部高度（IE不支持）</span><br><span class="line">outerwidth      返回窗口的外部宽度（IE不支持）</span><br><span class="line">pageXOffset     设置或返回当前页面相对于窗口显示区左上角的x位置</span><br><span class="line">pageYOffset     设置或返回当前页面相对于窗口显示区左上角的y位置</span><br><span class="line">parent          返回父窗口</span><br><span class="line">window          window属性等价于self属性，它包含了对窗口自身的引用</span><br><span class="line">self            返回当前窗口的引用，等价于window属性</span><br><span class="line">status          设置窗口状态栏的文本</span><br><span class="line">top             返回最顶层的先辈窗口</span><br><span class="line">screenLeft      只读整数，声明了窗口的左上角在屏幕上的x坐标和y坐标</span><br><span class="line">screenTop       IE、Safari和Opera支持screenLeft和screenTop</span><br><span class="line">screenX         只读整数，声明了窗口的左上角在屏幕上的x坐标和y坐标</span><br><span class="line">screenY         FireFox和Safari支持screenX和screenY</span><br></pre></td></tr></table></figure>
<h4 id="window对象的方法"><a href="#window对象的方法" class="headerlink" title="window对象的方法"></a>window对象的方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">alert()          显示带有一段消息和一个确认按钮的警告框</span><br><span class="line">confirm()        显示带有一段消息以及确认按钮和去取消按钮的对话框</span><br><span class="line">createPopup()    创建一个pop-up窗口</span><br><span class="line"><span class="built_in">print</span>()          打印当前窗口的内容</span><br><span class="line">prompt()         显示可提示用户输入的对话框</span><br><span class="line">blur()           可把键盘焦点从顶层浏览器窗口移走</span><br><span class="line">focus()          把键盘焦点给予一个窗口</span><br><span class="line">setInterval()    按照指定的周期（以毫秒计算）来调用函数或计算表达式</span><br><span class="line">setTimeout()     在指定的好描述后调用函数或计算表达式</span><br><span class="line">clearInterval()  取消由setInterval()设置的interval</span><br><span class="line">clearTimeout()   取消由setTimeout()设置的timeout</span><br><span class="line">open()           打开一个新浏览器窗口</span><br><span class="line">close()          关闭浏览器窗口</span><br><span class="line">scrollBy()       按照指定的像素值来滚动内容</span><br><span class="line">scrollTo()       把内容滚动到指定的坐标</span><br><span class="line">moveBy()         可相对窗口的当前坐标吧它移动到一个指定的像素</span><br><span class="line">moveTo()         把窗口的左上角移动到指定位置</span><br><span class="line">resizeBy()       按照指定的像素调整窗口的大小</span><br><span class="line">resizeTo()       把窗口的大小调整到指定的宽度和高度</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="2-Navigator对象"><a href="#2-Navigator对象" class="headerlink" title="2. Navigator对象"></a><font color="#1B90D6">2. Navigator对象</font></h3><blockquote>
<p>Navigator对象包含有关浏览器的信息。<br>没有应用于Navigator对象的公开标准，不过所有浏览器都支持此对象。</p>
</blockquote>
<h4 id="Navigator对象集合：plugins"><a href="#Navigator对象集合：plugins" class="headerlink" title="Navigator对象集合：plugins[]"></a>Navigator对象集合：plugins[]</h4><p>返回对文档中所有嵌入式对象的引用，该集合是一个Plugin对象的数组。其中的元素代表浏览器已经安装的插件，Plugin对象提供的是有关插件的信息。其中包括它所支持的MIME类型的列表。虽然plugins数组是由IE4定义的，但是在IE4中它却总是空的，因为IE4不支持插件和Plugin对象。</p>
<h4 id="Navigator对象属性"><a href="#Navigator对象属性" class="headerlink" title="Navigator对象属性"></a>Navigator对象属性</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">appCodeName       返回浏览器的代码名</span><br><span class="line">appMinorVersion   返回浏览器的次级版本</span><br><span class="line">appName           返回浏览器名称</span><br><span class="line">appVersion        返回浏览器的平台和版本信息</span><br><span class="line">browserLanguage   返回当前浏览器的语言</span><br><span class="line">cookieEnabled     返回指明浏览器中是否启用cookie的布尔值</span><br><span class="line">cpuClass          返回浏览器系统的CPU等级</span><br><span class="line">onLine            返回指明系统是否处于脱机模式的布尔值</span><br><span class="line">platform          返回运行浏览器的操作系统平台</span><br><span class="line">systemLanguage    返回OS使用的默认语言</span><br><span class="line">userLanguage      返回由客户机发送服务器的user-agent头部的值</span><br></pre></td></tr></table></figure>
<h4 id="Navigator对象方法"><a href="#Navigator对象方法" class="headerlink" title="Navigator对象方法"></a>Navigator对象方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javaEnabled()     规定浏览器是否启用java</span><br><span class="line">taintEnabled()    规定浏览器是否启用数据污点(data tainting)</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="3-Screen对象"><a href="#3-Screen对象" class="headerlink" title="3.Screen对象"></a><font color="#1B90D6">3.Screen对象</font></h3><blockquote>
<p>Screen对象包含有关客户端显示屏幕的信息。<br><br></p>
</blockquote>
<h3 id="4-History对象"><a href="#4-History对象" class="headerlink" title="4. History对象"></a><font color="#1B90D6">4. History对象</font></h3><blockquote>
<p>History对象包含用户（在浏览器窗口中）访问过的URL，是window对象的一部分。可通过window.history属性进行访问。<br>注：没有应用于History对象的公开标准，不过所有浏览器都支持它。</p>
</blockquote>
<h4 id="History对象属性"><a href="#History对象属性" class="headerlink" title="History对象属性"></a>History对象属性</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">length 返回浏览器历史列表中的数量</span><br></pre></td></tr></table></figure>
<h4 id="History对象方法"><a href="#History对象方法" class="headerlink" title="History对象方法"></a>History对象方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">back()     加载<span class="built_in">history</span>列表中的前一个URL</span><br><span class="line">forward()  加载<span class="built_in">history</span>列表中的下一个URL</span><br><span class="line">go()       加载<span class="built_in">history</span>列表中的某个具体页面</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="5-Location对象"><a href="#5-Location对象" class="headerlink" title="5. Location对象"></a><font color="#1B90D6">5. Location对象</font></h3><blockquote>
<p>Location对象包含有关当前URL的信息，是window对象的一部分，可通过window.location属性来访问</p>
</blockquote>
<h4 id="Location对象属性"><a href="#Location对象属性" class="headerlink" title="Location对象属性"></a>Location对象属性</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">hash</span>       设置或返回从<span class="comment">#号（#）开始的URL（锚）</span></span><br><span class="line">host       设置或返回主机名和当前URL的端口号</span><br><span class="line">hostname   设置或返回当前URL的主机名</span><br><span class="line">href       设置或返回完整的URL</span><br><span class="line">pathname   设置或返回当前URL的路径部分</span><br><span class="line">port       设置或返回当前URL的端口号</span><br><span class="line">protocol   设置或返回当前URL的协议</span><br><span class="line">search     设置或返回从问号（?）开始的URL（查询部分）</span><br></pre></td></tr></table></figure>
<h4 id="Location对象方法"><a href="#Location对象方法" class="headerlink" title="Location对象方法"></a>Location对象方法</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">assign()    加载新的文档</span><br><span class="line">reload()    重新加载当前文档</span><br><span class="line">replace()   用新的文档替换当前文档</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="零散知识点"><a href="#零散知识点" class="headerlink" title="零散知识点"></a><font color="#0472B4" size="5">零散知识点</font></h1><h2 id="1-正则表达式-RegExp（Regular-Expression）"><a href="#1-正则表达式-RegExp（Regular-Expression）" class="headerlink" title="1.正则表达式 RegExp（Regular Expression）"></a><font color="#1B90D6">1.正则表达式 RegExp（Regular Expression）</font></h2><blockquote>
<p>正则表达式是匹配特殊字符或有特殊搭配原则的字符的最佳选择。<br>RegExp对象标识正则表达式，是对字符转执行 <strong>模式匹配</strong> 的强大工具。</p>
</blockquote>
<h3 id="一、创建方式"><a href="#一、创建方式" class="headerlink" title="一、创建方式"></a>一、创建方式</h3><ol>
<li>直接量<br>如：var reg = /^\d | \d$/igm;</li>
<li><p>new RegExp();<br>如：var reg = new RegExp(‘/^\d | \d$/‘);</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">注：① js字符串不许出现回车符号，但是“\\”代表转义字符。</span><br><span class="line">      如：var a = <span class="string">"aaa\</span></span><br><span class="line"><span class="string">                  bbb"</span>;</span><br><span class="line">      这样就不会报错了。</span><br><span class="line">     ②“\”代表转义字符，“\\”代表\。“\\n”代表换行</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="二、基础语法"><a href="#二、基础语法" class="headerlink" title="二、基础语法"></a>二、基础语法</h3><h4 id="1-compile-编译正则表达式"><a href="#1-compile-编译正则表达式" class="headerlink" title="1. compile  编译正则表达式"></a>1. compile  编译正则表达式</h4>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec     检索字符串中指定的值，返回找到的值，并确定其位置</span><br><span class="line">test     检索字符串中指定的值，返回true或false， 例：reg.test(str)</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">i        代表不区分大小写（执行对大小写不敏感的匹配） 例：/[abc]/i</span><br><span class="line">g        代表全局匹配(查找所有匹配，而非找到第一个匹配后停止)</span><br><span class="line">m        多行匹配</span><br></pre></td></tr></table></figure>
<h4 id="2-支持正则表达式的String对象的方法"><a href="#2-支持正则表达式的String对象的方法" class="headerlink" title="2. 支持正则表达式的String对象的方法"></a>2. 支持正则表达式的String对象的方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">search    检索与正则表达式相匹配的值</span><br><span class="line">match     找到一个或多个正则表达式的匹配 &lt;font color=&quot;red&quot;&gt;例：str.match(reg)&lt;/font&gt;</span><br><span class="line">replace   替换与正则表达式匹配的子串</span><br><span class="line">split     把字符串分割为字符串数组</span><br></pre></td></tr></table></figure>
<h4 id="3-查找某法范围内的字符"><a href="#3-查找某法范围内的字符" class="headerlink" title="3.  [] 查找某法范围内的字符"></a>3.  <strong>[]</strong> 查找某法范围内的字符</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[abc]     查找方括号之间的任何字符</span><br><span class="line">[^abc]    查找任何不在方括号之间的字符</span><br><span class="line">[0-9]     查找任何从0到9之间的数字</span><br><span class="line">[a-z]     查找任何从小写a到小写z之间的字符</span><br><span class="line">[A-Z]     查找任何从大写A到大写Z之间的字符</span><br><span class="line">[A-z]     查找任何从大写A到小写z之间的字符</span><br><span class="line">[adj]     查找给定集合内的任何字符</span><br><span class="line">[^dss]    查找给定集合外的任何字符</span><br><span class="line">(red|green|blue) 查找任何指定的选项</span><br></pre></td></tr></table></figure>
<h4 id="4-元字符-（Metacharacter）是有特殊含义的字符，简化操作。"><a href="#4-元字符-（Metacharacter）是有特殊含义的字符，简化操作。" class="headerlink" title="4. 元字符 （Metacharacter）是有特殊含义的字符，简化操作。"></a>4. <strong>元字符</strong> （Metacharacter）是有特殊含义的字符，简化操作。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.         查找单个字符，除了换行和行结束符</span><br><span class="line">\w        查找单词字符</span><br><span class="line">\W        查找非单词字符</span><br><span class="line">\d        查找数字字符</span><br><span class="line">\D        查找非数字字符</span><br><span class="line">\s        查找空白字符</span><br><span class="line">\S        查号非空白字符</span><br><span class="line">\b        查找单词边界</span><br><span class="line">\B        查找非单词边界</span><br><span class="line">\O        查找NUL字符</span><br><span class="line">\n        查找换行符</span><br><span class="line">\f        查找换页符</span><br><span class="line">\r        查找回车符</span><br><span class="line">\t        查找制表符</span><br><span class="line">\v        查找垂直制表符</span><br><span class="line">\xxx      查找以八进制数xxx规定的字符</span><br><span class="line">\xdd      查找以十六进制数dd规定的字符</span><br><span class="line">\uxxx     查找以十六极致xxxx规定的Unicode字符</span><br></pre></td></tr></table></figure>
<h4 id="5-正则匹配原则（贪心匹配原则）-量词"><a href="#5-正则匹配原则（贪心匹配原则）-量词" class="headerlink" title="5. 正则匹配原则（贪心匹配原则） 量词"></a>5. 正则匹配原则（贪心匹配原则） <strong>量词</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n+         匹配任何包含至少一个n的字符串</span><br><span class="line">n*         匹配任何包含零个或多个n的字符串</span><br><span class="line">n?         匹配任何包含零个或一个n的字符串</span><br><span class="line">n&#123;x&#125;       匹配包含x个n的序列的字符串</span><br><span class="line">n&#123;x,y&#125;     匹配包含x至y个n的序列的字符串</span><br><span class="line">n&#123;x,&#125;      匹配包含至少x个n的字符串</span><br><span class="line">n$         匹配任何结尾为n的字符串</span><br><span class="line">^n         匹配任何开头为n的字符串</span><br><span class="line">?=n        匹配任何其后紧接指定字符串n的字符串</span><br><span class="line">?!n        匹配任何其后紧接非指定字符串n的字符串</span><br></pre></td></tr></table></figure>
<h4 id="6-RegExp对象属性"><a href="#6-RegExp对象属性" class="headerlink" title="6. RegExp对象属性"></a>6. RegExp对象属性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ignoreCase  RegExp对象是否具有标志i</span><br><span class="line">global      RegExp对象是否具有标志g</span><br><span class="line">multiline   RegExp对象是否具有标志m</span><br><span class="line">lastIndex   一个整数，表示开始下一次匹配的字符位置</span><br><span class="line">source      正则表达式的原文本</span><br></pre></td></tr></table></figure>
<h3 id="三、进阶"><a href="#三、进阶" class="headerlink" title="三、进阶"></a>三、进阶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. \2、\1 反向子表达式引用</span><br><span class="line">2. 正向预查功能 ?= </span><br><span class="line">   (?: )不记录该子表达式的内容</span><br></pre></td></tr></table></figure>
<h2 id="2-json"><a href="#2-json" class="headerlink" title="2.json"></a><font color="#1B90D6">2.json</font></h2><p>json是一种传输数据的格式（以对象为模板，本质上就是对象，但用途有区别。对象就是本地使用的数据类型，json是用来传输数据的数据类型）</p>
<div class="border1"><font color="red">JSON.parse();</font> string -&gt; json<br><font color="red">JSON.stringify();</font> json -&gt; string</div>

<h2 id="3-异步加载js"><a href="#3-异步加载js" class="headerlink" title="3.异步加载js"></a><font color="#1B90D6">3.异步加载js</font></h2><h3 id="一、js同步加载"><a href="#一、js同步加载" class="headerlink" title="一、js同步加载"></a>一、js同步加载</h3><ol>
<li>js加载的缺点：加载工具方法没必要阻塞文档，使得js加载会影响页面效率，一旦网速不好，那么整个网站将等待js加载而不进行后续渲染等工作。</li>
<li>js加载不能满足的需求：有些工具方法需要按需加载，用到时再加载，不用时不加载。</li>
<li>页面解析：加载一行，解析一行，遇到&lt; link &gt;标签，开启一个新线程，异步加载css。</li>
</ol>
<h3 id="二、js异步加载"><a href="#二、js异步加载" class="headerlink" title="二、js异步加载"></a>二、js异步加载</h3><ol>
<li><p>javascript异步加载的三种方案：<br> 1） defer异步加载，但要等到dom文档全部解析完才会被执行（只有IE能用。执行时不阻塞页面）</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">".../xxx.js"</span> defer/async&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p> 2） async异步加载，加载完就执行<br> （async只能加载外部脚本，不能将js写在script标签里，w3c标准。执行时不阻塞页面）<br> 3） 创建script，插入到DOM中，onload，兼容，加载完毕后callBack。( 按需加载 ）</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var cb = &#123;</span><br><span class="line">        <span class="built_in">test</span>:<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">            console.log(<span class="string">"回调函数"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> loadScript(url,callback)&#123;</span><br><span class="line">        var oScript = docuemnt.createElement(<span class="string">'script'</span>);</span><br><span class="line">        oScript.src=url;</span><br><span class="line">        <span class="keyword">if</span>(oScript.readyState)&#123;</span><br><span class="line">            oScript.onreadystatechange = <span class="function"><span class="title">function</span></span>()&#123;//IE</span><br><span class="line">                <span class="keyword">if</span>(oScript.readyState == <span class="string">'complete'</span> || oScript.readyState == <span class="string">'loaded'</span>)&#123;</span><br><span class="line">                    oScript.onreadystatechange = null;</span><br><span class="line">                    cb[callback]();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            oScript.onload = <span class="function"><span class="title">function</span></span>()&#123;//非IE</span><br><span class="line">                oScript.onload = null;</span><br><span class="line">                cb[callback]();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        document.body.appendChild(oScript);</span><br><span class="line">    &#125;</span><br><span class="line">    loadScript(<span class="string">"xxx.js"</span>,<span class="string">"test"</span>);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="4-js加载时间线"><a href="#4-js加载时间线" class="headerlink" title="4.js加载时间线"></a><font color="#1B90D6">4.js加载时间线</font></h2><ol>
<li>创建Document对象，开始解析页面。解析HTML元素和他们的文本内容后，添加Element对象和Text节点到文档中，这个阶段document.readyState = ‘loading’。</li>
<li>遇到link外部css，创建线程加载，并继续解析文档。</li>
<li>遇到script外部js并且没有设置defer或async，浏览器加载并阻塞，等待js加载完成并执行该脚本后，继续解析文档。</li>
<li>遇到script外部js并且有设置defer或async，浏览器创建线程加载，并继续解析文档。对于async属性，脚本加载完成后立即执行（异步禁止使用document.write）</li>
<li>遇到img等，先正常解析dom结构，然后浏览器开始加载src，并继续解析文档。</li>
<li>当文档解析完成，document.readyState=’interactive’（document.onreadystatechange）</li>
<li>文档解析完成后，所有设置有defer的脚本会按照顺序执行（注：与async不同，但同样禁止document.write）</li>
<li>document对象触发DOMContentloaded事件，这也标志着程序执行从同步脚本执行阶段，转换为事件驱动阶段（document.addEventListener）</li>
<li>当所有async的脚本加载完成并执行后、img等加载完成后，docuemnt.readyState = ‘complete’，window对象触发load事件。</li>
<li>从此，以异步响应方式处理用户输入，网络事件等。<br><font color="red">docuemnt.write()能清除文档流，故异步加载禁止使用document.write()</font><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    console.log(<span class="string">"1.开始解析页面，document.readyState的值为"</span>,document.readyState,<span class="string">", 2 3 4 5 解析html,css,js,img等"</span>);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    document.addEventListener(<span class="string">'DOMContentLoaded'</span>,<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        console.log(<span class="string">"8. document对象触发DOMContentloaded事件，这也标志着程序执行从同步脚本执行阶段，转换为事件驱动阶段（document.addEventListener）"</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    document.onreadystatechange = <span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        <span class="keyword">if</span>(document.readyState == <span class="string">"interactive"</span>)&#123;</span><br><span class="line">            console.log(<span class="string">"6.当页面解析完成后，onreadystatechange事件中document.readyState变为"</span>,document.readyState,<span class="string">"，7.defer执行"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(document.readyState == <span class="string">"complete"</span>)&#123;</span><br><span class="line">            console.log(<span class="string">"9.onreadystatechange事件中document.readyState变为"</span>,document.readyState);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    document.addEventListener(<span class="string">'DOMContentLoaded'</span>,<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        console.log(<span class="string">"8. document对象触发DOMContentloaded事件，这也标志着程序执行从同步脚本执行阶段，转换为事件驱动阶段（document.addEventListener）"</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    window.onload = <span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">        console.log(<span class="string">"9.window对象触发load事件"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(<span class="string">"1.开始解析页面，document.readyState的值为"</span>,document.readyState,<span class="string">", 2 3 4 5 解析html,css,js,img等"</span>);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><div></div></p>
<script>
    console.log("1.开始解析页面，document.readyState的值为",document.readyState,", 2 3 4 5 解析html,css,js,img等");
</script>
<script>
    document.addEventListener('DOMContentLoaded',function(){
        console.log("8. document对象触发DOMContentloaded事件，这也标志着程序执行从同步脚本执行阶段，转换为事件驱动阶段（document.addEventListener）");
    })
    document.onreadystatechange = function(){
        if(document.readyState == "interactive"){
            console.log("6.当页面解析完成后，onreadystatechange事件中document.readyState变为",document.readyState,"，7.defer执行");
        }else if(document.readyState == "complete"){
            console.log("9.onreadystatechange事件中document.readyState变为",document.readyState);
        }
    }
    document.addEventListener('DOMContentLoaded',function(){
        console.log("8. document对象触发DOMContentloaded事件，这也标志着程序执行从同步脚本执行阶段，转换为事件驱动阶段（document.addEventListener）");
    })
    window.onload = function(){
        console.log("9.window对象触发load事件");
    }
    console.log("1.开始解析页面，document.readyState的值为",document.readyState,", 2 3 4 5 解析html,css,js,img等");
</script>

<p><div class="border1">URL：<a href="https://www.baidu.com/s?ie-utf-88&amp;f=3&amp;rsv_bp=1" target="_blank" rel="noopener">https://www.baidu.com/s?ie-utf-88&amp;f=3&amp;rsv_bp=1</a></div></p>
<font color="red">资源定位符：</font>协议名(https)  主机名(域名 <a href="http://www.baidu.com&nbsp;&nbsp;路径(/s)&nbsp;&nbsp;参数名=参数值(ie-utf-88)" target="_blank" rel="noopener">www.baidu.com&nbsp;&nbsp;路径(/s)&nbsp;&nbsp;参数名=参数值(ie-utf-88)</a><br><br><font color="blue">DNS -&gt; IP -&gt; 服务端 -&gt; 客户端</font>





<h2 id="5-DOCTYPE"><a href="#5-DOCTYPE" class="headerlink" title="5.DOCTYPE"></a>5.DOCTYPE</h2><ol>
<li>渲染模式：标准模式、混杂模式（怪异模式）</li>
<li>三种标准模式的写法：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">"-//W3C//DTD HTML 4.01//EN"</span> <span class="string">"http://www.w3.org/TR/html4/strict.dtd"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD XHTML 1.0 Strict//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="6-for属性-gt-js中表示htmlFor"><a href="#6-for属性-gt-js中表示htmlFor" class="headerlink" title="6.for属性 -&gt; js中表示htmlFor"></a>6.<label>for属性 -&gt; js中表示htmlFor</label></h2><p>属性映射HTML属性，映射到Element属性<br>img图片预加载<br>byClassName自己定义的写法<br>Math.random</p>
<h2 id="7-文档碎片"><a href="#7-文档碎片" class="headerlink" title="7.文档碎片"></a>7.文档碎片</h2><p>CDN<br>typeof(new Array).<strong>proto</strong>.constructor();<br>forEach里不能用break</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/07/hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2021/01/07/hexo/" itemprop="url">hexo搭建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-01-07T14:29:00+08:00">
                2021-01-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/专题/" itemprop="url" rel="index">
                    <span itemprop="name">专题</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、hexo初始搭建"><a href="#一、hexo初始搭建" class="headerlink" title="一、hexo初始搭建"></a>一、hexo初始搭建</h1><p>参照<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">hexo官网</a>的搭建方式。<br>1）hexo<br>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p>
<p>2）搭建<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br><span class="line">npm install hexo</span><br><span class="line"></span><br><span class="line">将 Hexo 所在的目录下的 node_modules 添加到环境变量之中即可直接使用 hexo &lt;command&gt;：</span><br><span class="line">echo &apos;PATH=&quot;$PATH:./node_modules/.bin&quot;&apos; &gt;&gt; ~/.profile</span><br><span class="line"></span><br><span class="line">hexo init &lt;folder&gt;</span><br><span class="line">cd &lt;folder&gt;</span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line">hexo s // 启动 server</span><br><span class="line">hexo g // 生成 generate</span><br><span class="line">hexo d // 部署 deploy</span><br></pre></td></tr></table></figure></p>
<p>3）更改主题</p>
<ul>
<li><p>clone 或 zip下载并放至themes目录下<br>git clone <a href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">https://github.com/iissnan/hexo-theme-next</a> themes/next<br><a href="https://github.com/iissnan/hexo-theme-next/releases" target="_blank" rel="noopener">next主题下载</a></p>
</li>
<li><p>启用主题<br>当 克隆/下载 完成后，打开 站点配置文件， 找到 theme 字段，并将其值更改为 next。</p>
</li>
<li><p>验证主题<br>到此，NexT 主题安装完成。下一步我们将验证主题是否正确启用。在切换主题之后、验证之前， 我们最好使用 hexo clean 来清除 Hexo 的缓存。</p>
</li>
<li><p>依据喜好添加自己的其他主题配置和样式</p>
</li>
</ul>
<p>1）换肤</p>
<ul>
<li>头像：主题配置文件avatar(themes/next/_config.yml)</li>
<li>背景：custom.styl(themes/next/source/css/_custom/custom.styl)</li>
<li>颜色：site-meta、content-wrap</li>
</ul>
<p>2）更改hexo启动默认端口号</p>
<ul>
<li>临时：hexo s -p 4000</li>
<li>永久：ode_modules\hexo-server\index.js</li>
</ul>
<h1 id="三、自定义文章基本常用的样式"><a href="#三、自定义文章基本常用的样式" class="headerlink" title="三、自定义文章基本常用的样式"></a>三、自定义文章基本常用的样式</h1><p>  <a href="https://fontawesome.dashgame.com/" target="_blank" rel="noopener">fontawesome</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/19/redux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/19/redux/" itemprop="url">redux</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-19T15:49:41+08:00">
                2020-05-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/框架/" itemprop="url" rel="index">
                    <span itemprop="name">框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、介绍"><a href="#一、介绍" class="headerlink" title="一、介绍"></a><font color="#8A2BE2">一、介绍</font></h1><p><strong>Redux 是 JavaScript 状态容器，提供可预测化的状态管理。</strong><br>Redux 除了和 React 一起用外，还支持其它界面库。 它体小精悍（只有2kB，包括依赖）。</p>
<blockquote>
<p>应用中所有的 state 都以一个对象树的形式储存在一个单一的 store 中。 惟一改变 state 的是dispatch方法派发 action（一个描述发生什么的对象）。 reducers描述 action 如何改变 state 树。通过provider顶层组件把store同步到所有组件。</p>
</blockquote>
<p>安装：<br>npm install –save redux</p>
<p>附加包：<br>npm install –save react-redux<br>npm install –save-dev redux-devtools</p>
<p>使用ts还需：<br>npm install @types/react-redux</p>
<h2 id="1、动机"><a href="#1、动机" class="headerlink" title="1、动机"></a><font color="#BA55D3">1、动机</font></h2><p>随着js单页应用的日趋复杂，js要管理越来越多的状态，难管理难预测。</p>
<h2 id="2、三大原则"><a href="#2、三大原则" class="headerlink" title="2、三大原则"></a><font color="#BA55D3">2、三大原则</font></h2><ol>
<li>单一数据源<br>整个应用的 state 被储存在一棵 object tree 中，并且这个 object tree 只存在于唯一一个 store 中。</li>
<li>State 是只读的<br>唯一改变 state 的方法就是触发 action，action 是一个用于描述已发生事件的普通对象。</li>
<li><p>使用纯函数来执行修改<br>为了描述 action 如何改变 state tree ，你需要编写 reducers。</p>
<ul>
<li>纯函数：函数的返回结果只依赖于它的参数，并且在执行过程中不产生副作用。</li>
</ul>
</li>
</ol>
<h2 id="3、先前技术"><a href="#3、先前技术" class="headerlink" title="3、先前技术"></a><font color="#BA55D3">3、先前技术</font></h2><h3 id="Flux"><a href="#Flux" class="headerlink" title="Flux"></a>Flux</h3><p>更新逻辑全部集中于一个特定的层（Flux 里的 store，Redux 里的 reducer）。<br>都不允许程序直接修改数据，而是用一个叫作 “action” 的普通对象来对更改进行描述。</p>
<p>不同于 Flux ，Redux 并没有 dispatcher 的概念。原因是它依赖纯函数来替代事件处理器。纯函数构建简单，也不需额外的实体来管理它们。<br>和 Flux 的另一个重要区别，是 Redux 设想你永远不会变动你的数据。</p>
<h3 id="Immutable"><a href="#Immutable" class="headerlink" title="Immutable"></a>Immutable</h3><p>Immutable 是一个可实现持久数据结构的 JavaScript 库。它性能很好，并且命名符合 JavaScript API 的语言习惯 。</p>
<p>Immutable 及类似的库都可以与 Redux 对接良好。尽可随意捆绑使用！</p>
<p>Redux 并不在意你如何存储 state，state 可以是普通对象，不可变对象，或者其它类型。 为了从 server 端写同构应用或融合它们的 state ，你可能要用到序列化或反序列化的机制。但除此以外，你可以使用任何数据存储的库，只要它支持数据的不可变动性。</p>
<h2 id="4、生态系统"><a href="#4、生态系统" class="headerlink" title="4、生态系统"></a><font color="#BA55D3">4、生态系统</font></h2><p><a href="https://www.redux.org.cn/docs/introduction/Ecosystem.html" target="_blank" rel="noopener">生态系统</a></p>
<ol>
<li>与不同框架绑定</li>
<li>Reducers<blockquote>
<p>组合 Reducer<br>Reducer 结构<br>高阶 Reducers</p>
</blockquote>
</li>
<li>Actions</li>
<li>工具集<blockquote>
<p>reduxjs、reselect等</p>
</blockquote>
</li>
<li>Store<blockquote>
<p>更改订阅 / 批处理 / 持久化</p>
</blockquote>
</li>
<li>不可变（Immutable）数据<blockquote>
<p>数据结构:facebook/immutable-js 、 rtfeldman/seamless-immutable 、 planttheidea/crio 、 aearly/icepick<br>不可变更新（Immutable Update）实用程序<br>Immutable/Redux 互操作: gajus/redux-immutable、 eadmundo/redux-seamless-immutable</p>
</blockquote>
</li>
<li>副作用（Side Effects）<blockquote>
<p>广泛使用: gaearon/redux-thunk 、  redux-saga/redux-saga 、 redux-observable/redux-observable 、 redux-loop/redux-loop 、<br>Promises: acdlite/redux-promise 、 lelandrichardson/redux-pack</p>
</blockquote>
</li>
<li>中间件<blockquote>
<p>Networks and Sockets: svrcekmichal/redux-axios-middleware<br>异步行为:  wyze/redux-debounce 符合 FSA 标准的 Redux 中间件可以实现 action 的防抖。<br>分析<br>实体和集合</p>
</blockquote>
</li>
<li>组件 state 和封装</li>
<li>开发者工具<blockquote>
<p>Debuggers and Viewers: reduxjs/redux-devtools 、 zalmoxisus/redux-devtools-extension 、 infinitered/reactotron<br>开发者工具监视器<br>日志<br>突变检测</p>
</blockquote>
</li>
<li>测试</li>
<li>路由</li>
<li>Forms<blockquote>
<p>ReactTraining/react-router-redux: 保持 state 与路由同步<br>等等</p>
</blockquote>
</li>
<li>更高级别的抽象<blockquote>
<p>社区公约</p>
</blockquote>
</li>
</ol>
<p><br><br><br><br><br><br><br></p>
<h1 id="二、基础"><a href="#二、基础" class="headerlink" title="二、基础"></a><font color="#8A2BE2">二、基础</font></h1>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">视图   ---&gt;     Action构建函数    ---&gt;    Action对象    ---&gt;    Store.dispatch   </span><br><span class="line">  |                                                                 |</span><br><span class="line">  |                                                                 |</span><br><span class="line">刷新视图     &lt;---    Store       &lt;---      新的状态     &lt;---    reducer函数</span><br></pre></td></tr></table></figure>
<h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a><font color="#BA55D3">Action</font></h2><p><strong>Action 创建函数</strong> 是生成 <strong>action</strong> 的方法。</p>
<p>actions 描述了有某件事情发生了这一事实，并没有描述应用如何更新 state。</p>
<h2 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a><font color="#BA55D3">Reducer</font></h2><p>Reducers 指定了应用状态的变化如何响应 actions 并发送到 store 的。</p>
<ul>
<li><p>纯函数<br>只要传入参数相同，返回计算得到的下一个 state 就一定相同。没有特殊情况、没有副作用，没有 API 请求、没有变量修改，单纯执行计算。</p>
</li>
<li><p>combineReducers()工具类</p>
</li>
</ul>
<h2 id="Store"><a href="#Store" class="headerlink" title="Store"></a><font color="#BA55D3">Store</font></h2><p><strong>Redux 应用只有一个单一的 store。</strong></p>
<blockquote>
<p>action 描述“发生了什么”，和使用 reducers 来根据 action 更新 state 的用法。</p>
<p>Store 就是把它们联系到一起的对象。Store 有以下职责：<br>维持应用的 state；<br>提供 getState() 方法获取 state；<br>提供 dispatch(action) 方法更新 state；<br>通过 subscribe(listener) 注册监听器;<br>通过 subscribe(listener) 返回的函数注销监听器。</p>
</blockquote>
<h2 id="数据流"><a href="#数据流" class="headerlink" title="数据流"></a><font color="#BA55D3">数据流</font></h2><ul>
<li>严格的单向数据流是 Redux 架构的设计核心。</li>
</ul>
<p>这意味着应用中所有的数据都遵循相同的生命周期，这样可以让应用变得更加可预测且容易理解。同时也鼓励做数据范式化，这样可以避免使用多个且独立的无法相互引用的重复数据。</p>
<p>Redux 应用中数据的生命周期遵循下面 4 个步骤：</p>
<ol>
<li>调用 store.dispatch(action)。</li>
<li>Redux store 调用传入的 reducer 函数。</li>
<li>根 reducer 应该把多个子 reducer 输出合并成一个单一的 state 树。</li>
<li>Redux store 保存了根 reducer 返回的完整 state 树。</li>
</ol>
<h2 id="搭配react"><a href="#搭配react" class="headerlink" title="搭配react"></a><font color="#BA55D3">搭配react</font></h2><h3 id="容器组件（Smart-Container-Components）和展示组件（Dumb-Presentational-Components）"><a href="#容器组件（Smart-Container-Components）和展示组件（Dumb-Presentational-Components）" class="headerlink" title="容器组件（Smart/Container Components）和展示组件（Dumb/Presentational Components）"></a>容器组件（Smart/Container Components）和展示组件（Dumb/Presentational Components）</h3><blockquote>
<p>大部分的组件都应该是展示型的，但一般需要少数的几个容器组件把它们和 Redux store 连接起来。<br>技术上讲你可以直接使用 store.subscribe() 来编写容器组件。但不建议这么做的原因是无法使用 React Redux 带来的性能优化。也因此，不要手写容器组件，而使用 React Redux 的 connect() 方法来生成，</p>
</blockquote>
<h2 id="示例：Todo-List"><a href="#示例：Todo-List" class="headerlink" title="示例：Todo List"></a><font color="#BA55D3">示例：Todo List</font></h2><p>action   创建函数、对象<br>reducer  combineReducers<br>store    createStore<br>provider store</p>
<p>connect  mapStateToProps  mapDispatchToProps  PropsType</p>
<p><br><br><br><br><br><br><br><br><br></p>
<h1 id="三、高级"><a href="#三、高级" class="headerlink" title="三、高级"></a><font color="#8A2BE2">三、高级</font></h1><h2 id="异步-Action"><a href="#异步-Action" class="headerlink" title="异步 Action"></a><font color="#BA55D3">异步 Action</font></h2><h3 id="Action-1"><a href="#Action-1" class="headerlink" title="Action"></a><strong>Action</strong></h3><p>  调用异步API，有两个非常关键的时刻：发起请求的时刻和接收到响应的时刻（也可能是超时）。</p>
<ul>
<li>一种通知 reducer 请求开始的 action。</li>
<li>一种通知 reducer 请求成功的 action。</li>
<li>一种通知 reducer 请求失败的 action。</li>
</ul>
<p>为了区分这三种 action，可以在 action 里添加一个 status 字段作为标记位，又或者为它们定义不同的 type：<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; type: &apos;FETCH_POSTS_REQUEST&apos; &#125;</span><br><span class="line">&#123; type: &apos;FETCH_POSTS_FAILURE&apos;, error: &apos;Oops&apos; &#125;</span><br><span class="line">&#123; type: &apos;FETCH_POSTS_SUCCESS&apos;, response: &#123; ... &#125; &#125;</span><br></pre></td></tr></table></figure></p>
<p>这应该是团队共同达成的约定。使用多个 type 会降低犯错误的机率，但是如果使用像 redux-actions 这类的辅助库来生成 action 创建函数和 reducer 的话，这就完全不是问题了。<br>无论使用哪种约定，一定要在整个应用中保持统一。</p>
<h3 id="设计-state-结构"><a href="#设计-state-结构" class="headerlink" title="设计 state 结构"></a><strong>设计 state 结构</strong></h3><h3 id="处理-Action"><a href="#处理-Action" class="headerlink" title="处理 Action"></a><strong>处理 Action</strong></h3><h3 id="异步-action-创建函数"><a href="#异步-action-创建函数" class="headerlink" title="异步 action 创建函数"></a><strong>异步 action 创建函数</strong></h3><blockquote>
<p>最后，如何把 之前定义 的同步 action 创建函数和网络请求结合起来呢？标准的做法是使用 Redux Thunk 中间件。通过使用指定的 middleware，action 创建函数除了返回 action 对象外还可以返回函数。这时，这个 action 创建函数就成为了 thunk。</p>
<p>当 action 创建函数返回函数时，这个函数会被 Redux Thunk middleware 执行。这个函数并不需要保持纯净；它还可以带有副作用，包括执行异步 API 请求。这个函数还可以 dispatch action，就像 dispatch 前面定义的同步 action 一样。</p>
<p>我们仍可以在 actions.js 里定义这些特殊的 thunk action 创建函数。</p>
<p>thunk 的一个优点是它的结果可以再次被 dispatch：</p>
</blockquote>
<div class="post-warning">fetch API<br>它是替代 XMLHttpRequest 用来发送网络请求的非常新的 API。由于目前大多数浏览器原生还不支持它，建议使用 cross_fetch 库,每次使用 fetch 前都这样调用一下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import fetch from &apos;cross_fetch&apos;;</span><br></pre></td></tr></table></figure><br><br>在底层，它在浏览器端使用 whatwg-fetch polyfill，在服务器端使用 node-fetch，所以如果当你把应用改成 同构 时，并不需要改变 API 请求。<br>注意，fetch polyfill 假设你已经使用了 Promise 的 polyfill。确保你使用 Promise polyfill 的一个最简单的办法是在所有应用代码前启用 Babel 的 ES6 polyfill，在应用中其它任何代码执行前调用一次：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos;babel-polyfill&apos;;</span><br></pre></td></tr></table></figure><br><br></div>

<p>Thunk middleware 并不是 Redux 处理异步 action 的唯一方式：<br>可以使用 redux-promise 或者 redux-promise-middleware 来 dispatch Promise 来替代函数。<br>可以使用 redux-observable 来 dispatch Observable。<br>可以使用 redux-saga 中间件来创建更加复杂的异步 action。<br>可以使用 redux-pack 中间件 dispatch 基于 Promise 的异步 Action。<br>甚至可以写一个自定义的 middleware 来描述 API 请求。</p>
<h2 id="异步数据流"><a href="#异步数据流" class="headerlink" title="异步数据流"></a><font color="#BA55D3">异步数据流</font></h2><blockquote>
<p>默认情况下，createStore() 所创建的 Redux store 没有使用 middleware，所以只支持 同步数据流。</p>
<p>可以使用 applyMiddleware() 来增强 createStore()。虽然这不是必须的，但是它可以帮助你用简便的方式来描述异步的 action。</p>
<p>当 middleware 链中的最后一个 middleware 开始 dispatch action 时，这个 action 必须是一个普通对象。这是 同步式的 Redux 数据流 开始的地方。</p>
</blockquote>
<h2 id="Middleware"><a href="#Middleware" class="headerlink" title="Middleware"></a><font color="#BA55D3">Middleware</font></h2><p>Redux middleware 被用于解决不同的问题，但其中的概念是类似的。<strong>它提供的是位于 action 被发起之后，到达 reducer 之前的扩展点。</strong> 可以利用 Redux middleware 来进行日志记录、创建崩溃报告、调用异步接口或者路由等等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">middleware：</span><br><span class="line">const logger = store =&gt; next =&gt; action =&gt; &#123;</span><br><span class="line">  console.log(&apos;dispatching&apos;, action)</span><br><span class="line">  let result = next(action)</span><br><span class="line">  console.log(&apos;next state&apos;, store.getState())</span><br><span class="line">  return result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const crashReporter = store =&gt; next =&gt; action =&gt; &#123;</span><br><span class="line">  try &#123;</span><br><span class="line">    return next(action)</span><br><span class="line">  &#125; catch (err) &#123;</span><br><span class="line">    console.error(&apos;Caught an exception!&apos;, err)</span><br><span class="line">    Raven.captureException(err, &#123;</span><br><span class="line">      extra: &#123;</span><br><span class="line">        action,</span><br><span class="line">        state: store.getState()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    throw err</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">然后是将它们引用到 Redux store 中：</span><br><span class="line"></span><br><span class="line">import &#123; createStore, combineReducers, applyMiddleware &#125; from &apos;redux&apos;</span><br><span class="line"></span><br><span class="line">let todoApp = combineReducers(reducers)</span><br><span class="line">let store = createStore(</span><br><span class="line">  todoApp,</span><br><span class="line">  // applyMiddleware() 告诉 createStore() 如何处理中间件</span><br><span class="line">  applyMiddleware(logger, crashReporter)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h2 id="搭配-React-Router"><a href="#搭配-React-Router" class="headerlink" title="搭配 React Router"></a><font color="#BA55D3">搭配 React Router</font></h2><h3 id="安装-React-Router"><a href="#安装-React-Router" class="headerlink" title="安装 React Router"></a>安装 React Router</h3><p>  npm install –save react-router</p>
<h3 id="配置后备-fallback-URL"><a href="#配置后备-fallback-URL" class="headerlink" title="配置后备(fallback) URL"></a>配置后备(fallback) URL</h3><p>在集成 React Router 之前，我们需要配置一下我们的开发服务器。 显然，我们的开发服务器无法感知配置在 React Router 中的 route。 比如：想访问并刷新 /todos，由于是一个单页面应用，你的开发服务器需要生成并返回 index.html。 这里，将演示如何在流行的开发服务器上启用这项功能。</p>
<h4 id="配置-Express"><a href="#配置-Express" class="headerlink" title="配置 Express"></a>配置 Express</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const express = require(&apos;express&apos;);</span><br><span class="line">const app = express();</span><br><span class="line"></span><br><span class="line">app.get(&apos;*&apos;, (req, res) =&gt; &#123;</span><br><span class="line">  fs.readFile(path.join(compiler.outputPath, `static/index.html`), (err, file) =&gt; &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">      res.sendStatus(404);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      res.send(file.toString());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="配置-WebpackDevServer"><a href="#配置-WebpackDevServer" class="headerlink" title="配置 WebpackDevServer"></a>配置 WebpackDevServer</h4><p>如果你正在使用 WebpackDevServer 来返回你的 index.html 页面， 你可以增加如下配置到 webpack.config.dev.js：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">  historyApiFallback: true,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="连接-React-Router-和-Redux-应用"><a href="#连接-React-Router-和-Redux-应用" class="headerlink" title="连接 React Router 和 Redux 应用"></a>连接 React Router 和 Redux 应用</h3><blockquote>
<p>在 React 应用中，通常你会用 &lt;Router /> 包裹 &lt;Route />。 如此，当 URL 变化的时候，&lt;Router /> 将会匹配到指定的路由，然后渲染路由绑定的组件。 &lt;Route /> 用来显式地把路由映射到应用的组件结构上。 用 path 指定 URL，用 component 指定路由命中 URL 后需要渲染的那个组件。</p>
</blockquote>
<blockquote>
<p>另外，在我们的 Redux 应用中，我们仍将使用 <provider>。 <provider> 是由 React Redux 提供的高阶组件，用来让你将 Redux 绑定到 React </provider></provider></p>
</blockquote>
<blockquote>
<p>也许你想将 ‘#’ 从 URL 中移除（例如：<a href="http://localhost:3000/#/?_k=4sbb0i）。" target="_blank" rel="noopener">http://localhost:3000/#/?_k=4sbb0i）。</a> 你需要从 React Router 导入 browserHistory 来实现：<br>  import { Router, Route, browserHistory } from ‘react-router’;<br>  然后将它传给 &lt; Router /&gt; 来移除 URL 中的 ‘#’：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; PropTypes &#125; from &apos;react&apos;;</span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;;</span><br><span class="line">import &#123; Router, Route, browserHistory &#125; from &apos;react-router&apos;;</span><br><span class="line">import App from &apos;./App&apos;;</span><br><span class="line"></span><br><span class="line">const Root = (&#123; store &#125;) =&gt; (</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;Router history=&#123;browserHistory&#125;&gt;</span><br><span class="line">      &lt;Route path=&quot;/(:filter)&quot; component=&#123;App&#125; /&gt; //当我们尝试从 URL 中读取参数 (:filter)</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  &lt;/Provider&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Root.propTypes = &#123;</span><br><span class="line">  store: PropTypes.object.isRequired,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default Root;</span><br></pre></td></tr></table></figure>
<h3 id="通过-React-Router-导航"><a href="#通过-React-Router-导航" class="headerlink" title="通过 React Router 导航"></a>通过 React Router 导航</h3><p>React Router 提供了 <link> 来实现导航功能。</p>
<p>containers/FilterLink.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;;</span><br><span class="line">import &#123; Link &#125; from &apos;react-router&apos;;</span><br><span class="line"></span><br><span class="line">const FilterLink = (&#123; filter, children &#125;) =&gt; (</span><br><span class="line">  &lt;Link</span><br><span class="line">    to=&#123;filter === &apos;all&apos; ? &apos;&apos; : filter&#125;</span><br><span class="line">    activeStyle=&#123;&#123;</span><br><span class="line">      textDecoration: &apos;none&apos;,</span><br><span class="line">      color: &apos;black&apos;</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  &gt;</span><br><span class="line">    &#123;children&#125;</span><br><span class="line">  &lt;/Link&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default FilterLink;</span><br></pre></td></tr></table></figure></p>
<p>components/Footer.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import React from &apos;react&apos;</span><br><span class="line">import FilterLink from &apos;../containers/FilterLink&apos;</span><br><span class="line"></span><br><span class="line">const Footer = () =&gt; (</span><br><span class="line">  &lt;p&gt;</span><br><span class="line">    Show:</span><br><span class="line">    &#123;&quot; &quot;&#125;</span><br><span class="line">    &lt;FilterLink filter=&quot;all&quot;&gt;</span><br><span class="line">      All</span><br><span class="line">    &lt;/FilterLink&gt;</span><br><span class="line">    &#123;&quot;, &quot;&#125;</span><br><span class="line">    &lt;FilterLink filter=&quot;active&quot;&gt;</span><br><span class="line">      Active</span><br><span class="line">    &lt;/FilterLink&gt;</span><br><span class="line">    &#123;&quot;, &quot;&#125;</span><br><span class="line">    &lt;FilterLink filter=&quot;completed&quot;&gt;</span><br><span class="line">      Completed</span><br><span class="line">    &lt;/FilterLink&gt;</span><br><span class="line">  &lt;/p&gt;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default Footer</span><br></pre></td></tr></table></figure></p>
<p>这时，如果你点击 <filterlink>，你将看到你的 URL 在 ‘/complete’，’/active’，’/‘ 间切换。 甚至还支持浏览的回退功能，可以从历史记录中找到之前的 URL 并回退。</filterlink></p>
<h3 id="从-URL-中读取数据"><a href="#从-URL-中读取数据" class="headerlink" title="从 URL 中读取数据"></a>从 URL 中读取数据</h3><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a><font color="#BA55D3">示例</font></h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/15/react/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/15/react/" itemprop="url">react</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-15T11:04:06+08:00">
                2019-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/框架/" itemprop="url" rel="index">
                    <span itemprop="name">框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!-- 宝蓝 4169E1 -->
<!-- 亮天蓝色    00BFFF -->
<!-- 天蓝色      87CEFA -->
<!-- 闪光绿      00FF00 -->
<h1 id="React是什么"><a href="#React是什么" class="headerlink" title="React是什么"></a>React是什么</h1><p>React 是一个用于构建用户界面的 JavaScript 库。</p>
<p>MVC -&gt; React</p>
<ol>
<li><p>效率高<br>虚拟DOM：传统web页面一般是直接操作DOM，代价很大，涉及重绘重排非常耗性能，而React 为了尽可能减少对DOM的操作，提供了一种不同的而又强大的方式来更新DOM，代替直接操作DOM，就是Virtual dom，轻量级的虚拟dom。更新virtual dom时不保证马上影响真实dom，react会等到事件循环结束，然后利用<font color="    #00FF00">diff算法</font>，通过当前新的dom与之前做比较，计算出最小的步骤更新真实的dom。</p>
</li>
<li><p>组件化<br>components 组件：在dom树上的节点被称为元素，在这里不同，称为virtual dom，整体称为component， 众多的virtual dom的节点就是一个完整的抽象的组件。</p>
</li>
<li><p>清晰<br>单向数据流：从父节点传递到子节点。</p>
</li>
<li><p>state &amp;&amp; props<br>state和props包含组件所需要的一些数据，当state或props的数据发生变化时，将会调用Render重新渲染，<br>React把组件看成是一个状态机。通过与用户的交互，实现不同状态，然后渲染 UI，让用户界面和数据保持一致。</p>
</li>
<li><p>class组件 和 生命周期钩子</p>
<ul>
<li><p>挂载<br><strong>constructor</strong><br><strong>UNSAFE_componentWillMount</strong> -&gt; <strong>getDerivedStateFromProps</strong><br><strong>render</strong><br><strong>componentDidMount</strong></p>
</li>
<li><p>更新<br><strong>UNSAFE_componentWillReceiveProps</strong> -&gt; <strong>getDerivedStateFromProps</strong><br><strong>shouldComponentUpdate</strong><br><strong>render</strong><br><strong>UNSAFE_componentWillUpdate</strong> -&gt; <strong>getSnapshotBeforeUpdate</strong><br><strong>componentDidUpdate</strong></p>
<p>setState：<br>  getDerivedStateFromProps -&gt; shouldComponentUpdate -&gt; render -&gt; getSnapshotBeforeUpdate -&gt; componentDidUpdate</p>
<p>forceUpdate：<br>  getDerivedStateFromProps -&gt; render -&gt; getSnapshotBeforeUpdate -&gt; componentDidUpdate</p>
</li>
<li><p>卸载<br><strong>componentWillUnmount</strong></p>
</li>
</ul>
<p>新增了getDerivedStateFromProps和getSnapshotBeforeUpdate两个钩子。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">getDerivedStateFromProps(props,state)：</span><br><span class="line">  相当于componentwillmount 和 componentWillReceiveProps合并</span><br><span class="line">  主要是应用在于封装组件时调用，组件的state取决于props变化</span><br><span class="line">  每次render都会调用，无条件的根据 props来更新内部 state，也就是只要有传入 props值， 就更新 state；只有 props 值和 state值不同时才更新 state 值</span><br><span class="line">  尽量不使用，维护俩者状态需要消耗额外资源，增加复杂度</span><br><span class="line">  典型场景表单获取默认值</span><br><span class="line"></span><br><span class="line">getSnapshotBeforeUpdate(prevProps，prevState)：</span><br><span class="line">  替换componentWillUpdate函数，将参数返回并传递给componentDidUpdate周期函数</span><br><span class="line">  getSnapshotBeforeUpdate() 在最近一次渲染输出（提交到 DOM 节点）之前调用。它使得组件能在发生更改之前从 DOM 中捕获一些信息（例如，滚动位置）。此生命周期的任何返回值将作为参数传递给 componentDidUpdate(prevProps, prevState, snapshot)。</span><br><span class="line">  典型场景：获取render之前的dom状态</span><br></pre></td></tr></table></figure>
 <div class="post-warning">下述生命周期方法即将过时，在新代码中应该避免使用它们：<br>   UNSAFE_componentWillMount<br>   UNSAFE_componentWillUpdate<br>   UNSAFE_componentWillReceiveProps<br> </div>

<ul>
<li><p>错误处理<br>当渲染过程，生命周期，或子组件的构造函数中抛出错误时，会调用如下方法：<br>getDerivedStateFromError<br>componentDidCatch</p>
</li>
<li><p>其他 APIs<br>组件还提供了一些额外的 API：<br>  setState<br>  forceUpdate<br>class 属性<br>  defaultProps<br>  displayName</p>
</li>
<li><p>实例属性<br>  props<br>  state</p>
</li>
</ul>
</li>
</ol>
<p><br><br></p>
<h1 id="创建-React-应用"><a href="#创建-React-应用" class="headerlink" title="创建 React 应用"></a>创建 React 应用</h1><h2 id="create-react-app搭建"><a href="#create-react-app搭建" class="headerlink" title="create-react-app搭建"></a>create-react-app搭建</h2>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">npm install create-react-app -g</span><br><span class="line">create-react-app xxx</span><br><span class="line">cd xxx</span><br><span class="line">npm start</span><br><span class="line">或</span><br><span class="line">npx create-react-app my-app</span><br><span class="line">cd my-app</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h2 id="从头开始打造工具链"><a href="#从头开始打造工具链" class="headerlink" title="从头开始打造工具链"></a>从头开始打造工具链</h2><h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><p>  package.json是下载依赖包的“说明书”，主要介绍其中的3个属性。<br>  1.devDependencies 开发依赖<br>  2.dependencies 生产依赖<br>  3.script 定义脚本命令(npm run …)</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"react1"</span>,</span><br><span class="line">  <span class="string">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="string">"description"</span>: <span class="string">""</span>,</span><br><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"webpack-dev-server --progress --colors --devtool source-map"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"git rm -rf dist&amp;&amp;node build/build.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"author"</span>: <span class="string">"jiyingying"</span>,</span><br><span class="line">  <span class="string">"license"</span>: <span class="string">"ISC"</span>,</span><br><span class="line">  <span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"webpack-dev-server"</span>: <span class="string">"^3.1.9"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"babel"</span>: <span class="string">"^6.23.0"</span>,</span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.24.0"</span>,</span><br><span class="line">    <span class="string">"babel-loader"</span>: <span class="string">"^7.1.5"</span>,</span><br><span class="line">    <span class="string">"babel-preset-es2015"</span>: <span class="string">"^6.24.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-react"</span>: <span class="string">"^6.23.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-stage-0"</span>: <span class="string">"^6.22.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-stage-2"</span>: <span class="string">"^6.22.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-env"</span>: <span class="string">"^1.7.0"</span>,</span><br><span class="line">    <span class="string">"css-loader"</span>: <span class="string">"^0.27.3"</span>,</span><br><span class="line">    <span class="string">"file-loader"</span>: <span class="string">"^0.10.1"</span>,</span><br><span class="line">    <span class="string">"react"</span>: <span class="string">"^15.3.0"</span>,</span><br><span class="line">    <span class="string">"react-dom"</span>: <span class="string">"^15.3.0"</span>,</span><br><span class="line">    <span class="string">"style-loader"</span>: <span class="string">"^0.23.1"</span>,</span><br><span class="line">    <span class="string">"url-loader"</span>: <span class="string">"^0.5.8"</span>,</span><br><span class="line">    <span class="string">"webpack"</span>: <span class="string">"^4.41.2"</span>,</span><br><span class="line">    <span class="string">"webpack-cli"</span>: <span class="string">"^3.3.9"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3><p>module.exports模块导出 =<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;entry <font color="blue">入口文件</font> : ‘./src/js/entry.js<font color="blue">入口文件的相对地址</font>‘,<br>&nbsp;&nbsp;&nbsp;&nbsp;output <font color="blue">出口文件</font> : {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path <font color="blue">出口文件路径</font> : __dirname+’/static/‘ <font color="blue">相对地址+出口文件夹名称</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;publicPath <font color="blue">公共路径</font> : “<a href="http://localhost:8080/static" target="_blank" rel="noopener">http://localhost:8080/static</a> <font color="blue">路径值</font>“,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename <font color="blue">出口文件名称</font> : ‘index.js <font color="blue">出口文件名称值</font>‘<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;module <font color="blue">模块配置</font> : {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rules <font color="blue">（规定使用什么loader解析相应文件，2.0版本之后是rules，1.0是loaders）</font> : [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{test : /.less$/ , <font color="red">use</font> : <font color="red">[</font>‘style-loader’,’css-loader’,’less-loader’<font color="red">]</font> } <font color="blue">解析less文件</font>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test <font color="blue"></font> : /.js$/  <font color="blue">使用babel-loader解析js</font> ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loader  <font color="blue">当只有1个loader时，可以写loaader，当其后的值是多个时，写use</font>  : “babel-loader”  ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exclude <font color="blue">表示哪些目录中的 .js 文件不要进行 babel-loader,include与之相反</font> :/node_modules/ <font color="blue"></font> ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;query <font color="blue">询问</font> : {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;presets <font color="blue">预置</font> : [<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require.resolve(‘babel-preset-es2015’) <font color="blue">识别es6</font> ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require.resolve(‘babel-preset-react’) <font color="blue">识别JSX语法</font> ,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require.resolve(‘babel-preset-stage-0’) <font color="blue">识别es7</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{test:/.(jpg|png)$/,loader:’url-loader’} <font color="blue">解析jpg和png文件</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;devServer <font color="blue">设备服务器配置</font> :{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port <font color="blue">端口号</font> :3030,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;historyApiFallback:true,//单页面应用<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inline:true,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;historyApiFallback: true,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disableHostCheck: true,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hot <font color="blue">热更新</font> : true,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy <font color="blue">代理</font> : {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;”/api/“: {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target: “<a href="http://jiyingying.m.ncfwxlocal.com/&quot;" target="_blank" rel="noopener">http://jiyingying.m.ncfwxlocal.com/&quot;</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secure: false,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changeOrigin: true<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry:<span class="string">'./src/js/entry.js'</span>,</span><br><span class="line">  output:&#123;</span><br><span class="line">      path:__dirname+<span class="string">'/static/'</span>,</span><br><span class="line">      publicPath:<span class="string">"http://localhost:3030/static"</span>,</span><br><span class="line">      filename:<span class="string">'index.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>:&#123;</span><br><span class="line">      rules:[</span><br><span class="line">          &#123;<span class="attr">test</span>:<span class="regexp">/\.less$/</span>,<span class="attr">use</span>:[<span class="string">'style-loader'</span>,<span class="string">'css-loader'</span>,<span class="string">'less-loader'</span>]&#125;,</span><br><span class="line">          &#123;</span><br><span class="line">              test:<span class="regexp">/\.js$/</span>,</span><br><span class="line">              loader:<span class="string">"babel-loader"</span>,</span><br><span class="line">              exclude:<span class="regexp">/node_modules/</span>,</span><br><span class="line">              query:&#123;</span><br><span class="line">                  presets:[</span><br><span class="line">                      <span class="built_in">require</span>.resolve(<span class="string">'babel-preset-es2015'</span>),</span><br><span class="line">                      <span class="built_in">require</span>.resolve(<span class="string">'babel-preset-react'</span>),</span><br><span class="line">                      <span class="built_in">require</span>.resolve(<span class="string">'babel-preset-stage-0'</span>)</span><br><span class="line">                  ]</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;<span class="attr">test</span>:<span class="regexp">/\.(jpg|png)$/</span>,<span class="attr">loader</span>:<span class="string">'url-loader'</span>&#125;</span><br><span class="line">      ]</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer:&#123;</span><br><span class="line">      port:<span class="number">3030</span>,</span><br><span class="line">      historyApiFallback:<span class="literal">true</span>, <span class="comment">//单页面应用!!!!!!</span></span><br><span class="line">      inline:<span class="literal">true</span>,</span><br><span class="line">      disableHostCheck: <span class="literal">true</span>,</span><br><span class="line">      hot: <span class="literal">true</span>,</span><br><span class="line">      proxy: &#123;</span><br><span class="line">          <span class="string">"/api/"</span>: &#123;</span><br><span class="line">            target: <span class="string">"http://jiyingying.m.ncfwxlocal.com/"</span>,</span><br><span class="line">            secure: <span class="literal">false</span>,</span><br><span class="line">            changeOrigin: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/js/entry.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname,<span class="string">'dist'</span>),</span><br><span class="line">    publicPath:<span class="string">'/dist'</span>,</span><br><span class="line">    filename:<span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules:[&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        loader: <span class="string">"babel-loader"</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        query: &#123;</span><br><span class="line">            presets: [</span><br><span class="line">              <span class="built_in">require</span>.resolve(<span class="string">'babel-preset-es2015'</span>),</span><br><span class="line">              <span class="built_in">require</span>.resolve(<span class="string">'babel-preset-react'</span>),</span><br><span class="line">              <span class="built_in">require</span>.resolve(<span class="string">'babel-preset-stage-0'</span>),</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    port: <span class="number">8083</span>,</span><br><span class="line">    historyApiFallback: <span class="literal">true</span>,</span><br><span class="line">    inline: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="创建第一个react组件"><a href="#创建第一个react组件" class="headerlink" title="创建第一个react组件"></a>创建第一个react组件</h3><p>  按照配置，创建对应的入口文件，文件基本内容如下：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</span><br><span class="line"><span class="keyword">var</span> ReactDom = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> App = React.createClass(&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> fontStyle = &#123;</span><br><span class="line">      color:<span class="string">'green'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> arr = [<span class="string">'小白兔'</span>,<span class="string">'白又白'</span>,<span class="string">'两只耳朵竖起来'</span>];</span><br><span class="line">    <span class="keyword">return</span> &lt;div style=&#123;&#123; color: 'red', &#125;&#125;&gt;</span><br><span class="line">            外层</span><br><span class="line">            &lt;div style = &#123; fontStyle &#125;&gt;内层&lt;/div&gt;</span><br><span class="line">            &lt;ul className = 'ulClass'&gt;</span><br><span class="line">              &#123;</span><br><span class="line">                arr.map( (item,index) =&gt; &lt;li key = &#123;index&#125;&gt;&#123;item&#125;&lt;/li&gt; )</span><br><span class="line">              &#125;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">            &lt;div&gt;&#123;this.props.name&#125;&lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ReactDom.render(</span><br><span class="line">  &lt;App name = <span class="string">'ji'</span>/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>  <strong>注意：不要在render中定义变量，这里只是为了讲述上述知识点</strong></p>
<ul>
<li><p>目前创建组件的方式有三种，分别是createClass、es6的class组件、函数式组件、<br>推荐阅读：<a href="https://www.jianshu.com/p/1dc57d51348b" target="_blank" rel="noopener">https://www.jianshu.com/p/1dc57d51348b</a></p>
<p>目前认为，createClass的效率比较慢，之后可能会被废弃，但是现在还没有。常用class组件，也有函数式组件，但是具体什么时候用class组件或函数式组件，暂时还没有定论。<br>createClass的实现，源码底层还会调用React.createElement等方法实现。但是我们轻易不要直接调用这些工具方法。</p>
</li>
</ul>
<p><br></p>
<h1 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h1><h2 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h2><blockquote>
<p>JSX是JS的语法扩展，它具有JS的全部功能。React认为：渲染逻辑常常与其他UI逻辑，比如：有一些数据需要放在UI中展示、有一些绑定处理事件需要放在UI中、数据发生变化时需要通知UI，所以React没有将 标记 和 逻辑 分离，而是将它们放在一个被称为“组件”的松散耦合单元中。</p>
</blockquote>
<blockquote>
<p>JSX这个有趣的标签语法，既不是字符串，也不是HTML。JSX可以生成React“元素”，这些元素会被渲染成DOM。</p>
</blockquote>
<blockquote>
<p>JSX 也是一个表达式，在 JSX 中也可以嵌入表达式<br>  为了便于阅读，我们会将 JSX 拆分为多行。同时，我们建议将内容包裹在括号中，虽然这样做不是强制要求的，但是这可以避免遇到<strong>自动插入分号陷阱</strong>。</p>
</blockquote>
  <div class="post-warning">tips：<br>    因为 JSX 语法上更接近 js 而不是 HTML，所以 React DOM 使用 camelCase（小驼峰命名）来定义属性的名称，而不使用 HTML 属性名称的命名约定。<br>    例如，JSX 里的 class 变成了 className，而 tabindex 则变为 tabIndex。<br>  </div>


<p>  JSX 防止注入攻击<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> title = response.potentiallyMaliciousInput;</span><br><span class="line"><span class="comment">// 直接使用是安全的：</span></span><br><span class="line"><span class="keyword">const</span> element = &lt;h1&gt;&#123;title&#125;&lt;/h1&gt;;</span><br></pre></td></tr></table></figure></p>
<p>  <strong>React DOM 在渲染所有输入内容之前，默认会进行转义。它可以确保在你的应用中，永远不会注入那些并非自己明确编写的内容。所有的内容在渲染之前都被转换成了字符串。这样可以有效地防止<font color="#0f0"> XSS（cross-site-scripting, 跨站脚本）攻击</font>。</strong></p>
<p>  JSX 表示对象<br>  Babel 会把 JSX 转译成一个名为 React.createElement() 函数调用。<br>    以下两种示例代码完全等效：<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = (</span><br><span class="line">  &lt;h1 className=<span class="string">"greeting"</span>&gt;</span><br><span class="line">    Hello, world!</span><br><span class="line">  &lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const element = React.createElement(</span></span><br><span class="line"><span class="regexp">  'h1',</span></span><br><span class="line"><span class="regexp">  &#123;className: 'greeting'&#125;,</span></span><br><span class="line"><span class="regexp">  'Hello, world!'</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure></p>
<p>  React.createElement() 会预先执行一些检查，以帮助你编写无错代码，但实际上它创建了一个这样的对象：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注意：这是简化过的结构</span></span><br><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">  type: <span class="string">'h1'</span>,</span><br><span class="line">  props: &#123;</span><br><span class="line">    className: <span class="string">'greeting'</span>,</span><br><span class="line">    children: <span class="string">'Hello, world!'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>  这些对象被称为 “React 元素”。它们描述了你希望在屏幕上看到的内容。React 通过读取这些对象，然后使用它们来构建 DOM 以及保持随时更新。</p>
<h2 id="元素渲染"><a href="#元素渲染" class="headerlink" title="元素渲染"></a>元素渲染</h2><p>  与浏览器的 DOM 元素不同，React 元素是创建开销极小的普通对象。React DOM 会负责更新 DOM 来与 React 元素保持一致。</p>
<ul>
<li><p>将一个元素渲染为 DOM<br>假设你的 HTML 文件某处有一个 &lt;div>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"root"</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>我们将其称为“根” DOM 节点，因为该节点内的所有内容都将由 React DOM 管理。</p>
<p>仅使用 React 构建的应用通常只有单一的根 DOM 节点。如果你在将 React 集成进一个已有应用，那么你可以在应用中包含任意多的独立根 DOM 节点。</p>
</li>
</ul>
<ul>
<li><p>更新已渲染的元素<br>React 元素是不可变对象。一旦被创建，你就无法更改它的子元素或者属性。一个元素就像电影的单帧：它代表了某个特定时刻的 UI。<br>根据我们已有的知识，更新 UI 唯一的方式是创建一个全新的元素，并将其传入 ReactDOM.render()。</p>
<p>思考：【元素渲染】考虑一个计时器的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> element = (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line">      &lt;h2&gt;It is &#123;<span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleTimeString()&#125;.&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">  ReactDOM.render(element, <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setInterval(tick, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<p>这个例子会在 setInterval() 回调函数，每秒都调用 ReactDOM.render()。<br>注意：在实践中，大多数 React 应用只会调用一次 ReactDOM.render()。React 只更新它需要更新的部分。React DOM 会将元素和它的子元素与它们之前的状态进行比较，并只会进行必要的更新来使 DOM 达到预期的状态。<br>本例中，尽管每一秒我们都会新建一个描述整个 UI 树的元素，React DOM 只会更新实际改变了的内容，也就是例子中的文本节点。</p>
</li>
</ul>
<p><br></p>
<h2 id="组件-amp-Props"><a href="#组件-amp-Props" class="headerlink" title="组件 &amp; Props"></a>组件 &amp; Props</h2><h3 id="函数组件-与-class-组件"><a href="#函数组件-与-class-组件" class="headerlink" title="函数组件 与 class 组件"></a>函数组件 与 class 组件</h3><p>定义组件最简单的方式就是编写 JavaScript 函数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;h1&gt;Hello, &#123;props.name&#125;&lt;/h1&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该函数是一个有效的 React 组件，因为它接收唯一带有数据的 “props”（代表属性）对象与并返回一个 React 元素。这类组件被称为“函数组件”，因为它本质上就是 JavaScript 函数。</p>
<p>你同时还可以使用 ES6 的 class 来定义组件：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;h1&gt;Hello, &#123;this.props.name&#125;&lt;/h1&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>上述两个组件在 React 里是等效的。</p>
<h3 id="渲染组件"><a href="#渲染组件" class="headerlink" title="渲染组件"></a>渲染组件</h3><p>当 React 元素为用户自定义组件时，它会将 JSX 所接收的属性（attributes）以及子组件（children）转换为单个对象传递给组件，这个对象被称之为 “props”。</p>
<h3 id="props-父-gt-子"><a href="#props-父-gt-子" class="headerlink" title="props (父 -&gt; 子)"></a>props (父 -&gt; 子)</h3><p><strong>可嵌套子组件：this.props.children</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</span><br><span class="line"><span class="keyword">var</span> ReactDom = <span class="built_in">require</span>(<span class="string">'react-dom'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> App = React.createClass(&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &#123; <span class="keyword">this</span>.props.name &#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">ReactDom.render(</span></span><br><span class="line"><span class="regexp">  &lt;App name = 'ji'/</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<h3 id="子-gt-父"><a href="#子-gt-父" class="headerlink" title="子 -&gt; 父"></a>子 -&gt; 父</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  changeText()&#123;</span><br><span class="line">    <span class="keyword">this</span>.props.changeText(<span class="string">'123'</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div onClick=&#123; <span class="keyword">this</span>.changeText()&#125;&gt;</span><br><span class="line">        &#123; <span class="keyword">this</span>.state.text &#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)];</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class App extends Component&#123;</span></span><br><span class="line"><span class="regexp">  constructor(props) &#123;</span></span><br><span class="line"><span class="regexp">    super(props)</span></span><br><span class="line"><span class="regexp">    this.state = &#123;</span></span><br><span class="line"><span class="regexp">      text: '父亲'，</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  changeText(text)&#123;</span></span><br><span class="line"><span class="regexp">    this.setState(&#123;</span></span><br><span class="line"><span class="regexp">      text,</span></span><br><span class="line"><span class="regexp">    &#125;);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;Son changeText=&#123; (text) =&gt; this.changeText.bind(this, text)&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &#123; this.state.text &#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>Son&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ReactDom.render(</span><br><span class="line">  &lt;App name = <span class="string">'ji'</span>/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="Props-的只读性"><a href="#Props-的只读性" class="headerlink" title="Props 的只读性"></a>Props 的只读性</h3><p>  组件无论是使用函数声明还是通过 class 声明，都决不能修改自身的 props。<br>  来看下这个 sum 函数：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  这样的函数被称为 “纯函数”，因为该函数不会更改入参，且多次调用下：相同的入参始终返回相同的结果。<br>  相反，下面这个函数则不是纯函数，因为它更改了自己的入参：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">withdraw</span>(<span class="params">account, amount</span>) </span>&#123;</span><br><span class="line">  account.total -= amount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  React 非常灵活，但它有一个严格的规则：所有React组件都必须像纯函数一样保护它们的 props 不被更改。</p>
<p>  当然，应用程序的UI是动态的，并会伴随着时间的推移而变化。我们将介绍一种新的概念称之为 “state”。在不违反上述规则的情况下，state 允许 React 组件随用户操作、网络响应或者其他变化而动态更改输出内容。</p>
<h2 id="State-amp-生命周期"><a href="#State-amp-生命周期" class="headerlink" title="State &amp; 生命周期"></a>State &amp; 生命周期</h2><p>  将函数组件转换成 class 组件</p>
<ol>
<li>创建一个ES6 class，并且继承于 React.Component。</li>
<li>添加一个空的 render() 方法。</li>
<li>将函数体移动到 render() 方法之中。</li>
<li>在 render() 方法中使用 this.props 替换 props。</li>
</ol>
<p>  向 class 组件中添加局部的 state</p>
<ol>
<li>添加一个 class 构造函数，然后在该函数中为 this.state 赋初值</li>
<li>在 render() 中可以调用 this.state 中的值</li>
<li>this.setState({}) 方法可以改变this.state中的值</li>
</ol>
<h3 id="正确地使用-State"><a href="#正确地使用-State" class="headerlink" title="正确地使用 State"></a>正确地使用 State</h3><ol>
<li><p>不要直接修改 State<br>例如，此代码不会重新渲染组件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Wrong</span></span><br><span class="line"><span class="keyword">this</span>.state.comment = <span class="string">'Hello'</span>;</span><br><span class="line">而是应该使用 setState():</span><br><span class="line"></span><br><span class="line"><span class="comment">// Correct</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;<span class="attr">comment</span>: <span class="string">'Hello'</span>&#125;);</span><br></pre></td></tr></table></figure>
<p>构造函数是唯一可以给 this.state 直接赋值的地方：</p>
</li>
<li><p>State的更新可能是异步的<br>出于性能考虑，React 可能会把多个 setState() 调用合并成一个调用。<br>因为 this.props 和 this.state 可能会异步更新，所以不要依赖他们的值来更新下一个状态。</p>
<p>例如，此代码可能会无法更新计数器：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Wrong</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">  counter: <span class="keyword">this</span>.state.counter + <span class="keyword">this</span>.props.increment,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>要解决这个问题， 可以让 setState() 接收一个函数而不是一个对象。这个函数用上一个 state 作为第一个参数，将此次更新被应用时的 props 做为第二个参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Correct</span></span><br><span class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">state, props</span>) =&gt;</span> (&#123;</span><br><span class="line">  counter: state.counter + props.increment</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">上面使用了箭头函数，不过使用普通的函数也同样可以：</span><br><span class="line"><span class="comment">// Correct</span></span><br><span class="line"><span class="keyword">this</span>.setState(<span class="function"><span class="keyword">function</span>(<span class="params">state, props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    counter: state.counter + props.increment</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>State的更新会被合并<br>当你调用 setState() 的时候，React 会把你提供的对象合并到当前的 state。</p>
</li>
</ol>
<h3 id="数据是向下流动的"><a href="#数据是向下流动的" class="headerlink" title="数据是向下流动的"></a>数据是向下流动的</h3><p>  state 为局部的或是封装，是因为除了拥有并设置了它的组件，其他组件都无法访问。</p>
<p>  组件可以选择把它的state作为 props 向下传递，这通常会被叫做“自上而下”或是“单向数据流”。任何的 state 总是所属于特定的组件，而且从该 state 派生的任何数据或 UI 只能影响树中“低于”它们的组件。</p>
<p>  在class组件中使用state：</p>
<ol>
<li><p>函数式组件实现定时显示时间</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Clock</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line">      &lt;h2&gt;It is &#123;props.date.toLocaleTimeString()&#125;.&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  ReactDOM.render(</span><br><span class="line">    &lt;Clock date=&#123;<span class="keyword">new</span> <span class="built_in">Date</span>()&#125; /&gt;,</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setInterval(tick, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>class组件实现定时显示时间</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.timerID = setInterval(</span><br><span class="line">      () =&gt; <span class="keyword">this</span>.tick(),</span><br><span class="line">      <span class="number">1000</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    clearInterval(<span class="keyword">this</span>.timerID);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  tick() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      date: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Hello, world!&lt;/h1&gt;</span><br><span class="line">        &lt;h2&gt;It is &#123;<span class="keyword">this</span>.state.date.toLocaleTimeString()&#125;.&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Clock /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="其他概念"><a href="#其他概念" class="headerlink" title="其他概念"></a>其他概念</h2><h3 id="1、事件处理"><a href="#1、事件处理" class="headerlink" title="1、事件处理"></a>1、事件处理</h3><blockquote>
<p>【阻止默认行为-preventDefault】在 React 中另一个不同点是你不能通过返回 false 的方式阻止默认行为。你必须显式的使用 preventDefault 。<br>【this】必须谨慎对待 JSX 回调函数中的 this，在 js 中，class 的方法默认不会绑定 this。如果你忘记绑定 this.handleClick 并把它传入了 onClick，当你调用这个函数的时候 this 的值为 undefined。<br>  这并不是 React 特有的行为；这其实与 JavaScript 函数工作原理有关。通常情况下，如果你没有在方法后面添加 ()，例如 onClick={this.handleClick}，你应该为这个方法绑定 this。</p>
</blockquote>
<p> 【箭头函数】如果你没有使用 class fields 语法，你可以在回调中使用箭头函数：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LoggingButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'this is:'</span>, <span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 此语法确保 `handleClick` 内的 `this` 已被绑定。</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; <span class="keyword">this</span>.handleClick()&#125;&gt;</span><br><span class="line">        Click me</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>  此语法问题在于每次渲染 LoggingButton 时都会创建不同的回调函数。在大多数情况下，这没什么问题，<font color="#EE82EE">但如果该回调函数作为 prop 传入子组件时，这些组件可能会进行额外的重新渲染。我们通常建议在构造器中绑定或使用 class fields 语法来避免这类性能问题。</font></p>
<blockquote>
<p>向事件处理程序传递参数<br>在循环中，通常我们会为事件处理函数传递额外的参数。例如，若 id 是你要删除那一行的 ID，以下两种方式都可以向事件处理函数传递参数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;(e) =&gt; <span class="keyword">this</span>.deleteRow(id, e)&#125;&gt;Delete Row&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">&lt;button onClick=&#123;this.deleteRow.bind(this, id)&#125;&gt;Delete Row&lt;/</span>button&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>上述两种方式是等价的，分别通过箭头函数和 Function.prototype.bind 来实现。</p>
<p>在这两种情况下，React 的事件对象 e 会被作为第二个参数传递。如果通过箭头函数的方式，事件对象必须显式的进行传递，而通过 bind 的方式，事件对象以及更多的参数将会被隐式的进行传递。</p>
<h3 id="2、条件渲染"><a href="#2、条件渲染" class="headerlink" title="2、条件渲染"></a>2、条件渲染</h3><p>  元素变量<br>  与运算符&amp;&amp;<br>  三目运算符<br>  阻止组件渲染</p>
<h3 id="3、列表-amp-Key"><a href="#3、列表-amp-Key" class="headerlink" title="3、列表 &amp; Key"></a>3、列表 &amp; Key</h3><p>  渲染多个组件<br>  基础列表组件</p>
<blockquote>
<p>key：<br>    一个元素的 key 最好是这个元素在列表中拥有的一个独一无二的字符串。<br>    当元素没有确定 id 的时候，万不得已你可以使用元素索引 index 作为 key。<br>    如果列表项目的顺序可能会变化，我们不建议使用索引来用作 key 值，因为这样做会导致性能变差，还可能引起组件状态的问题。可以看看 Robin Pokorny 的深度解析使用索引作为 key 的负面影响这一篇文章。如果你选择不指定显式的 key 值，那么 React 将默认使用索引用作为列表项目的 key 值。<br>    <a href="(https://react.docschina.org/docs/reconciliation.html#recursing-on-children">深入解析为什么 key 是必须的</a>)<br>    key 只是在兄弟节点之间必须唯一</p>
</blockquote>
<h3 id="4、表单"><a href="#4、表单" class="headerlink" title="4、表单"></a>4、表单</h3><p>  受控组件<br>  textarea 标签<br>  select 标签<br>  文件 input 标签<br>  处理多个输入</p>
<p>  <code>受控输入空值</code> 在受控组件上指定 value 的 prop 会阻止用户更改输入。如果你指定了 value，但输入仍可编辑，则可能是你意外地将value 设置为 undefined 或 null。<br>  下面的代码演示了这一点。（输入最初被锁定，但在短时间延迟后变为可编辑。）<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.render(&lt;input value="hi" /&gt;, mountNode);</span><br><span class="line"></span><br><span class="line">setTimeout(function() &#123;</span><br><span class="line">  ReactDOM.render(&lt;input value=&#123;null&#125; /&gt;, mountNode);</span><br><span class="line">&#125;, 1000);</span><br></pre></td></tr></table></figure></p>
<p>  <code>受控组件的替代品</code>有时使用受控组件会很麻烦，因为你需要为数据变化的每种方式都编写事件处理函数，并通过一个 React 组件传递所有的输入 state。当你将之前的代码库转换为 React 或将 React 库集成时，这可能会令人厌烦。在这些情况下，你可能希望使用非受控组件, 这是实现输入表单的另一种方式。成熟的解决方案，如：Formik。</p>
<h3 id="5、状态提升"><a href="#5、状态提升" class="headerlink" title="5、状态提升"></a>5、状态提升</h3><blockquote>
<p>在 React 应用中，任何可变数据应当只有一个相对应的唯一“数据源”。通常，state 都是首先添加到需要渲染数据的组件中去。然后，如果其他组件也需要这个 state，那么你可以将它提升至这些组件的最近共同父组件中。你应当依靠自上而下的数据流，而不是尝试在不同组件间同步 state。</p>
</blockquote>
<h3 id="6、组合-vs-继承"><a href="#6、组合-vs-继承" class="headerlink" title="6、组合 vs 继承"></a>6、组合 vs 继承</h3><h4 id="包含关系"><a href="#包含关系" class="headerlink" title="包含关系"></a>包含关系</h4><ol>
<li><p>props.children</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function WelcomeDialog() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;FancyBorder color="blue"&gt;</span><br><span class="line">      &lt;h1 className="Dialog-title"&gt;</span><br><span class="line">        Welcome</span><br><span class="line">      &lt;/h1&gt;</span><br><span class="line">      &lt;p className="Dialog-message"&gt;</span><br><span class="line">        Thank you for visiting our spacecraft!</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">    &lt;/FancyBorder&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>props.属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SplitPane</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"SplitPane"</span>&gt;</span><br><span class="line">      &lt;div className=<span class="string">"SplitPane-left"</span>&gt;</span><br><span class="line">        &#123;props.left&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div className="SplitPane-right"&gt;</span></span><br><span class="line"><span class="regexp">        &#123;props.right&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;SplitPane</span></span><br><span class="line"><span class="regexp">      left=&#123;</span></span><br><span class="line"><span class="regexp">        &lt;Contacts /</span>&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      right=&#123;</span><br><span class="line">        &lt;Chat /&gt;</span><br><span class="line">      &#125; /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="特例关系"><a href="#特例关系" class="headerlink" title="特例关系"></a>特例关系</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dialog</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;FancyBorder color=<span class="string">"blue"</span>&gt;</span><br><span class="line">      &lt;h1 className=<span class="string">"Dialog-title"</span>&gt;</span><br><span class="line">        &#123;props.title&#125;</span><br><span class="line">      &lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &lt;p className="Dialog-message"&gt;</span></span><br><span class="line"><span class="regexp">        &#123;props.message&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>p&gt;</span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line">    &lt;<span class="regexp">/FancyBorder&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class SignUpDialog extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  constructor(props) &#123;</span></span><br><span class="line"><span class="regexp">    super(props);</span></span><br><span class="line"><span class="regexp">    this.handleChange = this.handleChange.bind(this);</span></span><br><span class="line"><span class="regexp">    this.handleSignUp = this.handleSignUp.bind(this);</span></span><br><span class="line"><span class="regexp">    this.state = &#123;login: ''&#125;;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  handleChange(e) &#123;</span></span><br><span class="line"><span class="regexp">    this.setState(&#123;login: e.target.value&#125;);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  handleSignUp() &#123;</span></span><br><span class="line"><span class="regexp">    alert(`Welcome aboard, $&#123;this.state.login&#125;!`);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;Dialog title="Mars Exploration Program"</span></span><br><span class="line"><span class="regexp">              message="How should we refer to you?"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input value=&#123;this.state.login&#125;</span></span><br><span class="line"><span class="regexp">               onChange=&#123;this.handleChange&#125; /</span>&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.handleSignUp&#125;&gt;</span><br><span class="line">          Sign Me Up!</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>Dialog&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="高级指引"><a href="#高级指引" class="headerlink" title="高级指引"></a>高级指引</h1><h2 id="无障碍"><a href="#无障碍" class="headerlink" title="无障碍"></a>无障碍</h2><ol>
<li><p>语义化的HTML<br>Fragments标签，短语法：&lt;&gt;&lt;/&gt;</p>
</li>
<li><p>无障碍表单<br>标记<br><label htmlfor="namedInput">Name:</label><br><input id="namedInput" type="text" name="name"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;label htmlFor=<span class="string">"namedInput"</span>&gt;Name:&lt;/label&gt;</span><br><span class="line">&lt;input id=<span class="string">"namedInput"</span> type=<span class="string">"text"</span> name=<span class="string">"name"</span>/&gt;</span><br></pre></td></tr></table></figure>
<p>在出错时提醒用户</p>
</li>
<li><p>控制焦点<br>键盘焦点及焦点轮廓<br>跳过内容机制<br>使用程序管理焦点</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomTextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="comment">// 创造一个 textInput DOM 元素的 ref</span></span><br><span class="line">    <span class="keyword">this</span>.textInput = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">  <span class="comment">// 使用 `ref` 回调函数以在实例的一个变量中存储文本输入 DOM 元素</span></span><br><span class="line">  <span class="comment">//（比如，this.textInput）。</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;input</span><br><span class="line">        type=<span class="string">"text"</span></span><br><span class="line">        ref=&#123;<span class="keyword">this</span>.textInput&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>鼠标和指针事件</p>
<ol>
<li><p>在 window 对象中附上一个 click 事件以关闭弹窗：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OuterClickExample</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">isOpen</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">    <span class="keyword">this</span>.toggleContainer = React.createRef();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.onClickHandler = <span class="keyword">this</span>.onClickHandler.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.onClickOutsideHandler = <span class="keyword">this</span>.onClickOutsideHandler.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'click'</span>, <span class="keyword">this</span>.onClickOutsideHandler);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    <span class="built_in">window</span>.removeEventListener(<span class="string">'click'</span>, <span class="keyword">this</span>.onClickOutsideHandler);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onClickHandler() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function"><span class="params">currentState</span> =&gt;</span> (&#123;</span><br><span class="line">      isOpen: !currentState.isOpen</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onClickOutsideHandler(event) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.isOpen &amp;&amp; !<span class="keyword">this</span>.toggleContainer.current.contains(event.target)) &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123; <span class="attr">isOpen</span>: <span class="literal">false</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div ref=&#123;<span class="keyword">this</span>.toggleContainer&#125;&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.onClickHandler&#125;&gt;Select an option&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &#123;this.state.isOpen &amp;&amp; (</span></span><br><span class="line"><span class="regexp">          &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">            &lt;li&gt;Option 1&lt;/</span>li&gt;</span><br><span class="line">            &lt;li&gt;Option <span class="number">2</span>&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">            &lt;li&gt;Option 3&lt;/</span>li&gt;</span><br><span class="line">          &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        )&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用正确的事件触发器，比如 onBlur 和 onFocus，同样可以达成这项功能：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlurExample</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">isOpen</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">    <span class="keyword">this</span>.timeOutId = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.onClickHandler = <span class="keyword">this</span>.onClickHandler.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.onBlurHandler = <span class="keyword">this</span>.onBlurHandler.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.onFocusHandler = <span class="keyword">this</span>.onFocusHandler.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onClickHandler() &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function"><span class="params">currentState</span> =&gt;</span> (&#123;</span><br><span class="line">      isOpen: !currentState.isOpen</span><br><span class="line">    &#125;));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 我们在下一个时间点使用 setTimeout 关闭弹窗。</span></span><br><span class="line">  <span class="comment">// 这是必要的，因为失去焦点事件会在新的焦点事件前被触发，</span></span><br><span class="line">  <span class="comment">// 我们需要通过这个步骤确认这个元素的一个子节点</span></span><br><span class="line">  <span class="comment">// 是否得到了焦点。</span></span><br><span class="line">  onBlurHandler() &#123;</span><br><span class="line">    <span class="keyword">this</span>.timeOutId = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        isOpen: <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果一个子节点获得了焦点，不要关闭弹窗。</span></span><br><span class="line">  onFocusHandler() &#123;</span><br><span class="line">    clearTimeout(<span class="keyword">this</span>.timeOutId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// React 通过把失去焦点和获得焦点事件传输给父节点</span></span><br><span class="line">    <span class="comment">// 来帮助我们。</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div onBlur=&#123;<span class="keyword">this</span>.onBlurHandler&#125;</span><br><span class="line">          onFocus=&#123;<span class="keyword">this</span>.onFocusHandler&#125;&gt;</span><br><span class="line">        &lt;button onClick=&#123;<span class="keyword">this</span>.onClickHandler&#125;</span><br><span class="line">                aria-haspopup=<span class="string">"true"</span></span><br><span class="line">                aria-expanded=&#123;<span class="keyword">this</span>.state.isOpen&#125;&gt;</span><br><span class="line">          Select an option</span><br><span class="line">        &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &#123;this.state.isOpen &amp;&amp; (</span></span><br><span class="line"><span class="regexp">          &lt;ul&gt;</span></span><br><span class="line"><span class="regexp">            &lt;li&gt;Option 1&lt;/</span>li&gt;</span><br><span class="line">            &lt;li&gt;Option <span class="number">2</span>&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">            &lt;li&gt;Option 3&lt;/</span>li&gt;</span><br><span class="line">          &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        )&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>更复杂的部件<br>即使最复杂的部件也可以实现无障碍访问。</p>
</li>
<li><p>其他考虑因素<br>设置语言<br>设置文档标题<br>色彩对比度</p>
</li>
<li><p>开发及测试</p>
<ol>
<li>键盘</li>
<li>开发辅助  eslint-plugin-jsx-a11y</li>
<li>在浏览器中测试无障碍辅助功能<br>aXe,aXe-core 以及 react-axe<br>WebAIM WAVE<br>无障碍辅助功能检测器和无障碍辅助功能树</li>
<li><p>屏幕朗读器</p>
<ul>
<li><p>常用屏幕朗读器:<br>火狐中的 NVDA<br>Safari 中的 VoiceOver<br>Internet Explorer 中的 JAWS</p>
</li>
<li><p>其他屏幕朗读器:<br>Google Chrome 中的 ChromeVox</p>
</li>
</ul>
</li>
</ol>
</li>
</ol>
<h2 id="代码分割"><a href="#代码分割" class="headerlink" title="代码分割"></a>代码分割</h2><p>1、打包<br>大多数 React 应用都会使用 Webpack，Rollup 或 Browserify 这类的构建工具来打包文件。 打包是一个将文件引入并合并到一个单独文件的过程，最终形成一个 “bundle”。 接着在页面上引入该 bundle，整个应用即可一次性加载。</p>
<p>2、代码分割<br>对应用进行代码分割能够帮助“懒加载”当前用户所需要的内容，能够显著地提高应用性能。尽管并没有减少应用整体的代码体积，但可以避免加载用户永远不需要的代码，并在初始加载的时候减少所需加载的代码量。</p>
<p>3、import()<br>在应用中引入代码分割的最佳方式是通过动态 import() 语法。<br>当使用 Babel 时，你要确保 Babel 能够解析动态 import 语法而不是将其进行转换。对于这一要求你需要 babel-plugin-syntax-dynamic-import 插件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">package.json</span><br><span class="line"></span><br><span class="line">&quot;babel&quot;: &#123;</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    &quot;@babel/plugin-syntax-dynamic-import&quot;,</span><br><span class="line">    [</span><br><span class="line">      &quot;import&quot;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;libraryName&quot;: &quot;antd&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;styled-components&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;babel-plugin-add-react-displayname-babel7&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、React.lazy<br>React.lazy 函数能让你像渲染常规组件一样处理动态引入（的组件）。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">使用之前：</span><br><span class="line"><span class="keyword">import</span> OtherComponent <span class="keyword">from</span> <span class="string">'./OtherComponent'</span>;</span><br><span class="line"></span><br><span class="line">使用之后：</span><br><span class="line"><span class="keyword">import</span> React, &#123; Suspense &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> OtherComponent = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./OtherComponent'</span>));</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;OtherComponent /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>此代码将会在组件首次渲染时，自动导入包含 OtherComponent 组件的包。</p>
<p>React.lazy 接受一个函数，这个函数需要动态调用 import()。它必须返回一个 Promise，该 Promise 需要 resolve 一个 defalut export 的 React 组件。</p>
<p>然后应在 Suspense 组件中渲染 lazy 组件，如此使得我们可以使用在等待加载 lazy 组件时做优雅降级（如 loading 指示器等）。fallback 属性接受任何在组件加载过程中你想展示的 React 元素。</p>
<p>5、异常捕获边界（Error boundaries）<br>如果模块加载失败（如网络问题），它会触发一个错误。你可以通过异常捕获边界（Error boundaries）技术来处理这些情况，以显示良好的用户体验并管理恢复事宜。</p>
<p>6、基于路由的代码分割</p>
<p>7、命名导出（Named Exports）</p>
<h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><p>Context 提供了一个无需为每层组件手动添加 props，就能在组件树间进行数据传递的方法。</p>
<p>1、 何时使用 Context</p>
<p>Context 设计目的是为了共享那些对于一个组件树而言是“全局”的数据，例如当前认证的用户、主题或首选语言。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Context 可以让我们无须明确地传遍每一个组件，就能将值深入传递进组件树。</span></span><br><span class="line"><span class="comment">// 为当前的 theme 创建一个 context（“light”为默认值）。</span></span><br><span class="line"><span class="keyword">const</span> ThemeContext = React.createContext(<span class="string">'light'</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 使用一个 Provider 来将当前的 theme 传递给以下的组件树。</span></span><br><span class="line">    <span class="comment">// 无论多深，任何组件都能读取这个值。</span></span><br><span class="line">    <span class="comment">// 在这个例子中，我们将 “dark” 作为当前的值传递下去。</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;ThemeContext.Provider value=<span class="string">"dark"</span>&gt;</span><br><span class="line">        &lt;Toolbar /&gt;</span><br><span class="line">      &lt;<span class="regexp">/ThemeContext.Provider&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 中间的组件再也不必指明往下传递 theme 了。</span></span><br><span class="line"><span class="regexp">function Toolbar() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;ThemedButton /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class ThemedButton extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 指定 contextType 读取当前的 theme context。</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ React 会往上找到最近的 theme Provider，然后使用它的值。</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ 在这个例子中，当前的 theme 值为 “dark”。</span></span><br><span class="line"><span class="regexp">  static contextType = ThemeContext;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return &lt;Button theme=&#123;this.context&#125; /</span>&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2、使用 Context 之前的考虑<br>Context 主要应用场景在于很多不同层级的组件需要访问同样一些的数据。请谨慎使用，因为这会使得组件的复用性变差。</p>
<p>3、API<br>  React.createContext<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyContext = React.createContext(defaultValue);</span><br></pre></td></tr></table></figure></p>
<p>  Context.Provider<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt; MyContext.Provider value=&#123;<span class="comment">/* 某个值 */</span>&#125; &gt;</span><br></pre></td></tr></table></figure></p>
<p>  Class.contextType</p>
<p>  Context.Consumer</p>
<p>  Context.displayName<br>    context 对象接受一个名为 displayName 的 property，类型为字符串。React DevTools 使用该字符串来确定 context 要显示的内容。</p>
<h2 id="错误边界"><a href="#错误边界" class="headerlink" title="错误边界"></a>错误边界</h2><ul>
<li>错误边界<div class="post-warning">错误边界无法捕获以下场景中产生的错误：<br>事件处理<br>异步代码（例如 setTimeout 或 requestAnimationFrame 回调函数）<br>服务端渲染<br>它自身抛出来的错误（并非它的子组件）<br></div>

</li>
</ul>
<p>如果一个 class 组件中定义了 static getDerivedStateFromError() 或 componentDidCatch() 这两个生命周期方法中的任意一个（或两个）时，那么它就变成一个错误边界。当抛出错误后，请使用 static getDerivedStateFromError() 渲染备用 UI ，使用 componentDidCatch() 打印错误信息<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> getDerivedStateFromError(error) &#123;</span><br><span class="line">    <span class="comment">// 更新 state 使下一次渲染能够显示降级后的 UI</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidCatch(error, errorInfo) &#123;</span><br><span class="line">    <span class="comment">// 你同样可以将错误日志上报给服务器</span></span><br><span class="line">    logErrorToMyService(error, errorInfo);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasError) &#123;</span><br><span class="line">      <span class="comment">// 你可以自定义降级后的 UI 并渲染</span></span><br><span class="line">      <span class="keyword">return</span> &lt;h1&gt;Something went wrong.&lt;/h1&gt;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后你可以将它作为一个常规组件去使用：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;ErrorBoundary&gt;</span><br><span class="line">  &lt;MyWidget /&gt;</span><br><span class="line">&lt;<span class="regexp">/ErrorBoundary&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>错误边界的工作方式类似于 JavaScript 的 catch {}，不同的地方在于错误边界只针对 React 组件。只有 class 组件才可以成为错误边界组件。大多数情况下, 你只需要声明一次错误边界组件, 并在整个应用中使用它。</p>
<p>注意错误边界仅可以捕获其子组件的错误，它无法捕获其自身的错误。如果一个错误边界无法渲染错误信息，则错误会冒泡至最近的上层错误边界，这也类似于 JavaScript 中 catch {} 的工作机制。</p>
<blockquote>
<p>错误边界应该放置在哪？<br>错误边界的粒度由你来决定，可以将其包装在最顶层的路由组件并为用户展示一个 “Something went wrong” 的错误信息，就像服务端框架经常处理崩溃一样。你也可以将单独的部件包装在错误边界以保护应用其他部分不崩溃。</p>
</blockquote>
<blockquote>
<p>未捕获错误（Uncaught Errors）的新行为<br>自 React 16 起，任何未被错误边界捕获的错误将会导致整个 React 组件树被卸载。</p>
</blockquote>
<blockquote>
<p>组件栈追踪<br>如果你没有使用 Create React App，可以手动将该插件(@babel/plugin-transform-react-jsx-source)添加到你的 Babel 配置中。注意它仅用于开发环境，<strong>在生产环境必须将其禁用</strong> 。</p>
</blockquote>
<blockquote>
<p>关于 try/catch ？</p>
</blockquote>
<blockquote>
<p>关于事件处理器<br>如果你需要在事件处理器内部捕获错误，使用普通的 JavaScript try / catch 语句。</p>
</blockquote>
<blockquote>
<p>自 React 15 的命名更改<br>React 15 中有一个支持有限的错误边界方法 unstable_handleError。此方法不再起作用，同时自 React 16 beta 发布起你需要在代码中将其修改为 componentDidCatch。</p>
</blockquote>
<h2 id="Refs-转发"><a href="#Refs-转发" class="headerlink" title="Refs 转发"></a>Refs 转发</h2><p>1、转发 refs 到 DOM 组件<br>  Ref 转发是一个可选特性，其允许某些组件接收 ref，并将其向下传递（换句话说，“转发”它）给子组件。</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FancyButton = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">  &lt;button ref=&#123;ref&#125; className=<span class="string">"FancyButton"</span>&gt;</span><br><span class="line">    &#123;props.children&#125;</span><br><span class="line">  &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 你可以直接获取 DOM button 的 ref：</span></span><br><span class="line"><span class="regexp">const ref = React.createRef();</span></span><br><span class="line"><span class="regexp">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/</span>FancyButton&gt;;</span><br></pre></td></tr></table></figure>
<p>  这样，使用 FancyButton 的组件可以获取底层 DOM 节点 button 的 ref ，并在必要时访问，就像其直接使用 DOM button 一样。</p>
<blockquote>
<p>以下是对上述示例发生情况的逐步解释：<br>  1）调用 React.createRef 创建了一个 React ref 并将其赋值给 ref 变量。<br>  2）指定 ref 为 JSX 属性，将其向下传递给 &lt; FancyButton ref={ref} /&gt;。<br>  3）React 传递 ref 给 forwardRef 内函数 (props, ref) =&gt; …，作为其第二个参数。<br>  4）我们向下转发该 ref 参数到 &lt; button ref={ref}&gt;，将其指定为 JSX 属性。<br>  5）当 ref 挂载完成，ref.current 将指向 &lt;button> DOM 节点。</p>
</blockquote>
  <div class="post-warning"><br>  第二个参数 ref 只在使用 React.forwardRef 定义组件时存在。常规函数和 class 组件不接收 ref 参数，且 props 中也不存在 ref。<br><br>  Ref 转发不仅限于 DOM 组件，你也可以转发 refs 到 class 组件实例中。<br>  </div>

<p>2、组件库维护者的注意事项<br>当你开始在组件库中使用 forwardRef 时，你应当将其视为一个破坏性更改，并发布库的一个新的主版本</p>
<p>3、在高阶组件中转发 refs<br>在 DevTools 中显示自定义名称</p>
<h2 id="Fragments"><a href="#Fragments" class="headerlink" title="Fragments"></a>Fragments</h2><p>  用法<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Columns</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;React.Fragment&gt;</span><br><span class="line">        &lt;td&gt;Hello&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;td&gt;World&lt;/</span>td&gt;</span><br><span class="line">      &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>  短语法<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Columns</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;td&gt;Hello&lt;<span class="regexp">/td&gt;</span></span><br><span class="line"><span class="regexp">        &lt;td&gt;World&lt;/</span>td&gt;</span><br><span class="line">      &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<pre><code>你可以像使用任何其他元素一样使用 &lt;&gt; &lt;/&gt;，除了它不支持 key 或属性。
</code></pre><blockquote>
<p>带 key 的 Fragments<br>    key 是唯一可以传递给 Fragment 的属性。未来我们可能会添加对其他属性的支持，例如事件。</p>
</blockquote>
<h2 id="高阶组件"><a href="#高阶组件" class="headerlink" title="高阶组件"></a>高阶组件</h2><ol>
<li><p><strong>使用 HOC 解决横切关注点问题</strong></p>
<blockquote>
<p>高阶组件（HOC higherOrderComponent）是 React 中用于复用组件逻辑的一种高级技巧。HOC 自身不是 React API 的一部分，它是一种基于 React 的组合特性而形成的设计模式。<br> 具体而言，高阶组件是参数为组件，返回值为新组件的函数。</p>
</blockquote>
<p> 我们在一个地方定义这个逻辑，并在许多组件之间共享它。这正是高阶组件擅长的地方<br> 请注意，HOC 不会修改传入的组件，也不会使用继承来复制其行为。相反，HOC 通过将组件包装在容器组件中来组成新组件。HOC 是纯函数，没有副作用。</p>
</li>
<li><p><strong>不要改变原始组件，使用组合。</strong></p>
<blockquote>
<p>HOC 与容器组件模式之间有相似之处。容器组件担任分离高层和低层关注的责任，由容器管理订阅状态，并将prop传递给渲染UI。HOC使用容器作为其实现的一部分，可以将HOC视为参数化容器组件。</p>
</blockquote>
</li>
<li><p><strong>约定：将不相关的 props 传递给被包裹的组件</strong></p>
</li>
<li><p><strong>约定：最大化可组合性</strong><br>最常见的 HOC 签名如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React Redux 的 `connect` 函数</span></span><br><span class="line"><span class="keyword">const</span> ConnectedComment = connect(commentSelector, commentActions)(CommentList);</span><br></pre></td></tr></table></figure>
<p>刚刚发生了什么？！如果你把它分开，就会更容易看出发生了什么。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// connect 是一个函数，它的返回值为另外一个函数。</span></span><br><span class="line"><span class="keyword">const</span> enhance = connect(commentListSelector, commentListActions);</span><br><span class="line"><span class="comment">// 返回值为 HOC，它会返回已经连接 Redux store 的组件</span></span><br><span class="line"><span class="keyword">const</span> ConnectedComment = enhance(CommentList);</span><br></pre></td></tr></table></figure>
<p>换句话说，connect 是一个返回高阶组件的高阶函数！</p>
</li>
<li><p><strong>约定：包装显示名称以便轻松调试</strong></p>
</li>
<li><p><strong>注意事项</strong></p>
<ol>
<li>不要在 render 方法中使用 HOC</li>
<li>务必复制静态方法</li>
<li>Refs 不会被传递</li>
</ol>
</li>
</ol>
<h2 id="与第三方库协同"><a href="#与第三方库协同" class="headerlink" title="与第三方库协同"></a>与第三方库协同</h2><p>mark</p>
<h2 id="深入-JSX"><a href="#深入-JSX" class="headerlink" title="深入 JSX"></a>深入 JSX</h2><p>  实际上，JSX 仅仅只是 React.createElement(component, props, …children) 函数的语法糖：<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;MyButton color=<span class="string">"blue"</span> shadowSize=&#123;<span class="number">2</span>&#125;&gt;</span><br><span class="line">  Click Me</span><br><span class="line">&lt;<span class="regexp">/MyButton&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">会编译为：</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">React.createElement(</span></span><br><span class="line"><span class="regexp">  MyButton,</span></span><br><span class="line"><span class="regexp">  &#123;color: 'blue', shadowSize: 2&#125;,</span></span><br><span class="line"><span class="regexp">  'Click Me'</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure></p>
<h3 id="指定-React-元素类型"><a href="#指定-React-元素类型" class="headerlink" title="指定 React 元素类型"></a>指定 React 元素类型</h3><ol>
<li><p>React 必须在作用域内</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> CustomButton <span class="keyword">from</span> <span class="string">'./CustomButton'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WarningButton</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// return React.createElement(CustomButton, &#123;color: 'red'&#125;, null);</span></span><br><span class="line">  <span class="keyword">return</span> &lt;CustomButton color="red" /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 JSX 类型中使用点语法<br>在 JSX 中，你也可以使用点语法来引用一个 React 组件。当你在一个模块中导出许多 React 组件时，这会非常方便。例如，如果 MyComponents.DatePicker 是一个组件，你可以在 JSX 中直接使用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyComponents = &#123;</span><br><span class="line">  DatePicker: <span class="function"><span class="keyword">function</span> <span class="title">DatePicker</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;div&gt;Imagine a &#123;props.color&#125; datepicker here.&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BlueDatePicker</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;MyComponents.DatePicker color="blue" /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>用户定义的组件必须以大写字母开头</p>
</li>
<li><p>在运行时选择类型<br>如果你想通过通用表达式来（动态）决定元素类型，你需要首先将它赋值给大写字母开头的变量。这通常用于根据 prop 来渲染不同组件的情况下:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; PhotoStory, VideoStory &#125; <span class="keyword">from</span> <span class="string">'./stories'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> components = &#123;</span><br><span class="line">  photo: PhotoStory,</span><br><span class="line">  video: VideoStory</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Story</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 正确！JSX 类型可以是大写字母开头的变量。</span></span><br><span class="line">  <span class="keyword">const</span> SpecificStory = components[props.storyType];</span><br><span class="line">  <span class="keyword">return</span> &lt;SpecificStory story=&#123;props.story&#125; /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="JSX-中的-Props"><a href="#JSX-中的-Props" class="headerlink" title="JSX 中的 Props"></a>JSX 中的 Props</h3><ol>
<li><p>JavaScript 表达式作为 Props</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MyComponent foo=&#123;<span class="number">1</span> + <span class="number">2</span> + <span class="number">3</span> + <span class="number">4</span>&#125; /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>字符串字面量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;MyComponent message=<span class="string">"hello world"</span> /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Props 默认值为 “True”<br>如果你没给 prop 赋值，它的默认值是 true。以下两个 JSX 表达式是等价的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;MyTextBox autocomplete /&gt;</span><br><span class="line"></span><br><span class="line">&lt;MyTextBox autocomplete=&#123;<span class="literal">true</span>&#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>通常，不建议不传递 value 给 prop，因为这可能与 ES6 对象简写混淆，{foo} 是 {foo: foo} 的简写，而不是 {foo: true}。这样实现只是为了保持和 HTML 中标签属性的行为一致。</p>
</li>
<li><p>属性展开<br>如果已经有了一个 props 对象，你可以使用展开运算符 … 来在 JSX 中传递整个 props 对象。以下两个组件是等价的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;Greeting firstName="Ben" lastName="Hector" /&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function App2() &#123;</span><br><span class="line">  const props = &#123;firstName: 'Ben', lastName: 'Hector'&#125;;</span><br><span class="line">  return &lt;Greeting &#123;...props&#125; /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>还可以选择只保留当前组件需要接收的 props，并使用展开运算符将其他 props 传递下去。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Button = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; kind, ...other &#125; = props;</span><br><span class="line">  <span class="keyword">const</span> className = kind === <span class="string">"primary"</span> ? <span class="string">"PrimaryButton"</span> : <span class="string">"SecondaryButton"</span>;</span><br><span class="line">  <span class="keyword">return</span> &lt;button className=&#123;className&#125; &#123;...other&#125; /&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const App = () =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Button kind="primary" onClick=&#123;() =&gt; console.log("clicked!")&#125;&gt;</span><br><span class="line">        Hello World!</span><br><span class="line">      &lt;/Button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="JSX-中的子元素"><a href="#JSX-中的子元素" class="headerlink" title="JSX 中的子元素"></a>JSX 中的子元素</h3><pre><code>字符串字面量
JSX 子元素
JavaScript 表达式作为子元素
函数作为子元素
布尔类型、Null 以及 Undefined 将会忽略
</code></pre><h2 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h2><p><strong>避免调停</strong><br>即使 React 只更新改变了的 DOM 节点，重新渲染仍然花费了一些时间。在大部分情况下它并不是问题，不过如果它已经慢到让人注意了，你可以通过覆盖生命周期方法 shouldComponentUpdate 来进行提速。该方法会在重新渲染前被触发。其默认实现总是返回 true，让 React 执行更新：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果你知道在什么情况下你的组件不需要更新，你可以在 shouldComponentUpdate 中返回 false 来跳过整个渲染过程。其包括该组件的 render 调用以及之后的操作。</p>
<p>在大部分情况下，你可以继承 React.PureComponent 以代替手写 shouldComponentUpdate()。它用当前与之前 props 和 state 的浅比较覆写了 shouldComponentUpdate() 的实现。</p>
<p><strong>不可变数据的力量</strong><br>  concat、扩展运算符、Object.assign</p>
<p>  避免更改你正用于 props 或 state 的值:<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">handleClick() &#123;</span><br><span class="line">  <span class="keyword">this</span>.setState(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">    words: state.words.concat([<span class="string">'marklar'</span>])</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;</span><br><span class="line">ES6 数组支持扩展运算符，这让代码写起来更方便了。如果你在使用 Create React App，该语法已经默认支持了。</span><br><span class="line"></span><br><span class="line">handleClick() &#123;</span><br><span class="line">  <span class="keyword">this</span>.setState(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">    words: [...state.words, <span class="string">'marklar'</span>],</span><br><span class="line">  &#125;));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>  你可以用类似的方式改写代码来避免可变对象的产生。例如，我们有一个叫做 colormap 的对象。我们希望写一个方法来将 colormap.right 设置为 ‘blue’。我们可以这么写：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateColorMap</span>(<span class="params">colormap</span>) </span>&#123;</span><br><span class="line">  colormap.right = <span class="string">'blue'</span>;</span><br><span class="line">&#125;</span><br><span class="line">为了不改变原本的对象，我们可以使用 <span class="built_in">Object</span>.assign 方法：</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateColorMap</span>(<span class="params">colormap</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;, colormap, &#123;<span class="attr">right</span>: <span class="string">'blue'</span>&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Portals"><a href="#Portals" class="headerlink" title="Portals"></a>Portals</h2><p>  Portal 提供了一种将子节点渲染到存在于父组件以外的 DOM 节点的优秀的方案。<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ReactDOM.createPortal(child, container)</span><br><span class="line">第一个参数（child）是任何可渲染的 React 子元素，例如一个元素，字符串或 fragment。第二个参数（container）是一个 DOM 元素。</span><br></pre></td></tr></table></figure></p>
<p>  <strong>用法</strong><br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="comment">// React 并*没有*创建一个新的 div。它只是把子元素渲染到 `domNode` 中。</span></span><br><span class="line">  <span class="comment">// `domNode` 是一个可以在任何位置的有效 DOM 节点。</span></span><br><span class="line">  <span class="keyword">return</span> ReactDOM.createPortal(</span><br><span class="line">    <span class="keyword">this</span>.props.children,</span><br><span class="line">    domNode</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  一个 portal 的典型用例是当父组件有 overflow: hidden 或 z-index 样式时，但你需要子组件能够在视觉上“跳出”其容器。例如，对话框、悬浮卡以及提示框：<br>  <div class="post-warning">当在使用 portal 时, 记住管理键盘焦点就变得尤为重要。<br>    对于模态对话框，通过遵循 WAI-ARIA 模态开发实践，来确保每个人都能够运用它<br>  </div></p>
<p>  <strong>通过 Portal 进行事件冒泡</strong></p>
<h2 id="Profiler-API"><a href="#Profiler-API" class="headerlink" title="Profiler API"></a>Profiler API</h2><p>  Profiler 测量渲染一个 React 应用多久渲染一次以及渲染一次的“代价”。 它的目的是识别出应用中渲染较慢的部分，或是可以使用类似 memoization 优化的部分，并从相关优化中获益。</p>
<h2 id="不使用-ES6"><a href="#不使用-ES6" class="headerlink" title="不使用 ES6"></a>不使用 ES6</h2><p>  如果你还未使用过 ES6，你可以使用 create-react-class 模块：<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> createReactClass = <span class="built_in">require</span>(<span class="string">'create-react-class'</span>);</span><br><span class="line"><span class="keyword">var</span> Greeting = createReactClass(&#123;</span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &lt;h1&gt;Hello, &#123;this.props.name&#125;&lt;/h1&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>  ES6 中的 class 与 createReactClass() 方法十分相似，但有以下几个区别值得注意:</p>
<ol>
<li><p>声明默认属性<br> 无论是函数组件还是 class 组件，都拥有 defaultProps 属性：</p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeting</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Greeting.defaultProps = &#123;</span><br><span class="line">  name: <span class="string">'Mary'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">如果使用 createReactClass() 方法创建组件，那就需要在组件中定义 getDefaultProps() 函数：</span><br><span class="line"><span class="keyword">var</span> Greeting = createReactClass(&#123;</span><br><span class="line">  getDefaultProps: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      name: <span class="string">'Mary'</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化 State</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果使用 ES6 的 class 关键字创建组件，你可以通过给 this.state 赋值的方式来定义组件的初始 state：</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">count</span>: props.initialCount&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果使用 createReactClass() 方法创建组件，你需要提供一个单独的 getInitialState 方法，让其返回初始 state：</span></span><br><span class="line"><span class="keyword">var</span> Counter = createReactClass(&#123;</span><br><span class="line">  getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">count</span>: <span class="keyword">this</span>.props.initialCount&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>自动绑定<br>对于使用 ES6 的 class 关键字创建的 React 组件，组件中的方法遵循与常规 ES6 class 相同的语法规则。这意味着这些方法不会自动绑定 this 到这个组件实例。 你需要在 constructor 中显式地调用 .bind(this)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SayHello</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Hello!'</span>&#125;;</span><br><span class="line">    <span class="comment">// 这一行很重要！</span></span><br><span class="line">    <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClick() &#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.state.message);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 由于 `this.handleClick` 已经绑定至实例，因此我们才可以用它来处理点击事件</span></span><br><span class="line">    <span class="keyword">return</span> (&lt;button onClick=&#123;this.handleClick&#125;&gt;Say hello&lt;/button&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果使用 createReactClass() 方法创建组件，组件中的方法会自动绑定至实例，所以不需要像上面那样做：</span></span><br><span class="line"><span class="keyword">var</span> SayHello = createReactClass(&#123;</span><br><span class="line">  getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">message</span>: <span class="string">'Hello!'</span>&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  handleClick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.state.message);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (&lt;button onClick=&#123;this.handleClick&#125;&gt;</span><br><span class="line">        Say hello</span><br><span class="line">      &lt;/button&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="不使用-JSX-的-React"><a href="#不使用-JSX-的-React" class="headerlink" title="不使用 JSX 的 React"></a>不使用 JSX 的 React</h2><blockquote>
<p>React 并不强制要求使用 JSX。当你不想在构建环境中配置有关 JSX 编译时，不在 React 中使用 JSX 会更加方便。<br>每个 JSX 元素只是调用 React.createElement(component, props, …children) 的语法糖。因此，使用 JSX 可以完成的任何事情都可以通过纯 JavaScript 完成。</p>
</blockquote>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> React.createElement(<span class="string">'div'</span>, <span class="literal">null</span>, <span class="string">`Hello <span class="subst">$&#123;<span class="keyword">this</span>.props.toWhat&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  React.createElement(Hello, &#123;<span class="attr">toWhat</span>: <span class="string">'World'</span>&#125;, <span class="literal">null</span>),</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="协调"><a href="#协调" class="headerlink" title="协调"></a>协调</h2><p>  React 在以下两个假设的基础之上提出了一套 O(n) 的启发式算法：</p>
<ol>
<li>两个不同类型的元素会产生出不同的树；</li>
<li><p>开发者可以通过 key prop 来暗示哪些子元素在不同的渲染下能保持稳定；</p>
<p><strong>Diffing 算法</strong><br> 比对不同类型的元素<br> 比对同一类型的元素<br> 比对同类型的组件元素<br> 对子节点进行递归<br> Keys<br> 权衡</p>
</li>
</ol>
<h2 id="Refs-and-the-DOM"><a href="#Refs-and-the-DOM" class="headerlink" title="Refs and the DOM"></a>Refs and the DOM</h2><p>  <strong>何时使用 Refs</strong><br>    管理焦点，文本选择或媒体播放。<br>    触发强制动画。<br>    集成第三方 DOM 库。</p>
<p>  <strong>勿过度使用</strong></p>
<p>  <code>创建 Refs</code>：Refs 是使用 React.createRef() 创建的，并通过 ref 属性附加到 React 元素。</p>
<p>  <code>访问 Refs</code>：当 ref 被传递给 render 中的元素时，对该节点的引用可以在 ref 的 current 属性中被访问。<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> node = <span class="keyword">this</span>.myRef.current;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>为 DOM 元素添加 ref</li>
<li>为 class 组件添加 Ref<br> 请注意，这仅在 CustomTextInput 声明为 class 时才有效<br> 不能在函数组件上使用 ref 属性，因为他们没有实例。</li>
<li><p>Refs 与函数组件<br>如果要在函数组件中使用 ref，你可以使用 forwardRef（可与 useImperativeHandle 结合使用），或者可以将该组件转化为 class 组件。</p>
<p>不管怎样，你可以在函数组件内部使用 ref 属性，只要它指向一个 DOM 元素或 class 组件：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CustomTextInput</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 这里必须声明 textInput，这样 ref 才可以引用它</span></span><br><span class="line">  <span class="keyword">const</span> textInput = useRef(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    textInput.current.focus();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (&lt;div&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type="text"</span><br><span class="line">        ref=&#123;textInput&#125; /&gt;</span><br><span class="line">      &lt;input</span><br><span class="line">        type="button"</span><br><span class="line">        value="Focus the text input"</span><br><span class="line">        onClick=&#123;handleClick&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>将 DOM Refs 暴露给父组件</strong></p>
<p><strong>回调 Refs</strong></p>
<p><strong>过时 API：String 类型的 Refs</strong></p>
<p><strong>关于回调 refs 的说明</strong></p>
</li>
</ol>
<h2 id="Render-Props"><a href="#Render-Props" class="headerlink" title="Render Props"></a>Render Props</h2><ol>
<li><p>使用 Render Props 来解决横切关注点（Cross-Cutting Concerns）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果你出于某种原因真的想要 HOC，那么你可以轻松实现</span></span><br><span class="line"><span class="comment">// 使用具有 render prop 的普通组件创建一个！</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">withMouse</span>(<span class="params">Component</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;Mouse render=&#123;mouse =&gt; (</span><br><span class="line">          &lt;Component &#123;...this.props&#125; mouse=&#123;mouse&#125; /&gt;</span><br><span class="line">        )&#125;/&gt;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 Props 而非 render</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 尽管之前的例子使用了 render，我们也可以简单地使用 children prop！</span></span><br><span class="line">&lt;Mouse children=&#123;mouse =&gt; (</span><br><span class="line">  &lt;p&gt;鼠标的位置是 &#123;mouse.x&#125;，&#123;mouse.y&#125;&lt;/p&gt;</span><br><span class="line">)&#125;/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 记住，children prop 并不真正需要添加到 JSX 元素的 “attributes” 列表中。相反，你可以直接放置到元素的内部！</span></span><br><span class="line">&lt;Mouse&gt;</span><br><span class="line">  &#123;mouse =&gt; (</span><br><span class="line">    &lt;p&gt;鼠标的位置是 &#123;mouse.x&#125;，&#123;mouse.y&#125;&lt;/p&gt;</span><br><span class="line">  )&#125;</span><br><span class="line">&lt;/Mouse&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 你将在 react-motion 的 API 中看到此技术。</span></span><br><span class="line"><span class="comment"># 由于这一技术的特殊性，当你在设计一个类似的 API 时，你或许会要直接地在你的 propTypes 里声明 children 的类型应为一个函数。</span></span><br><span class="line">Mouse.propTypes = &#123;</span><br><span class="line">  children: PropTypes.func.isRequired</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>注意事项：将 Render Props 与 React.PureComponent 一起使用时要小心</p>
</li>
</ol>
<h2 id="静态类型检查"><a href="#静态类型检查" class="headerlink" title="静态类型检查"></a>静态类型检查</h2><p>  像 Flow 和 TypeScript 等这些静态类型检查器，可以在运行前识别某些类型的问题。他们还可以通过增加自动补全等功能来改善开发者的工作流程。出于这个原因，我们建议在大型代码库中使用 Flow 或 TypeScript 来代替 PropTypes。</p>
<p>  <code>Flow</code> 是一个针对 JavaScript 代码的静态类型检测器</p>
<p>  <code><a href="https://www.typescriptlang.org/" target="_blank" rel="noopener">TypeScript</a></code> 是一种由微软开发的编程语言。它是 JavaScript 的一个类型超集，包含独立的编译器。作为一种类型语言，TypeScript 可以在构建时发现 bug 和错误，这样程序运行时就可以避免此类错误。</p>
<p>  <code>Reason</code> 不是一种新的语言；它是一种新的语法和工具链，底层使用的是经过实战验证的 OCaml 语言。Reason 在 OCaml 之上提供了 JavaScript 程序员的熟悉语法，而且集成了现有的 NPM/Yarn 工作流。</p>
<p>  <code>Kotlin</code> 是由 JetBrains 开发的一门静态类型语言。其目标平台包括 JVM、Android、LLVM 和 JavaScript。</p>
<p>  <code>其他语言</code> 还有其他静态类型语言可以编译成 JavaScript，也与 React 兼容。例如，和 elmish-react 一起使用的 F#/Fable。</p>
<h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2><p>  StrictMode 是一个用来突出显示应用程序中潜在问题的工具。与 Fragment 一样，StrictMode 不会渲染任何可见的 UI。它为其后代元素触发额外的检查和警告。<br>  <div class="post-warning">严格模式检查仅在开发模式下运行；它们不会影响生产构建。</div></p>
<p>  识别不安全的生命周期</p>
<p>  关于使用过时字符串 ref API 的警告</p>
<p>  关于使用废弃的 findDOMNode 方法的警告</p>
<p>  检测意外的副作用</p>
<p>  检测过时的 context API</p>
<h2 id="使用-PropTypes-进行类型检查"><a href="#使用-PropTypes-进行类型检查" class="headerlink" title="使用 PropTypes 进行类型检查"></a>使用 PropTypes 进行类型检查</h2><h2 id="非受控组件"><a href="#非受控组件" class="headerlink" title="非受控组件"></a>非受控组件</h2><p>  默认值 defaultValue</p>
<p>  文件输入</p>
<h2 id="Web-Components"><a href="#Web-Components" class="headerlink" title="Web Components"></a>Web Components</h2><p><br><br><br><br><br></p>
<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><blockquote>
<p>React 是 React 库的入口。<br>  使用 &lt; script&gt; 标签的方式来加载React时，则可以通过React全局变量对象来获得React的顶层 API。<br>  使用 ES6 与 npm 时，可以通过编写 import React from ‘react’; 来引入它们。<br>  使用 ES5 与 npm 时，则可以通过编写 var React = require(‘react’); 来引入它们。</p>
</blockquote>
<ol>
<li><p>组件<br> React.Component<br> React.PureComponent<br> create-react-class<br> React.memo</p>
<blockquote>
<p>React.PureComponent 与 React.Component 很相似。两者的区别在于 React.Component 并未实现 shouldComponentUpdate()，而 React.PureComponent 中以浅层对比 prop 和 state 的方式来实现了该函数。也可以考虑使用 <code>immutable</code> 对象加速嵌套数据的比较。<br>此外，React.PureComponent 中的 shouldComponentUpdate() 将跳过所有子组件树的 prop 更新。因此，请确保所有子组件也都是“纯”的组件。</p>
</blockquote>
</li>
<li><p>创建React元素<br>JSX<br>createElement()<br>createFactory()</p>
</li>
<li><p>转换元素<br>cloneElement()<br>isValidElement()<br>React.Children</p>
<blockquote>
<p>React.isValidElement(object)<br> 验证对象是否为 React 元素，返回值为 true 或 false。</p>
</blockquote>
<blockquote>
<p>React.Children.map(children, function[(thisArg)])<br> 注意:如果 children 是一个 Fragment 对象，它将被视为单一子节点的情况处理，而不会被遍历。<br> React.Children.forEach<br> React.Children.count, 返回 children 中的组件总数量。<br> React.Children.only, 验证 children 是否只有一个子节点（一个 React 元素），如果有则返回它，否则此方法会抛出错误。<br> React.Children.toArray</p>
</blockquote>
</li>
<li><p>Fragments<br>React.Fragment</p>
</li>
<li><p>Refs<br>React.createRef<br>React.forwardRef</p>
<blockquote>
<p>React.forwardRef 会创建一个React组件，这个组件能够将其接受的 ref 属性转发到其组件树下的另一个组件中。这种技术并不常见，但在以下两种场景中特别有用：</p>
</blockquote>
<p>转发 refs 到 DOM 组件<br>在高阶组件中转发 refs<br>React.forwardRef 接受渲染函数作为参数。React 将使用 props 和 ref 作为参数来调用此函数。此函数应返回 React 节点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> FancyButton = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">  &lt;button ref=&#123;ref&#125; className=<span class="string">"FancyButton"</span>&gt;</span><br><span class="line">    &#123;props.children&#125;</span><br><span class="line">  &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ You can now get a ref directly to the DOM button:</span></span><br><span class="line"><span class="regexp">const ref = React.createRef();</span></span><br><span class="line"><span class="regexp">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/</span>FancyButton&gt;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Suspense<br>Suspense 使得组件可以“等待”某些操作结束后，再进行渲染。目前，Suspense 仅支持的使用场景是：通过 React.lazy 动态加载组件。它将在未来支持其它使用场景，如数据获取等。</p>
<p>React.lazy<br>React.Suspense</p>
<p>React.Suspense 可以指定加载指示器（loading indicator），以防其组件树中的某些子组件尚未具备渲染条件。目前，懒加载组件是 &lt;React.Suspense&gt; 支持的唯一用例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 该组件是动态加载的</span><br><span class="line">const OtherComponent = React.lazy(() =&gt; import(<span class="string">'./OtherComponent'</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">MyComponent</span></span>() &#123;</span><br><span class="line">  <span class="built_in">return</span> (</span><br><span class="line">    // 显示 &lt;Spinner&gt; 组件直至 OtherComponent 加载完成</span><br><span class="line">    &lt;React.Suspense fallback=&#123;&lt;Spinner /&gt;&#125;&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;OtherComponent /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/React.Suspense&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Hook<br>Hook 是 React 16.8 的新增特性。可以在不编写 class 的情况下使用 state 以及其他的 React 特性。</p>
<p><strong>基础 Hook</strong><br> useState<br> useEffect<br> useContext</p>
<p><strong>额外的 Hook</strong><br> useReducer<br> useCallback<br> useMemo<br> useRef<br> useImperativeHandle<br> useLayoutEffect<br> useDebugValue</p>
</li>
</ol>
<h2 id="组件的生命周期"><a href="#组件的生命周期" class="headerlink" title="组件的生命周期"></a>组件的生命周期</h2><h3 id="1-生命周期图谱"><a href="#1-生命周期图谱" class="headerlink" title="1. 生命周期图谱"></a>1. 生命周期图谱</h3><p>  <img src="../../../../images/lifeCycleA.png"><br>  <img src="../../../../images/lifeCycleB.png"></p>
<h3 id="2-常用的生命周期方法"><a href="#2-常用的生命周期方法" class="headerlink" title="2. 常用的生命周期方法"></a>2. 常用的生命周期方法</h3><p>  <code>constructor()</code> 如果不初始化 state 或不进行方法绑定，则不需要为 React 组件实现构造函数。<br>  在其他语句之前调用 super(props)</p>
<p>  通常，在 React 中，构造函数仅用于以下两种情况：</p>
<ol>
<li>通过给 this.state 赋值对象来初始化内部 state。</li>
<li>为事件处理函数绑定实例<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">  <span class="keyword">super</span>(props);</span><br><span class="line">  <span class="comment">// 不要在这里调用 this.setState()</span></span><br><span class="line">  <span class="keyword">this</span>.state = &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;;</span><br><span class="line">  <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><code>componentDidMount</code> 在组件挂载后（插入 DOM 树中）立即调用。依赖于 DOM 节点的初始化应该放在这里。如需通过网络请求获取数据，此处是实例化请求的好地方。</p>
<p>你可以在 componentDidMount() 里直接调用 setState()。它将触发额外渲染，但此渲染会发生在浏览器更新屏幕之前。如此保证了即使在 render() 两次调用的情况下，用户也不会看到中间状态。请谨慎使用该模式，因为它会导致性能问题。通常，你应该在 constructor() 中初始化 state。如果你的渲染依赖于 DOM 节点的大小或位置，比如实现 modals 和 tooltips 等情况下，你可以使用此方式处理。</p>
<p><code>componentDidUpdate</code> (prevProps, prevState, snapshot)<br>当组件更新后，可以在此处对 DOM 进行操作。如果你对更新前后的 props 进行了比较，也可以选择在此处进行网络请求。（例如，当 props 未发生变化时，则不会执行网络请求）。</p>
<p>你也可以在 componentDidUpdate() 中直接调用 setState()，但请注意它必须被包裹在一个条件语句里，正如上述的例子那样进行处理，否则会导致死循环。它还会导致额外的重新渲染，虽然用户不可见，但会影响组件性能。不要将 props “镜像”给 state，请考虑直接使用 props。</p>
<p>如果组件实现了 getSnapshotBeforeUpdate() 生命周期（不常用），则它的返回值将作为 componentDidUpdate() 的第三个参数 “snapshot” 参数传递。否则此参数将为 undefined。</p>
<p>如果shouldComponentUpdate()返回值为false，则不会调用componentDidUpdate()。</p>
<p><code>componentWillUnmount()</code><br>componentWillUnmount() 会在组件卸载及销毁之前直接调用。在此方法中执行必要的清理操作，例如，清除 timer，取消网络请求或清除在 componentDidMount() 中创建的订阅等。<br>componentWillUnmount() 中不应调用 setState()，因为该组件将永远不会重新渲染。组件实例卸载后，将永远不会再挂载它。</p>
<h3 id="3-不常用的生命周期方法"><a href="#3-不常用的生命周期方法" class="headerlink" title="3. 不常用的生命周期方法"></a>3. 不常用的生命周期方法</h3><p>  <code>shouldComponentUpdate</code></p>
<p>  <code>getDerivedStateFromProps</code>会在调用 render 方法之前调用，并且在初始挂载及后续更新时都会被调用。它应返回一个对象来更新 state，如果返回 null 则不更新任何内容。</p>
<p>  <code>getSnapshotBeforeUpdate()</code><br>    getSnapshotBeforeUpdate() 在最近一次渲染输出（提交到 DOM 节点）之前调用。它使得组件能在发生更改之前从 DOM 中捕获一些信息（例如，滚动位置）。此生命周期的任何返回值将作为参数传递给 componentDidUpdate()。<br>    此用法并不常见，但它可能出现在 UI 处理中，如需要以特殊方式处理滚动位置的聊天线程等。<br>    应返回 snapshot 的值（或 null）。</p>
<p>  <code>Error boundaries</code><br>    Error boundaries 是 React 组件，它会在其子组件树中的任何位置捕获 JavaScript 错误，并记录这些错误，展示降级 UI 而不是崩溃的组件树。Error boundaries 组件会捕获在渲染期间，在生命周期方法以及其整个树的构造函数中发生的错误。<br>    如果 class 组件定义了生命周期方法 static getDerivedStateFromError() 或 componentDidCatch() 中的任何一个（或两者），它就成为了 Error boundaries。通过生命周期更新 state 可让组件捕获树中未处理的 JavaScript 错误并展示降级 UI。<br>    仅使用 Error boundaries 组件来从意外异常中恢复的情况；不要将它们用于流程控制。</p>
<p>  <code>static getDerivedStateFromError()</code><br>    此生命周期会在后代组件抛出错误后被调用。 它将抛出的错误作为参数，并返回一个值以更新 state<br>    <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">object</span>, <span class="title">IState</span>&gt; </span>&#123;</span><br><span class="line">  public <span class="keyword">static</span> getDerivedStateFromError() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(props: object) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      hasError: <span class="literal">false</span>,</span><br><span class="line">      errorMessage: <span class="string">''</span>,</span><br><span class="line">      errorInfo: <span class="string">''</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public componentDidCatch(error: any, <span class="attr">info</span>: any) &#123;</span><br><span class="line">    <span class="comment">// 错误上报</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      errorMessage: error,</span><br><span class="line">      errorInfo: info,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  public render() &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasError) &#123;</span><br><span class="line">      <span class="keyword">return</span> (&lt;&gt;</span><br><span class="line">        &lt;h1&gt;Something went wrong.&lt;/h1&gt;</span><br><span class="line">        &lt;h2&gt;&#123; this.state.errorMessage.toString() &#125;&lt;/h2&gt;</span><br><span class="line">        &lt;pre&gt;&#123; this.state.errorInfo &amp;&amp; this.state.errorInfo.componentStack &#125;&lt;/pre&gt;</span><br><span class="line">      &lt;/&gt;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return this.props.children;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  <code>componentDidCatch()</code></p>
<h3 id="4-其他-API"><a href="#4-其他-API" class="headerlink" title="4. 其他 API"></a>4. 其他 API</h3><p>  setState()<br>  forceUpdate()</p>
<h3 id="5-Class-属性"><a href="#5-Class-属性" class="headerlink" title="5. Class 属性"></a>5. Class 属性</h3><p>  defaultProps<br>  displayName</p>
<h3 id="6-实例属性"><a href="#6-实例属性" class="headerlink" title="6. 实例属性"></a>6. 实例属性</h3><p>  props<br>  state</p>
<h2 id="React-DOM"><a href="#React-DOM" class="headerlink" title="React DOM"></a>React DOM</h2><p>  react-dom 的 package 提供了可在应用顶层使用的 DOM（DOM-specific）方法，如果有需要，你可以把这些方法用于 React 模型以外的地方。不过一般情况下，大部分组件都不需要使用这个模块。</p>
<p>  render()<br>  hydrate()<br>  unmountComponentAtNode()<br>  findDOMNode()<br>  createPortal()</p>
<h2 id="ReactDOMServer"><a href="#ReactDOMServer" class="headerlink" title="ReactDOMServer"></a>ReactDOMServer</h2><p>  下述方法可以被使用在服务端和浏览器环境。</p>
<p>  renderToString()<br>  renderToStaticMarkup()<br>  下述附加方法依赖一个只能在服务端使用的 package（stream）。它们在浏览器中不起作用。</p>
<p>  renderToNodeStream()<br>  renderToStaticNodeStream()</p>
<h2 id="DOM元素"><a href="#DOM元素" class="headerlink" title="DOM元素"></a>DOM元素</h2><h3 id="属性差异"><a href="#属性差异" class="headerlink" title="属性差异"></a>属性差异</h3><ul>
<li>checked</li>
<li>className</li>
<li><p>dangerouslySetInnerHTML<br>dangerouslySetInnerHTML 是 React 为浏览器 DOM 提供 innerHTML 的替换方案。通常来讲，使用代码直接设置 HTML 存在风险，因为很容易无意中使用户暴露于跨站脚本（XSS）的攻击。因此，你可以直接在 React 中设置 HTML，但当你想设置 dangerouslySetInnerHTML 时，需要向其传递包含 key 为 __html 的对象，以此来警示你。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMarkup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">__html</span>: <span class="string">'First &amp;middot; Second'</span>&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &lt;div dangerouslySetInnerHTML=&#123;createMarkup()&#125; /&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>htmlFor</p>
</li>
<li>onChange</li>
<li>selected</li>
<li>style</li>
<li>suppressContentEditableWarning</li>
<li>suppressHydrationWarning</li>
<li><p>value</p>
<h3 id="All-Supported-HTML-Attributes"><a href="#All-Supported-HTML-Attributes" class="headerlink" title="All Supported HTML Attributes"></a>All Supported HTML Attributes</h3></li>
</ul>
<h2 id="合成事件"><a href="#合成事件" class="headerlink" title="合成事件"></a>合成事件</h2><h3 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h3><p>  SyntheticEvent 实例将被传递给你的事件处理函数，它是浏览器的原生事件的跨浏览器包装器。除兼容所有浏览器外，它还拥有和浏览器原生事件相同的接口，包括 stopPropagation() 和 preventDefault()。</p>
<p>  如果因为某些原因，当你需要使用浏览器的底层事件时，只需要使用 nativeEvent 属性来获取即可。每个 SyntheticEvent 对象都包含以下属性：</p>
<p>  boolean bubbles<br>  boolean cancelable<br>  DOMEventTarget currentTarget<br>  boolean defaultPrevented<br>  number eventPhase<br>  boolean isTrusted<br>  DOMEvent nativeEvent<br>  void preventDefault()<br>  boolean isDefaultPrevented()<br>  void stopPropagation()<br>  boolean isPropagationStopped()<br>  void persist()<br>  DOMEventTarget target<br>  number timeStamp<br>  string type</p>
<h3 id="事件池"><a href="#事件池" class="headerlink" title="事件池"></a>事件池</h3><p>  SyntheticEvent 是合并而来。这意味着 SyntheticEvent 对象可能会被重用，而且在事件回调函数被调用后，所有的属性都会无效。出于性能考虑，你不能通过异步访问事件。</p>
<h3 id="支持的事件"><a href="#支持的事件" class="headerlink" title="支持的事件"></a>支持的事件</h3><h4 id="剪贴板事件"><a href="#剪贴板事件" class="headerlink" title="剪贴板事件"></a>剪贴板事件</h4><p>事件名：onCopy onCut onPaste<br>属性: DOMDataTransfer clipboardData</p>
<h4 id="复合事件"><a href="#复合事件" class="headerlink" title="复合事件"></a>复合事件</h4><p>事件名: onCompositionEnd onCompositionStart onCompositionUpdate<br>属性: string data</p>
<h4 id="键盘事件"><a href="#键盘事件" class="headerlink" title="键盘事件"></a>键盘事件</h4><p>事件名: onKeyDown onKeyPress onKeyUp<br>属性:<br>    boolean altKey<br>    number charCode<br>    boolean ctrlKey<br>    boolean getModifierState(key)<br>    string key<br>    number keyCode<br>    string locale<br>    number location<br>    boolean metaKey<br>    boolean repeat<br>    boolean shiftKey<br>    number which</p>
<h4 id="焦点事件"><a href="#焦点事件" class="headerlink" title="焦点事件"></a>焦点事件</h4><p>事件名: onFocus onBlur<br>属性: DOMEventTarget relatedTarget</p>
<h4 id="表单事件"><a href="#表单事件" class="headerlink" title="表单事件"></a>表单事件</h4><p>事件名: onChange onInput onInvalid onReset onSubmit </p>
<h4 id="通用事件"><a href="#通用事件" class="headerlink" title="通用事件"></a>通用事件</h4><p>事件名: onError onLoad</p>
<h4 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a>鼠标事件</h4><p>事件名: onClick onContextMenu onDoubleClick onDrag onDragEnd onDragEnter onDragExit<br>onDragLeave onDragOver onDragStart onDrop onMouseDown onMouseEnter onMouseLeave<br>onMouseMove onMouseOut onMouseOver onMouseUp<br>属性:<br>    boolean altKey<br>    number button<br>    number buttons<br>    number clientX<br>    number clientY<br>    boolean ctrlKey<br>    boolean getModifierState(key)<br>    boolean metaKey<br>    number pageX<br>    number pageY<br>    DOMEventTarget relatedTarget<br>    number screenX<br>    number screenY<br>    boolean shiftKey</p>
<ul>
<li>onMouseEnter 和 onMouseLeave 事件从离开的元素向进入的元素传播，不是正常的冒泡，也没有捕获阶段。</li>
</ul>
<h4 id="指针事件"><a href="#指针事件" class="headerlink" title="指针事件"></a>指针事件</h4><p>事件名: onPointerDown onPointerMove onPointerUp onPointerCancel onGotPointerCapture<br>onLostPointerCapture onPointerEnter onPointerLeave onPointerOver onPointerOut<br>属性:<br>    number pointerId<br>    number width<br>    number height<br>    number pressure<br>    number tangentialPressure<br>    number tiltX<br>    number tiltY<br>    number twist<br>    string pointerType<br>    boolean isPrimary</p>
<ul>
<li>onPointerEnter 和 onPointerLeave 事件从离开的元素向进入的元素传播，不是正常的冒泡，也没有捕获阶段。</li>
</ul>
<h4 id="选择事件"><a href="#选择事件" class="headerlink" title="选择事件"></a>选择事件</h4><p>事件名: onSelect</p>
<h4 id="触摸事件"><a href="#触摸事件" class="headerlink" title="触摸事件"></a>触摸事件</h4><p>事件名: onTouchCancel onTouchEnd onTouchMove onTouchStart<br>属性:<br>    boolean altKey<br>    DOMTouchList changedTouches<br>    boolean ctrlKey<br>    boolean getModifierState(key)<br>    boolean metaKey<br>    boolean shiftKey<br>    DOMTouchList targetTouches<br>    DOMTouchList touches</p>
<h4 id="UI-事件"><a href="#UI-事件" class="headerlink" title="UI 事件"></a>UI 事件</h4><p>事件名: onScroll<br>属性: number detail<br>      DOMAbstractView view</p>
<h4 id="滚轮事件"><a href="#滚轮事件" class="headerlink" title="滚轮事件"></a>滚轮事件</h4><p>事件名: onWheel<br>属性:<br>    number deltaMode<br>    number deltaX<br>    number deltaY<br>    number deltaZ</p>
<h4 id="媒体事件"><a href="#媒体事件" class="headerlink" title="媒体事件"></a>媒体事件</h4><p>事件名: onAbort onCanPlay onCanPlayThrough onDurationChange onEmptied onEncrypted<br>onEnded onError onLoadedData onLoadedMetadata onLoadStart onPause onPlay<br>onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend<br>onTimeUpdate onVolumeChange onWaiting</p>
<h4 id="图像事件"><a href="#图像事件" class="headerlink" title="图像事件"></a>图像事件</h4><p>事件名: onLoad onError</p>
<h4 id="动画事件"><a href="#动画事件" class="headerlink" title="动画事件"></a>动画事件</h4><p>事件名: onAnimationStart onAnimationEnd onAnimationIteration<br>属性:<br>    string animationName<br>    string pseudoElement<br>    float elapsedTime</p>
<h4 id="过渡事件"><a href="#过渡事件" class="headerlink" title="过渡事件"></a>过渡事件</h4><p>事件名: onTransitionEnd<br>属性:<br>    string propertyName<br>    string pseudoElement<br>    float elapsedTime</p>
<h4 id="其他事件"><a href="#其他事件" class="headerlink" title="其他事件"></a>其他事件</h4><p>事件名: onToggle</p>
<h2 id="5-7）React-术语词汇表"><a href="#5-7）React-术语词汇表" class="headerlink" title="5.7）React 术语词汇表"></a>5.7）React 术语词汇表</h2><h3 id="单页面应用-SPA"><a href="#单页面应用-SPA" class="headerlink" title="单页面应用 SPA"></a>单页面应用 SPA</h3><p>单页面应用(single-page application)，是一个应用程序，它可以加载单个 HTML 页面，以及运行应用程序所需的所有必要资源（例如 JavaScript 和 CSS）。与页面或后续页面的任何交互，都不再需要往返 server 加载资源，即页面不会重新加载。</p>
<h3 id="ES6-ES2015-ES2016-等"><a href="#ES6-ES2015-ES2016-等" class="headerlink" title="ES6, ES2015, ES2016 等"></a>ES6, ES2015, ES2016 等</h3><p>这些首字母缩写都是指 ECMAScript 语言规范标准的最新版本，JavaScript 语言是此标准的一个实现。其中 ES6 版本（也称为 ES2015）包括对前面版本的许多补充，例如：箭头函数、class、模板字面量、let 和 const 语句。(<a href="https://es6.ruanyifeng.com/" target="_blank" rel="noopener">https://es6.ruanyifeng.com/</a>)</p>
<h3 id="Compiler（编译器）"><a href="#Compiler（编译器）" class="headerlink" title="Compiler（编译器）"></a>Compiler（编译器）</h3><p>JavaScript compiler 接收 JavaScript 代码，然后对其进行转换，最终返回不同格式的 JavaScript 代码。最为常见的使用示例是，接收 ES6 语法，然后将其转换为旧版本浏览器能够解释执行的语法。Babel 是 React 最常用的 compiler。</p>
<h3 id="Bundler（打包工具）"><a href="#Bundler（打包工具）" class="headerlink" title="Bundler（打包工具）"></a>Bundler（打包工具）</h3><p>bundler 会接收写成单独模块（通常有数百个）的 JavaScript 和 CSS 代码，然后将它们组合在一起，最终生成出一些为浏览器优化的文件。常用的打包 React 应用的工具有 webpack 和 Browserify。</p>
<h3 id="Package-管理工具"><a href="#Package-管理工具" class="headerlink" title="Package 管理工具"></a>Package 管理工具</h3><p>package 管理工具，是帮助你管理项目依赖的工具。npm 和 Yarn 是两个常用的管理 React 应用依赖的 package 管理工具。它们都是使用了相同 npm package registry 的客户端。</p>
<h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><p>CDN 代表内容分发网络（Content Delivery Network）。CDN 会通过一个遍布全球的服务器网络来分发缓存的静态内容。</p>
<h3 id="JSX-1"><a href="#JSX-1" class="headerlink" title="JSX"></a>JSX</h3><p>JSX 是一个 JavaScript 语法扩展。它类似于模板语言，但它具有 JavaScript 的全部能力。JSX 最终会被编译为 React.createElement() 函数调用，返回称为 “React 元素” 的普通 JavaScript 对象。</p>
<h3 id="元素"><a href="#元素" class="headerlink" title="元素"></a>元素</h3><p>React 元素是构成 React 应用的基础砖块。人们可能会把元素与广为人知的“组件”概念相互混淆。元素描述了你在屏幕上想看到的内容。React 元素是不可变对象。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = &lt;h1&gt;Hello, world&lt;/h1&gt;;</span><br></pre></td></tr></table></figure></p>
<p>通常我们不会直接使用元素，而是从组件中返回元素。</p>
<h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><ol>
<li>props<br>props 是 React 组件的输入。它们是从父组件向下传递给子组件的数据。</li>
</ol>
<p>记住，props 是只读的。不应以任何方式修改它们：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误做法！</span></span><br><span class="line">props.number = <span class="number">42</span>;</span><br></pre></td></tr></table></figure></p>
<p>如果你想要修改某些值，以响应用户输入或网络响应，请使用 state 来作为替代。</p>
<ol start="2">
<li>props.children<br>每个组件都可以获取到 props.children。它包含组件的开始标签和结束标签之间的内容</li>
</ol>
<ol start="3">
<li>state</li>
</ol>
<ul>
<li>当组件中的一些数据在某些时刻发生变化时，这时就需要使用 state 来跟踪状态。</li>
<li>state 和 props 之间最重要的区别是：props 由父组件传入，而 state 由组件本身管理。组件不能修改 props，但它可以修改 state。</li>
</ul>
<h3 id="生命周期方法"><a href="#生命周期方法" class="headerlink" title="生命周期方法"></a>生命周期方法</h3><p>生命周期方法，用于在组件不同阶段执行自定义功能。在组件被创建并插入到 DOM 时（即挂载中阶段（mounting）），组件更新时，组件取消挂载或从 DOM 中删除时，都有可以使用的生命周期方法。</p>
<h3 id="受控组件-vs-非受控组件"><a href="#受控组件-vs-非受控组件" class="headerlink" title="受控组件 vs 非受控组件"></a>受控组件 vs 非受控组件</h3><p>React 有两种不同的方式来处理表单输入。</p>
<p>如果一个 input 表单元素的值是由 React 控制，就其称为受控组件。当用户将数据输入到受控组件时，会触发修改状态的事件处理器，这时由你的代码来决定此输入是否有效（如果有效就使用更新后的值重新渲染）。如果不重新渲染，则表单元素将保持不变。</p>
<p>一个非受控组件，就像是运行在 React 体系之外的表单元素。当用户将数据输入到表单字段（例如 input，dropdown 等）时，React 不需要做任何事情就可以映射更新后的信息。然而，这也意味着，你无法强制给这个表单字段设置一个特定值。</p>
<p>在大多数情况下，你应该使用受控组件。</p>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><ul>
<li><p>“key” 是在创建元素数组时，需要用到的一个特殊字符串属性。key 帮助 React 识别出被修改、添加或删除的 item。应当给数组内的每个元素都设定 key，以使元素具有固定身份标识。</p>
</li>
<li><p>只需要保证，在同一个数组中的兄弟元素之间的 key 是唯一的。而不需要在整个应用程序甚至单个组件中保持唯一。</p>
</li>
<li><p>不要将 Math.random() 之类的值传递给 key。重要的是，在前后两次渲染之间的 key 要具有“固定身份标识”的特点，以便 React 可以在添加、删除或重新排序 item 时，前后对应起来。理想情况下，key 应该从数据中获取，对应着唯一且固定的标识符，例如 post.id。</p>
</li>
</ul>
<h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><ul>
<li><p>React 支持一个特殊的、可以附加到任何组件上的 ref 属性。此属性可以是一个由 React.createRef() 函数创建的对象、或者一个回调函数、或者一个字符串（遗留 API）。当 ref 属性是一个回调函数时，此函数会（根据元素的类型）接收底层 DOM 元素或 class 实例作为其参数。这能够让你直接访问 DOM 元素或组件实例。</p>
</li>
<li><p>谨慎使用 ref。如果你发现自己经常使用 ref 来在应用中“实现想要的功能”，你可以考虑去了解一下自上而下的数据流。</p>
</li>
</ul>
<h3 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h3><ul>
<li>使用 React 元素处理事件时，有一些语法上差异：<br>React 事件处理器使用 camelCase（驼峰式命名）而不使用小写命名。<br>通过 JSX，你可以直接传入一个函数，而不是传入一个字符串，来作为事件处理器。</li>
</ul>
<h3 id="协调-1"><a href="#协调-1" class="headerlink" title="协调"></a>协调</h3><p>当组件的 props 或 state 发生变化时，React 通过将最新返回的元素与原先渲染的元素进行比较，来决定是否有必要进行一次实际的 DOM 更新。当它们不相等时，React 才会更新 DOM。这个过程被称为“协调”。</p>
<p><br><br><br></p>
<h1 id="六、React-Hook"><a href="#六、React-Hook" class="headerlink" title="六、React Hook"></a>六、React Hook</h1><h2 id="1）-简介"><a href="#1）-简介" class="headerlink" title="1） 简介"></a>1） 简介</h2><blockquote>
<p>Hook是React 16.8的新特性。它可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性。</p>
</blockquote>
<p><strong>React Hooks 要解决的问题是状态共享</strong>，称为 <strong>状态逻辑复用</strong> 会更恰当，因为只共享数据处理逻辑，不会共享数据本身。</p>
<p>意思很明了，就是拓展函数式组件的边界。结果也很清晰，只要 Class 组件能实现的，函数式组件 + Hooks都能胜任。</p>
<h2 id="2）-Hook是什么"><a href="#2）-Hook是什么" class="headerlink" title="2） Hook是什么"></a>2） Hook是什么</h2><blockquote>
<p>Hook 是一些可以让你在函数组件里“钩入” React state 及生命周期等特性的函数，这使得你不使用 class 也能使用 React。（Hook 不能在 class 组件中使用） </p>
</blockquote>
<blockquote>
<p>规则</p>
<ul>
<li>只在最顶层使用 Hook<ul>
<li>不要在循环条件，嵌套函数中调用Hook</li>
<li>确保Hook在每次组件render时调用顺序都是一样的</li>
</ul>
</li>
<li>不要在普通的 JavaScript 函数中调用 Hook<ul>
<li>在 React 的函数组件中调用 Hook</li>
<li>在自定义的Hook中可以调用Hook</li>
</ul>
</li>
</ul>
</blockquote>
<p>理想的情况 : <font color="#0f0"><strong>“有状态的组件没有渲染，有渲染的组件没有状态”</strong></font></p>
<h2 id="3）-常用Hooks"><a href="#3）-常用Hooks" class="headerlink" title="3） 常用Hooks"></a>3） 常用Hooks</h2><h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><blockquote>
<p>可以让函数组件在生命周期中，有维护自己的数据和状态的功能。</p>
</blockquote>
<h4 id="1-参数"><a href="#1-参数" class="headerlink" title="1. 参数"></a>1. 参数</h4><ol>
<li>如果是函数，这是一种惰性初始 state，这个函数就只会在初始渲染时候调用，函数的返回值就是 state 的初始值。</li>
<li>如果是数据，直接作为 state 的初始值。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const [test, setTest] = React.useState(0);</span><br><span class="line"></span><br><span class="line">const [test, setTest] = React.useState(() =&gt; &#123;</span><br><span class="line">  return 123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="2-覆盖式更新"><a href="#2-覆盖式更新" class="headerlink" title="2. 覆盖式更新"></a>2. 覆盖式更新</h4><p>  setTest更新值的方式是全部覆盖式更新，这跟class组件的setState不一样。<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 如果要更新单个值</span><br><span class="line">const [test, setTest] = React.useState(&#123; aa: 1, bb: 2 &#125;);</span><br><span class="line">setTest(&#123;</span><br><span class="line">  ...test,</span><br><span class="line">  aa: 10,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="3-函数式更新"><a href="#3-函数式更新" class="headerlink" title="3. 函数式更新"></a>3. 函数式更新</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params">&#123;initialCount&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(initialCount);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      Count: &#123;count&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setCount(initialCount)&#125;&gt;Reset&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(prevCount =&gt; prevCount - 1)&#125;&gt;-&lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setCount(<span class="function"><span class="params">prevCount</span> =&gt;</span> prevCount + <span class="number">1</span>)&#125;&gt;+&lt;/button&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="4-QA"><a href="#4-QA" class="headerlink" title="4. QA"></a>4. QA</h4><ol>
<li><p>我应该使用单个还是多个 state 变量？</p>
<blockquote>
<p>把所有 state 都放在同一个 <code>useState</code> 调用中，或是每一个字段都对应一个 <code>useState</code> 调用，这两方式都能跑通。当你在这两个极端之间找到平衡，然后把相关 state 组合到几个独立的 state 变量时，组件就会更加的可读。</p>
</blockquote>
</li>
<li><p>可不可以不通过setState直接给state赋值？</p>
<blockquote>
<p>“state” is read-only。<br>直接改变state的值会报错<br>修改复杂类型的state的属性，没有效果，组件不会重新渲染</p>
</blockquote>
</li>
<li><p>如何比较state?</p>
<blockquote>
<p>React 使用 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description" target="_blank" rel="noopener"><code>Object.is</code> 比较算法</a> 来比较 state。<br>我们更新一个 state 变量，我们会 <font color="#0f0"><strong>替换</strong></font> 它的值。这和 class 中的 <code>this.setState</code> 不一样，this.setState会把更新后的字段合并入对象中。</p>
</blockquote>
</li>
</ol>
<h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><h4 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h4><h5 id="关于React副作用"><a href="#关于React副作用" class="headerlink" title="关于React副作用"></a>关于React副作用</h5><blockquote>
<p>UI = F(props)</p>
</blockquote>
<p>翻译成普通话就是：一个组件最终的dom结构与样式是由父级传递的props决定的。</p>
<p>了解过函数式编程的同学，应该知道过一个概念，叫「纯函数」。意思是固定的输入必然有固定的输出，它不依赖任何外部因素，也不会对外部环境产生影响。</p>
<p>react希望自己的组件渲染也是个纯函数，所以有了纯函数组件。然而真正的业务场景是有各种状态的，实际影响UI的还有内部的state。(其实还有context，暂时先不讨论）。</p>
<blockquote>
<p>UI = F(props, state, context)</p>
</blockquote>
<p>这个state可能会因为各种原因产生变化，从而导致组件的渲染结果不一致。相同的入参（props）下，每次render都有可能返回不同的UI。因此任何导致此现象的行为都是副作用（side effects）。比如用户点击下一页，导致页码与列表发生变化，这就是副作用。同样的props，不点击时是第一页数据，点击一下后，变成了第二页的数据or请求失败的页面or其他UI交互。<br>当然state是明面上影响了UI，暗地里，可能还有其他因素会影响UI。比如组件内运用了缓存，导致每次渲染可能都不一样，这也是副作用。</p>
<h5 id="处理副作用"><a href="#处理副作用" class="headerlink" title="处理副作用"></a>处理副作用</h5><p>数据获取，设置订阅以及手动更改 React 组件中的 DOM 都属于副作用。 useEffect可以让我们在函数组件中执行副作用操作</p>
<div class="post-warning"><strong>提示</strong><br>如果你熟悉 React class 的生命周期函数，你可以把 useEffect Hook 看做 componentDidMount，componentDidUpdate 和 componentWillUnmount 这三个函数的组合。</div>


<h5 id="细化粒度"><a href="#细化粒度" class="headerlink" title="细化粒度"></a>细化粒度</h5><blockquote>
<p>每次我们重新渲染，都会生成 <strong>新的</strong> effect，替换掉之前的。某种意义上讲，effect 更像是渲染结果的一部分 —— 每个 effect “属于”一次特定的渲染。</p>
</blockquote>
<blockquote>
<p>提示: 使用多个 Effect 实现关注点分离<br>  使用 Hook 其中一个目的就是要解决 class 中生命周期函数经常包含不相关的逻辑，但又把相关逻辑分离到了几个不同方法中的问题。<br>  Hook 允许我们按照代码的用途分离他们</p>
</blockquote>
<h4 id="2、使用"><a href="#2、使用" class="headerlink" title="2、使用"></a>2、使用</h4><h5 id="2-1）用法"><a href="#2-1）用法" class="headerlink" title="2.1）用法"></a>2.1）用法</h5><p>useEffect的执行时机，主要根据 dependences 的情况来区分：</p>
<ol>
<li>dependences不传的时候，每次组件dom渲染结束后，都会走一遍这个useEffect；</li>
<li>dependences传空数组的时候，表示该useEffect不依赖任何变量，只有在组件第一次dom渲染后执行；</li>
<li>dependences传非空数组的时候，表示该useEffect依赖该数组中的元素变化，当组件dom渲染结束后，如果这些依赖项发生了改变的话，就要执行一次这个useEffect。</li>
</ol>
<h5 id="2-2）实例"><a href="#2-2）实例" class="headerlink" title="2.2）实例"></a>2.2）实例</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">useEffect(() =&gt; &#123;</span><br><span class="line">  console.log(&apos;dom挂载&apos;);</span><br><span class="line">  return () =&gt; &#123;</span><br><span class="line">    console.log(&apos;dom卸载&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, [count]);</span><br></pre></td></tr></table></figure>
<p>上述代码的执行结果是：</p>
<ul>
<li>初始dom渲染后打印出 <code>dom挂载</code></li>
<li>count发生变化后，组件再次render时，先执行 <code>dom卸载</code>，再执行 <code>dom挂载</code></li>
<li>以此类推下去<br>这个过程理解就可以说明：<code>为什么每次组件render都有自己的state和effect和事件</code>。</li>
</ul>
<h5 id="2-3）清除"><a href="#2-3）清除" class="headerlink" title="2.3）清除"></a>2.3）清除</h5><p>在 React 组件中有两种常见副作用操作：需要清除的和不需要清除的。</p>
<ul>
<li><p><strong>无需清除的effect</strong></p>
<blockquote>
<p>有时候，我们只想在 React 更新 DOM 之后运行一些额外的代码。比如发送网络请求，手动变更 DOM，记录日志，这些都是常见的无需清除的操作。因为我们在执行完这些操作之后，就可以忽略他们了</p>
</blockquote>
<div class="post-warning"><strong>提示</strong>与 componentDidMount 或 componentDidUpdate 不同，使用 useEffect 调度的 effect 不会阻塞浏览器更新屏幕，这让你的应用看起来响应更快。大多数情况下，effect 不需要同步地执行。在个别情况下（例如测量布局），有单独的 useLayoutEffect Hook 供你使用，其 API 与 useEffect 相同。</div>


</li>
</ul>
<ul>
<li><p><strong>需要清除的effect (定时器，绑定事件，订阅，防止内存泄漏)</strong></p>
<blockquote>
<p>在class组件中，我们需要在<code>componentDidMount</code> 和 <code>componentWillUnmount</code>、<code>componentDidUpdate</code>中来写入绑定和清除的代码。业务逻辑分布在各个生命周期中难以维护且容易出错。useEffect可以在同一个地方执行绑定和清除的代码。可读性可维护性更强。只用在effect函数内部执行绑定方法，再return一个清除的方法即可。</p>
<p>effect 在每次渲染的时候都会执行。这就是为什么 React 会在执行当前 effect 之前对上一个 effect 进行清除。</p>
</blockquote>
<p><font color="#0f0">class+生命周期：</font></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">class FriendStatus extends React.Component &#123;</span><br><span class="line">  constructor(props) &#123;</span><br><span class="line">    super(props);</span><br><span class="line">    this.state = &#123; isOnline: null &#125;;</span><br><span class="line">    this.handleStatusChange = this.handleStatusChange.bind(this);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    ChatAPI.subscribeToFriendStatus(</span><br><span class="line">      this.props.friend.id,</span><br><span class="line">      this.handleStatusChange</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    ChatAPI.unsubscribeFromFriendStatus(</span><br><span class="line">      this.props.friend.id,</span><br><span class="line">      this.handleStatusChange</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  handleStatusChange(status) &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      isOnline: status.isOnline</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    if (this.state.isOnline === null) &#123;</span><br><span class="line">      return &apos;Loading...&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    return this.state.isOnline ? &apos;Online&apos; : &apos;Offline&apos;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><font color="#0f0">function+Hook：</font></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; useState, useEffect &#125; from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">function FriendStatus(props) &#123;</span><br><span class="line">  const [isOnline, setIsOnline] = useState(null);</span><br><span class="line"></span><br><span class="line">  useEffect(() =&gt; &#123;</span><br><span class="line">    function handleStatusChange(status) &#123;</span><br><span class="line">      setIsOnline(status.isOnline);</span><br><span class="line">    &#125;</span><br><span class="line">    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);</span><br><span class="line">    // Specify how to clean up after this effect:</span><br><span class="line">    return function cleanup() &#123;</span><br><span class="line">      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  if (isOnline === null) &#123;</span><br><span class="line">    return &apos;Loading...&apos;;</span><br><span class="line">  &#125;</span><br><span class="line">  return isOnline ? &apos;Online&apos; : &apos;Offline&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="2-4）执行"><a href="#2-4）执行" class="headerlink" title="2.4）执行"></a>2.4）执行</h5><blockquote>
<p>并非所有 effect 都可以被延迟执行。例如，在浏览器执行下一次绘制前，用户可见的 DOM 变更就必须同步执行，这样用户才不会感觉到视觉上的不一致。（概念上类似于被动监听事件和主动监听事件的区别。）React 为此提供了一个额外的 useLayoutEffect Hook 来处理这类 effect。它和 useEffect 的结构相同，区别只是调用时机不同。</p>
</blockquote>
<h5 id="2-5）QA"><a href="#2-5）QA" class="headerlink" title="2.5）QA"></a>2.5）QA</h5><ol>
<li><p>为什么要在组件内部调用useEffect?</p>
<blockquote>
<p>放在组件内部让我们可以在effect中直接访问state。它已经保存在函数作用域中。Hook使用了js的闭包机制。</p>
</blockquote>
</li>
<li><p>如果我的 effect 的依赖频繁变化，我该怎么办？</p>
<blockquote>
<p>某些时候我只想在函数组件挂载的时候运行它，但是在effect中却用到了组件内的state,props等变量。这时候就会引起某些bug。</p>
</blockquote>
</li>
<li><p>为什么要在 effect 中返回一个函数？ </p>
<blockquote>
<p>这是 effect 可选的清除机制。每个 effect 都可以返回一个清除函数。如此可以将添加和移除订阅的逻辑放在一起。它们都属于 effect 的一部分。</p>
</blockquote>
</li>
<li><p>React 何时清除 effect？ </p>
<blockquote>
<p>React 会在组件卸载的时候执行清除操作。正如之前学到的，effect 在每次渲染的时候都会执行。这就是为什么 React 会在执行当前 effect 之前对上一个 effect 进行清除。</p>
</blockquote>
</li>
</ol>
<h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><blockquote>
<p>useContext 接受上下文对象（从React.createContext返回的值）并返回当前上下文值。</p>
<p>当前的 <code>context</code> 值由上层组件中距离当前组件最近的 <code>&lt;CountContext.Provider&gt;</code> 的 <code>value</code> prop 决定。</p>
<p>当Context Provider的value发生变化时，他的所有子级消费者都会rerender。</p>
</blockquote>
<p><code>useContext</code> 的参数必须是 <em>context 对象本身</em></p>
<h3 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h3><blockquote>
<p><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usestate" target="_blank" rel="noopener"><code>useState</code></a> 的替代方案。它接收一个形如 <code>(state, action) =&gt; newState</code> 的 reducer，并返回当前的 state 以及与其配套的 <code>dispatch</code> 方法。</p>
<p> state 逻辑较复杂且包含多个子值，或者下一个 state 依赖于之前的 state 等。并且，使用 useReducer 还能给那些会触发深更新的组件做性能优化，因为你可以向子组件传递 dispatch 而不是回调函数 。</p>
<p>React 会确保 <code>dispatch</code> 函数的标识是稳定的，并且不会在组件重新渲染时改变。这就是为什么可以安全地从 <code>useEffect</code> 或 <code>useCallback</code> 的依赖列表中省略 <code>dispatch</code>。</p>
</blockquote>
<ul>
<li><p>指定初始化state</p>
<blockquote>
<p>将初始 state 作为第二个参数传入 <code>useReducer</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const [state, dispatch] = useReducer(</span><br><span class="line">    reducer,</span><br><span class="line">    &#123;count: initialCount&#125;</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>
</li>
<li><p>惰性初始化</p>
<blockquote>
<p>需要将 <code>init</code> 函数作为 <code>useReducer</code> 的第三个参数传入，这样初始 state 将被设置为 <code>init(initialArg)</code></p>
<p>这么做可以将用于计算 state 的逻辑提取到 reducer 外部，这也为将来对重置 state 的 action 做处理提供了便利</p>
<p>局部状态不推荐使用 <code>useReducer</code> ，会导致函数内部状态过于复杂，难以阅读。 <code>useReducer</code> 建议在多组件间通信时，结合 <code>useContext</code> 一起使用。</p>
</blockquote>
</li>
</ul>
<ol>
<li><p>如何自己写一个useReducer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function useReducer(reducer, initialState) &#123;</span><br><span class="line">  const [state, setState] = useState(initialState);</span><br><span class="line"></span><br><span class="line">  function dispatch(action) &#123;</span><br><span class="line">    const nextState = reducer(state, action);</span><br><span class="line">    setState(nextState);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return [state, dispatch];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol start="2">
<li><p>如何用useReducer创建一个redux</p>
<blockquote>
<p>真正实现一个 Redux 功能，也就是全局维持一个状态，任何组件 <code>useReducer</code> 都会访问到同一份数据，可以和useContext一起使用。</p>
<p>大体思路是利用 <code>useContext</code> 共享一份数据，作为 Custom Hooks 的数据源。将useReducer中获取state和dispatch当做参数传递给useContext</p>
</blockquote>
</li>
</ol>
<p>总结起来就是：</p>
<ul>
<li>如果你的页面<code>state</code>很简单，可以直接使用<code>useState</code></li>
<li>如果你的页面<code>state</code>比较复杂（state是一个对象或者state非常多散落在各处）请使用userReducer</li>
<li>如果你的页面组件层级比较深，并且需要子组件触发<code>state</code>的变化，可以考虑useReducer + useContext</li>
</ul>
<h3 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h3><blockquote>
<p>返回一个 <a href="https://en.wikipedia.org/wiki/Memoization" target="_blank" rel="noopener">memoized</a> 回调函数。</p>
<p>该回调函数仅在某个依赖项改变时才会更新。当你把回调函数传递给经过优化的并使用引用相等性,去避免非必要渲染<br>useCallback(fn, deps) 相当于 useMemo(() =&gt; fn, deps)</p>
<p>所有回调函数中引用的值都应该出现在依赖项数组中</p>
<p>推荐所有函数组件内函数的用 <code>React.useCallback</code> 包裹，以保证准确性与性能。推荐<code>useCallback</code> 第二个参数必须写</p>
</blockquote>
<p>1.拿到onChange抛出的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">export const useInputValue = val =&gt; &#123;</span><br><span class="line">  let [value, setValue] = useState(val);</span><br><span class="line">  let onChange = useCallback(function(event) &#123;</span><br><span class="line">    setValue(event.currentTarget.value);</span><br><span class="line">  &#125;, []);//保证inputDom只绑定监听事件一次</span><br><span class="line"></span><br><span class="line">  return &#123;</span><br><span class="line">    value,</span><br><span class="line">    onChange</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p> 效果：通过 useInputValue() 拿到 Input 框当前用户输入的值，而不是手动监听 onChange 再腾一个 otherInputValue 和一个回调函数把这一堆逻辑写在无关的地方。</p>
</blockquote>
<h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><blockquote>
<p>返回一个memoized值 <code>const memoizedValue = useMemo(() =&gt; computeExpensiveValue(a, b), [a, b]);</code><br>你可以把 <code>useMemo</code> 作为一种性能优化的手段</p>
</blockquote>
<p>两个参数依次是计算函数（通常是组件函数）和依赖状态列表，当依赖的状态发生改变时，才会触发计算函数的执行。如果没有指定依赖，则每一次渲染过程都会执行该计算函数。</p>
<p>前面我们说过了当状态发生变化时，没有设置关联状态的 useEffect 会全部执行。同样的，通过计算出来的值或者引入的组件也会重新计算/挂载一遍，即使与其关联的状态没有发生任何变化。 </p>
<p>在类组件中我们有 shouldComponetUpdate 以及 React.memo 帮助我们去做性能优化。所以在函数组件中就出现了useMemo。</p>
<p><code>在业务中，我们可以用  useMemo  来处理计算结果的缓存或引入组件的防止重复挂载优化。</code>其接受两个参数，第一个参数为一个 Getter 方法，返回值为要缓存的数据或组件，第二个参数为该返回值相关联的状态，当其中任何一个状态发生变化时就会重新调用 Getter 方法生成新的返回值。</p>
<blockquote>
<p>初次接受  useMemo  时可能我们会觉得该钩子只是用来做计算结果的缓存，返回值只能是一个数字或字符串。其实  useMemo  并不关心我们的返回值类型是什么，它只是在关联状态发生变动时重新调用我们传递的 Getter 方法 生成新的返回值，也就是说  <code>useMemo  生成的是 Getter 方法与依赖数组的关联关系</code>。因此，如果我们将函数的返回值替换为一个组件，那么就可以实现对组件挂载/重新挂载的性能优化。</p>
</blockquote>
<h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><blockquote>
<p>useRef 返回一个<strong>可变</strong>的 ref 对象，其 .current 属性被初始化为传入的参数（initialValue）。返回的 ref 对象在组件的整个生命周期内保持不变。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const refContainer = useRef(initialValue);</span><br></pre></td></tr></table></figure>
<blockquote>
<p> <code>useRef()</code> 和自建一个 <code>{current: ...}</code> 对象的唯一区别是，<code>useRef</code> 会在每次渲染时返回同一个 ref 对象。</p>
<p>当 ref 对象内容发生变化时，useRef 并不会通知你。变更 .current 属性不会引发组件重新渲染。如果想要在 React 绑定或解绑 DOM 节点的 ref 时运行某些代码，则需要使用回调 ref 来实现。</p>
</blockquote>
<p>useRef hook的作用：</p>
<ul>
<li>获取DOM元素的节点</li>
<li>获取子组件的实例</li>
<li>渲染周期之间共享数据的存储（state不能存储跨渲染周期的数据，因为state的保存会触发组件重渲染）</li>
</ul>
<p>useRef之所以总能取到变量最新值的原因：它保存的变量不会随着每次数据的变化重新生成，所以相当于保存了一份该变量的引用，所以总能保持在最后一次赋值的状态。</p>
<h3 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h3><h3 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h3><h3 id="useDebugValue"><a href="#useDebugValue" class="headerlink" title="useDebugValue"></a>useDebugValue</h3><p>useDebugValue 可用于在 React 开发者工具中显示自定义 hook 的标签。</p>
<h2 id="4-特点"><a href="#4-特点" class="headerlink" title="4) 特点"></a>4) 特点</h2><h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><ol>
<li>让在函数组件中有可维护的状态和数据</li>
<li>函数组件业务变更无需修改成class组件</li>
<li>告别了繁杂的this和难以记忆的生命周期</li>
<li>合并的生命周期componentDidMount、componentDidUpdate、和 componentWillUnmount</li>
<li>更好的完成状态之间的共享.</li>
<li>多个状态不会产生嵌套，写法还是平铺的，也解决了高阶组件和函数组件的嵌套过深</li>
<li>Hooks 可以引用其他 Hooks。</li>
<li>useReducer集成redux</li>
<li>useEffect接受脏操作等到react更新了DOM之后，它再依次执行我们定义的副作用函数。‘</li>
<li>状态与UI的界限份的越来越清晰</li>
</ol>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ol>
<li>有些hooks行为怪异很难理解。 useEffect最甚；有时候依赖和回调写的不注意就容易死循环。</li>
<li>规矩很多（ 函数必须以 “use” 命名开头，顺序，不能在条件判断循环中声明等等)</li>
<li>逻辑复杂的场景中或者系统的主要架构中用hook进行状态或者数据管理还是不太放心。</li>
<li>社区好像更热衷于造轮子</li>
</ol>
<h3 id="5）总结"><a href="#5）总结" class="headerlink" title="5）总结"></a>5）总结</h3><blockquote>
<p>应该理性的选择，hook和现在的项目系统不冲突，现在也是模块化开发，可以从新的模块入手来尝试在模块内部用hook来处理数据和逻辑状态。</p>
<p>在一些简单的页面里，引入redux，saga那一套东西显得有些大材小用，而且开发起来也有些繁琐，使用hook会更灵活轻便一些。</p>
<p>我们也可以开发一些常用的hook，当老项目有新的功能完全可以用Hook去开发，如果对老的组件进行修改时就可以考虑给老组件上Hook，不建议一上来就进行大改。随着常用Hook组件库的丰富，后期改起来也会非常快。</p>
<p>在使用Hook时难免少不了一些常用的Hook，如果可以将这些常用的Hook封装起来。变成工具库。</p>
</blockquote>
<ul>
<li><p><a href="https://github.com/dt-fe/weekly/blob/v2/120.%E7%B2%BE%E8%AF%BB%E3%80%8AReact%20Hooks%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E3%80%8B.md" target="_blank" rel="noopener">React Hooks 最佳实践</a></p>
</li>
<li><p><a href="https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/" target="_blank" rel="noopener">useEffect 完整指南</a></p>
</li>
<li><p><a href="https://www.robinwieruch.de/react-hooks-fetch-data" target="_blank" rel="noopener">How to fetch data with React Hooks?</a></p>
</li>
</ul>
<h1 id="七、有价值的QA"><a href="#七、有价值的QA" class="headerlink" title="七、有价值的QA"></a>七、有价值的QA</h1><ol>
<li><p>节流、防抖和requestAnimationFrame<br>节流：基于时间的频率来进行抽样更改 (例如 _.throttle)<br>防抖：一段时间的不活动之后发布更改 (例如 _.debounce)<br>requestAnimationFrame 节流：基于 requestAnimationFrame 的抽样更改 (例如 raf-schd)</p>
</li>
<li><p>应该如何更新那些依赖于当前的 state 的 state 呢？<br>给 setState 传递一个函数，而不是一个对象，就可以确保每次的调用都是使用最新版的 state。<br>传递一个函数可以让你在函数内访问到当前的 state 的值。因为 setState 的调用是分批的，所以你可以链式地进行更新，并确保它们是一个建立在另一个之上的，这样才不会发生冲突：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 重要：在更新的时候读取 `state`，而不是 `this.state`。</span></span><br><span class="line">  <span class="keyword">return</span> &#123;<span class="attr">count</span>: state.count + <span class="number">1</span>&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/10/css/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/10/css/" itemprop="url">css</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-10T09:48:38+08:00">
                2018-07-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/基础/" itemprop="url" rel="index">
                    <span itemprop="name">基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>CSS（cascading style sheet，层叠样式表） 是前端的三大基本语言之一。</p>
<h1 id="第一章、-CSS基础"><a href="#第一章、-CSS基础" class="headerlink" title="第一章、 CSS基础"></a><font color="#DC143C">第一章、 CSS基础</font></h1><ul>
<li>行间样式</li>
<li>页面级css</li>
<li>引入css文件 &lt;link rel = ‘stylesheet’ type = ‘text/css’ href = ‘xxx.css’/></li>
</ul>
<h2 id="一、选择器"><a href="#一、选择器" class="headerlink" title="一、选择器"></a><font color="#F33F50">一、选择器</font></h2><p><style>.textCenter{border:0;} .textCenter td{text-align:center;border:0;}</style></p>
<table class="textCenter"><tr><td colspan="2">权重</td></tr><tr><td>!important</td><td>无穷大</td></tr><tr><td>行间样式</td><td>1000</td></tr><tr><td>id</td><td>100</td></tr><tr><td>class | 属性 | 伪类</td><td>10</td></tr><tr><td>标签 | 伪元素</td><td>1</td></tr><tr><td>通配符</td><td>0</td></tr></table>

<p>分组选择器  父子选择器/派生选择器 直接子元素选择器（<font color="red">查找顺序是从后往前查</font>）</p>
<h2 id="二、常用的样式属性"><a href="#二、常用的样式属性" class="headerlink" title="二、常用的样式属性"></a><font color="#F33F50">二、常用的样式属性</font></h2><h3 id="font-size"><a href="#font-size" class="headerlink" title="font-size"></a>font-size</h3><h3 id="font-weight"><a href="#font-weight" class="headerlink" title="font-weight"></a>font-weight</h3><ul>
<li>bold  bolder  lighter normal  </li>
<li>100 200 …… 900</li>
</ul>
<h3 id="font-family"><a href="#font-family" class="headerlink" title="font-family"></a>font-family</h3><ul>
<li>arail georgia verdama ……</li>
<li>‘宋体’ ‘楷体’ ……</li>
</ul>
<h3 id="font-style"><a href="#font-style" class="headerlink" title="font-style"></a>font-style</h3><ul>
<li>normal（默认） italic</li>
</ul>
<h3 id="color"><a href="#color" class="headerlink" title="color"></a>color</h3><ul>
<li>red black pink ……</li>
<li>#f40 ……</li>
<li>rgb(255,0,0)</li>
<li>rgba(255,0,0,0.5)</li>
</ul>
<h3 id="border"><a href="#border" class="headerlink" title="border"></a>border</h3><ul>
<li>border-width: 5px;</li>
<li>border-style: solid实线 / dashed虚线 / dotted点状边框 ……<br>border-radius: 10px/ 50%;</li>
</ul>
<h3 id="text-align"><a href="#text-align" class="headerlink" title="text-align"></a>text-align</h3><ul>
<li>left right center justify(两端对齐) inherit</li>
</ul>
<h3 id="vertical-align"><a href="#vertical-align" class="headerlink" title="vertical-align"></a>vertical-align</h3><ul>
<li>baseline    默认。元素放置在父元素的基线上。<br>sub    垂直对齐文本的下标。<br>super    垂直对齐文本的上标<br>top    把元素的顶端与行中最高元素的顶端对齐<br>text-top    把元素的顶端与父元素字体的顶端对齐<br>middle    把此元素放置在父元素的中部。<br>bottom    把元素的顶端与行中最低的元素的顶端对齐。<br>text-bottom    把元素的底端与父元素字体的底端对齐。<br>length<br>%    使用 ‘line-height’ 属性的百分比值来排列此元素。允许使用负值。<br>inherit    规定应该从父元素继承 vertical-align 属性的值。</li>
<li>line-height === 行高，则垂直方向居中，1em  1个font-size</li>
</ul>
<h3 id="text-indent"><a href="#text-indent" class="headerlink" title="text-indent"></a>text-indent</h3><ul>
<li>length      %      inherit</li>
</ul>
<h3 id="text-decoration"><a href="#text-decoration" class="headerlink" title="text-decoration"></a>text-decoration</h3><ul>
<li>none(默认) underline     overline     line-through     blink     inherit</li>
</ul>
<h3 id="cursor"><a href="#cursor" class="headerlink" title="cursor"></a>cursor</h3><ul>
<li><p>url    需使用的自定义光标的 URL。 注释：请在此列表的末端始终定义一种普通的光标，以防没有由 URL 定义的可用光标。</p>
<p>default    默认光标（通常是一个箭头）<br>auto    默认。浏览器设置的光标。<br>crosshair    光标呈现为十字线。<br>pointer    光标呈现为指示链接的指针（一只手）<br>move    此光标指示某对象可被移动。<br>e-resize    此光标指示矩形框的边缘可被向右（东）移动。<br>ne-resize    此光标指示矩形框的边缘可被向上及向右移动（北/东）。<br>nw-resize    此光标指示矩形框的边缘可被向上及向左移动（北/西）。<br>n-resize    此光标指示矩形框的边缘可被向上（北）移动。<br>se-resize    此光标指示矩形框的边缘可被向下及向右移动（南/东）。<br>sw-resize    此光标指示矩形框的边缘可被向下及向左移动（南/西）。<br>s-resize    此光标指示矩形框的边缘可被向下移动（南）。<br>w-resize    此光标指示矩形框的边缘可被向左移动（西）。<br>text    此光标指示文本。<br>wait    此光标指示程序正忙（通常是一只表或沙漏）。<br>help    此光标指示可用的帮助（通常是一个问号或一个气球）。</p>
</li>
</ul>
<h3 id="opacity"><a href="#opacity" class="headerlink" title="opacity"></a>opacity</h3><ul>
<li>value(0.0-1.0) inherit</li>
</ul>
<h3 id="background"><a href="#background" class="headerlink" title="background"></a>background</h3><ul>
<li><strong>background-color</strong><br>transparent(默认)    color_name       hex_number       rgb_number     inherit</li>
<li><strong>background-image </strong><br>url(‘URL’)    指向图像的路径。<br>none          默认值。不显示背景图像。<br>inherit       规定应该从父元素继承 background-image 属性的设置。</li>
<li><strong>background-position</strong><br>x% y%        第一个值是水平位置，第二个值是垂直位置。0% 0%。（默认值），左上角是 0% 0%，右下角是 100% 100%。如果仅规定了一个值，另一个值将是 50%。<br>xpos ypos    第一个值是水平位置，第二个值是垂直位置。左上角是 0 0。单位是像素 (0px 0px) 或任何其他的 CSS 单位。如果您仅规定了一个值，另一个值将是50%。<br>top left / top center / top right / center left / center center / center right / bottom left / bottom center / bottom right  如果仅规定了一个关键词，那么第二个值将是’center’。<pre><code>可以混合使用 % 和 position 值。
</code></pre></li>
<li><strong>background-size </strong><br>length        设置背景图像的高度和宽度。第一个值设置宽度，第二个值设置高度。如果只设置一个值，则第二个值会被设置为 ‘auto’。<br>percentage    以父元素的百分比来设置背景图像的宽度和高度。第一个值设置宽度，第二个值设置高度。如果只设置一个值，则第二个值会被设置为 ‘auto’。<br>cover         把背景图像扩展至足够大，以使背景图像完全覆盖背景区域。背景图像的某些部分也许无法显示在背景定位区域中。<br>contain       把图像图像扩展至最大尺寸，以使其宽度和高度完全适应内容区域。</li>
<li><strong>background-repeat</strong><br>repeat（默认） repeat-x    repeat-y    no-repeat    inherit</li>
<li><strong>background-origin 规定背景图片的定位区域。</strong><br>padding-box       背景图像相对于内边距框来定位。<br>border-box        背景图像相对于边框盒来定位。<br>content-box       背景图像相对于内容框来定位。</li>
<li><strong>background-clip   规定背景的绘制区域。</strong><br>border-box        背景被裁剪到边框盒。<br>padding-box       背景被裁剪到内边距框。<br>content-box       背景被裁剪到内容框。</li>
<li><strong>background-attachment 规定背景图像是否固定或者随着页面的其余部分滚动。</strong><br>scroll            默认值。背景图像会随着页面其余部分的滚动而移动。<br>fixed             当页面的其余部分滚动时，背景图像不会移动。<br>inherit</li>
<li><strong>inherit 规定应该从父元素继承 background 属性的设置。</strong></li>
</ul>
<h3 id="display"><a href="#display" class="headerlink" title="display"></a>display</h3><ul>
<li><p>块级元素（block）：div p h1~h6 ul li ol li form table tr address ……</p>
<pre><code>1）独占一行，不满一行占一行，不满两行占两行
2）可以通过css改变宽高
</code></pre></li>
<li><p>行级元素（inline）：span button strong em i  ……</p>
<pre><code>1）内容决定宽高，不占满整行
2）不可以通过css改变宽高    
</code></pre></li>
<li><p>行级块标签（inline-block）：img  input  select …… </p>
<pre><code>1）内容决定宽高，不占满整行
2）可以通过css改变宽高
</code></pre><font color="red">行级块元素中若无文字，则其后文字与其下对齐。（可通过vertical-align来改变文字的垂直位置）</font><br><font color="red">带有inline属性的标签都有文字属性。</font>

</li>
</ul>
<blockquote>
<p>none    此元素不会被显示。<br>  block    此元素将显示为块级元素，此元素前后会带有换行符。<br>  inline    默认。此元素会被显示为内联元素，元素前后没有换行符。<br>  inline-block    行内块元素。（CSS2.1 新增的值）<br>  inherit    规定应该从父元素继承 display 属性的值。</p>
</blockquote>
<p><br></p>
<h2 id="三、盒模型"><a href="#三、盒模型" class="headerlink" title="三、盒模型"></a><font color="#F33F50">三、盒模型</font></h2><ul>
<li>width height</li>
<li>padding<br>padding: 1px 2px 3px 4px;上 右 下 左<br>padding: 1px 2px 3px; 上 左右 下<br>padding: 1px 2px; 上下 左右<br>padding: 1px; 上下左右</li>
<li>border<br>border: 1px solid;<br>border-width: 1px;<br>border-style: solid;<br>border-color: black;<br>border-top/bottom/left/right<br>border-top/bottom/left/right-width/style/color</li>
<li>margin<br>同padding</li>
</ul>
<blockquote>
<ul>
<li>margin塌陷问题<br>  可以通过触发bfc的方式解决这个问题。<ul>
<li>overflow: hidden;</li>
<li>display: inline-block;</li>
<li>position: absolute;</li>
<li>float: left; </li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>margin合并问题<br>处于bfc的区域里即可解决这个问题。但是<font>html中的标签是实现特定的结构功能，没有为了解决bug去多加一层标签。</font>一般margin塌陷问题解决，margin合并问题不用解决。</li>
</ul>
</blockquote>
<p><br></p>
<h2 id="四、层模型"><a href="#四、层模型" class="headerlink" title="四、层模型"></a><font color="#F33F50">四、层模型</font></h2><ul>
<li>1、绝对定位 position: absolute;<br>脱离原来的位置进行定位。相对于最近的有定位的父级进行定位，如没有，则相对于文档进行定位。</li>
<li>2、相对定位 position: relative;<br>相对于原来的位置进行定位。</li>
<li><p>3、固定定位 postion: fix;<br>相对于屏幕进行定位。<br>z-index </p>
</li>
<li><p>static    默认值。没有定位，元素出现在正常流中（忽略 top, bottom, left, right 或者 z-index 声明）。</p>
</li>
<li>inherit<br><br></li>
</ul>
<h2 id="五、浮动模型"><a href="#五、浮动模型" class="headerlink" title="五、浮动模型"></a><font color="#F33F50">五、浮动模型</font></h2><p>float : left / right;<br>1、产生浮动流<br>2、产生bfc的元素可以看到浮动流（overflow: hidden; display: inline-block; position: abosulte; float: left/right;）<br>3、有文本属性（包括文本）的元素可以看到浮动流</p>
<blockquote>
<p>清除浮动流的方法：<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.clearfix&#123;</span><br><span class="line">  *zoom: 1;</span><br><span class="line">&#125;</span><br><span class="line">.clearfix:after &#123;</span><br><span class="line">  content: <span class="string">' '</span>;</span><br><span class="line">  clear: both;</span><br><span class="line">  display: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><br></p>
<h2 id="六、经验性小知识"><a href="#六、经验性小知识" class="headerlink" title="六、经验性小知识"></a><font color="#F33F50">六、经验性小知识</font></h2><h3 id="1-为什么-lt-span-标签又可以设置宽高了呢。"><a href="#1-为什么-lt-span-标签又可以设置宽高了呢。" class="headerlink" title="1.为什么&lt;span>标签又可以设置宽高了呢。"></a>1.为什么&lt;span>标签又可以设置宽高了呢。</h3><p>  因为posititon: absolute;或 float: left/right;，把&lt;span>标签内部的display属性的值改成了inline-block;<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;123&lt;/span&gt;</span><br><span class="line">span&#123;</span><br><span class="line">  position: absolute; / <span class="built_in">float</span>: left/right;</span><br><span class="line">  width: 100px;</span><br><span class="line">  height: 100px; </span><br><span class="line">  background: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="2-lt-p-标签里不能嵌套-lt-div-标签"><a href="#2-lt-p-标签里不能嵌套-lt-div-标签" class="headerlink" title="2.&lt;p>标签里不能嵌套&lt;div>标签"></a>2.&lt;p>标签里不能嵌套&lt;div>标签</h3><p>&lt;a>标签里不能嵌套&lt;a>标签</p>
<h3 id="3-文字属性继承"><a href="#3-文字属性继承" class="headerlink" title="3.文字属性继承"></a>3.文字属性继承</h3><p>  父元素中的文字属性都可以继承，如果自己有则用自己的，没有继承父亲的。</p>
<h3 id="4-单行文字溢出打点"><a href="#4-单行文字溢出打点" class="headerlink" title="4.单行文字溢出打点"></a>4.单行文字溢出打点</h3><ul>
<li><p>单行文字溢出打点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">white-space: nowrap;</span><br><span class="line">overflow: hidden;</span><br><span class="line">text-overflow: ellipsis;</span><br></pre></td></tr></table></figure>
</li>
<li><p>多行溢出打点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">width: 100px;</span><br><span class="line">overflow: hidden;</span><br><span class="line">text-overflow: ellipsis;</span><br><span class="line">-webkit-line-clamp: 5; // 是一个 不规范的属性（unsupported WebKit property），它没有出现在 CSS 规范草案中。限制在一个块元素显示的文本的行数</span><br><span class="line">display: -webkit-box;  // 必须结合的属性 ，将对象作为弹性伸缩盒子模型显示 。</span><br><span class="line">-webkit-box-orient: vertical; // 必须结合的属性 ，设置或检索伸缩盒对象的子元素的排列方式 。</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-主流浏览器"><a href="#5-主流浏览器" class="headerlink" title="5.主流浏览器"></a>5.主流浏览器</h3><table class="textCenter"><tr><td>主流浏览器</td><td>浏览器内核</td></tr><tr><td>Internet Explorer</td><td>trident</td></tr><tr><td>Chrome</td><td>webkit/blink</td></tr><tr><td>FireFox</td><td>Gecko</td></tr><tr><td>Sarafri</td><td>webkit</td></tr><tr><td>Opera</td><td>presto</td></tr><tr><td>360极速</td><td>webkit</td></tr><tr><td>360</td><td>双内核 webkit/Crident</td></tr></table>

<h3 id="6-开发调试"><a href="#6-开发调试" class="headerlink" title="6.开发调试"></a>6.开发调试</h3><p>  console控制台、代码debugger、Sources打断点<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="第二章、-CSS3"><a href="#第二章、-CSS3" class="headerlink" title="第二章、 CSS3"></a><font color="#DC143C">第二章、 CSS3</font></h1><p>css3.0是目前最新的 CSS 标准。</p>
<h2 id="一、css3常用新属性"><a href="#一、css3常用新属性" class="headerlink" title="一、css3常用新属性"></a><font color="#F33F50">一、css3常用新属性</font></h2><table class="textCenter"><tr><td>兼容前缀</td><td>浏览器</td></tr><tr><td>-webkit</td><td>chrome和safari</td></tr><tr><td>-moz</td><td>fireFox</td></tr><tr><td>-ms</td><td>IE</td></tr><tr><td>-o</td><td>opera</td></tr></table>  

<p><strong><a href="https://caniuse.com/" target="_blank" rel="noopener">可以测试属性兼容性</a>，现在很多打包插件在打包时就会自动处理这些样式兼容问题，所以开发可忽略。</strong></p>
<h3 id="1-border-radius-圆角"><a href="#1-border-radius-圆角" class="headerlink" title="1. border-radius 圆角"></a><font color="#FF6060">1. border-radius 圆角</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">border-radius：20px;</span><br><span class="line">border-radius: 20px 20px 20px 20px;</span><br><span class="line">border-top-left-radius:20px;</span><br><span class="line">border-top-right-radius:20px;</span><br><span class="line">border-bottom-left-radius:20px;</span><br><span class="line">border-bottom-right-radius:20px;</span><br></pre></td></tr></table></figure>
<h3 id="2-box-shadow-阴影"><a href="#2-box-shadow-阴影" class="headerlink" title="2. box-shadow 阴影"></a><font color="#FF6060">2. box-shadow 阴影</font></h3><blockquote>
<p>box-shadow : x轴偏移量  y轴偏移量   模糊半径</p>
</blockquote>
<div class="box"></div>


<h3 id="3-font-face-字体"><a href="#3-font-face-字体" class="headerlink" title="3. font-face 字体"></a><font color="#FF6060">3. font-face 字体</font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@font-face&#123;</span><br><span class="line">  font-family:<span class="string">'ziti'</span>;</span><br><span class="line">  src:(<span class="string">'./font/Summer.ttf'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">font-family: <span class="string">'ziti'</span>;</span><br></pre></td></tr></table></figure>
<p>字体资源一般设计都会提供，也可以在网络上找到。推荐网址：<a href="http://www.w3cplus.com/content/css3-font-face" target="_blank" rel="noopener">w3cplus</a>和<a href="https:://www.dafont.com" target="_blank" rel="noopener">dafont</a>。 </p>
<h3 id="4-rgba-颜色值"><a href="#4-rgba-颜色值" class="headerlink" title="4. rgba() 颜色值"></a><font color="#FF6060">4. rgba() 颜色值</font></h3><p>red green blue alpha</p>
<h3 id="5-Gradient-渐变的背景色"><a href="#5-Gradient-渐变的背景色" class="headerlink" title="5. Gradient 渐变的背景色"></a><font color="#FF6060">5. Gradient 渐变的背景色</font></h3><ol>
<li><p>linear-gradient 线性渐变 to<br> linear-gradient( [ direction ] , color1 [ precent / pixel ] ,color2 [ precent / pixel ] );</p>
<ul>
<li>direction:<br>  1) 0 ~ 360deg角度<br>  2) <pre><code>to top/bottom/left/right
 to top left
 to bottom left...
</code></pre></li>
</ul>
<p>eg:background:linear-gradient(50deg , red 10px,yellow 240px);</p>
  <div style="width:300px;height:100px;margin-left:17px;background:linear-gradient(50deg , red 100px,yellow 240px);"></div><br>  background:linear-gradient(to right , SpringGreen ,  MintCream 90%);<br>  <div style="width:300px;height:100px;margin-left:17px;background:linear-gradient(to right , SpringGreen, MintCream 90%); "></div>
</li>
<li><p>radial-gradient 径向渐变 at<br>radial-gradient(shap at position , color1 [percent/pixel] , color2 [precent/pixel]);<br>shap放射形状：circle、ellipse<br>postion：center（圆心位置）、坐标值等</p>
<p>eg: radial-gradient(circle at center , rgba(96,0,190) , rgba(0,0,0));</p>
<div style="width:300px;height:100px;margin-left:17px;background:radial-gradient(circle at center,rgba(96,0,190) , rgba(0,0,0))"></div>

<p>radial-gradient(ellipse at 200px 80px , rgba(96,0,190) , rgba(0,0,0));</p>
<div style="width:300px;height:100px;margin-left:17px;background:radial-gradient(ellipse at 200px 80px,rgba(96,0,190) , rgba(0,0,0))"></div>



</li>
</ol>
<h3 id="6-background-背景"><a href="#6-background-背景" class="headerlink" title="6. background 背景"></a><font color="#FF6060">6. background 背景</font></h3><ol>
<li><p>background-origin 背景图片起始位置<br>background-origin : border-box / padding-box / content-box;<br><div style="width:400px;height:100px;background-origin:border-box;border:10px solid rgba(255,0,0,0.3);padding:40px;background-repeat: no-repeat;color:#fff;background-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg')">background-origin : border-box;</div><br><div style="width:400px;height:100px;background-origin:padding-box;border:10px solid rgba(255,0,0,0.3);padding:40px;color:#fff;background-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg')">background-origin : padding-box;</div><br><div style="width:400px;height:100px;background-origin:content-box;border:10px solid rgba(255,0,0,0.3);padding:40px;color:#fff;background-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg')">background-origin : content-box;</div><br><strong> * 此处为了更清楚的看出背景图片的起始位置，给背景图片设置了background-repeat：no-repeat;</strong></p>
</li>
<li><p>background-size 背景图片尺寸<br>background-size : auto / &lt;长度值&gt; / &lt;百分比&gt; / cover / contain ;</p>
</li>
<li><p>background-position 背景图片位置<br>background-position:0px 10px;</p>
</li>
<li><p>background-repeat 背景图片是否重复<br>background-repeat:inherit;</p>
</li>
</ol>
<h3 id="7-border-image-边界图片（应用背景）"><a href="#7-border-image-边界图片（应用背景）" class="headerlink" title="7. border-image 边界图片（应用背景）"></a><font color="#FF6060">7. border-image 边界图片（应用背景）</font></h3><ul>
<li>border-image:url(xxx.png) number style;</li>
<li>style:<br> stretch 拉伸<br> repeat 重复（会切割）<br> round 铺满（不会切割）</li>
<li>默认值：    none 100% 1 0 stretch<br>eg: border-image:url(‘图片’)  200 stretch; <div style="width:200px;height:50px;border: 30px solid;border-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg') 200 stretch"></div>


</li>
</ul>
<h3 id="8-box-shadow-盒子阴影"><a href="#8-box-shadow-盒子阴影" class="headerlink" title="8. box-shadow 盒子阴影"></a><font color="#FF6060">8. box-shadow 盒子阴影</font></h3><ul>
<li>box-shadow: [投影方式：outset/inset] 阴影水平偏移值（可取正负值） 阴影垂直偏移值（可取正负值） 阴影模糊值 阴影大小 阴影颜色;</li>
</ul>
<h3 id="9-text-shadow-文本阴影"><a href="#9-text-shadow-文本阴影" class="headerlink" title="9. text-shadow 文本阴影"></a><font color="#FF6060">9. text-shadow 文本阴影</font></h3><ul>
<li>text-shadow : X轴偏移量 Y轴偏移量 [阴影模糊半径] [阴影颜色];</li>
</ul>
<h3 id="10-word-wrap-文字边界换行"><a href="#10-word-wrap-文字边界换行" class="headerlink" title="10. word-wrap 文字边界换行"></a><font color="#FF6060">10. word-wrap 文字边界换行</font></h3><ul>
<li>normal  &nbsp;&nbsp;&nbsp;只在允许的断字点换行（浏览器保持默认处理）。<br>break-word  在长单词或 URL 地址内部进行换行。</li>
</ul>
<h3 id="11-background-clip-裁剪背景图片"><a href="#11-background-clip-裁剪背景图片" class="headerlink" title="11. background-clip 裁剪背景图片"></a><font color="#FF6060">11. background-clip 裁剪背景图片</font></h3><ul>
<li>background-clip : border-box / padding-box / content-box;<br><div style="width:400px;height:100px;background-repeat: no-repeat;background-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg');border:10px solid rgba(255,0,0,0.3);padding:40px;background-clip : border-box;color:#fff;">background-clip : border-box;</div><br><div style="width:400px;height:100px;background-repeat: no-repeat;background-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg');border:10px solid rgba(255,0,0,0.3);padding:40px;background-clip : padding-box;color:#fff">background-clip : padding-box;</div><br><div style="width:400px;height:100px;background-repeat: no-repeat;background-image:url('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg');border:10px solid rgba(255,0,0,0.3);padding:40px;background-clip : content-box;color:#fff">background-clip : content-box;</div><br>webkit独有属性，且必须配合-webkit-text-fill-color:transparent;使用。有需要的时候可以深入学习。 </li>
</ul>
<h2 id="二、css3选择器"><a href="#二、css3选择器" class="headerlink" title="二、css3选择器"></a><font color="#F33F50">二、css3选择器</font></h2><h3 id="1-属性选择器"><a href="#1-属性选择器" class="headerlink" title="1. 属性选择器"></a><font color="#FF6060">1. 属性选择器</font></h3><ul>
<li>E [ attr ^= ‘ val ‘ ]   开头<br>E [ attr $= ‘ val ‘ ]   结尾<br>E [ attr *= ‘ val ‘ ]   包含</li>
</ul>
<h3 id="2-初级伪类选择器"><a href="#2-初级伪类选择器" class="headerlink" title="2. 初级伪类选择器"></a><font color="#FF6060">2. 初级伪类选择器</font></h3><blockquote>
<p>伪类用于向某些选择器添加特殊效果</p>
</blockquote>
<h4 id="root-根标签选择器"><a href="#root-根标签选择器" class="headerlink" title=":root 根标签选择器"></a>:root 根标签选择器</h4><ul>
<li>:root{background:orange;}<br>:html{background:orange;}    二者等同</li>
</ul>
<h4 id="not-否定选择器"><a href="#not-否定选择器" class="headerlink" title=":not 否定选择器"></a>:not 否定选择器</h4><ul>
<li>div:not([class=’demo’]){background:orange;}</li>
</ul>
<h4 id="empty-空标签选择器"><a href="#empty-空标签选择器" class="headerlink" title=":empty 空标签选择器"></a>:empty 空标签选择器</h4><blockquote>
<p>空格也算内容，伪元素不算</p>
</blockquote>
<ul>
<li>p:empty{background:orange;}</li>
</ul>
<h4 id="target-目标元素选择器"><a href="#target-目标元素选择器" class="headerlink" title="target 目标元素选择器"></a>target 目标元素选择器</h4><ul>
<li>用来匹配被location.hash选中的元素（即锚点元素）选择器可用于选取当前活动的目标元素。</li>
</ul>
<h4 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h4><ul>
<li><p>:first-child<br>:last-child<br>:nth-child(){},n代表自然数<br>eg : ul li:nth-child(1){ul的第一个li，其中括号里还可以是3n+1这种表达式}<br>   :nth-last-child(){}</p>
</li>
<li><p>:first-of-type<br>:last-of-type<br>:nth-of-type(){}<br>:nth-last-of-type(){}</p>
</li>
<li><p>:only-child 唯一子元素选择器<br>选择是独生子的子元素，即该子元素不能有兄弟元素，它的父元素只有他一个直接子元素。<br>:only-of-type 类唯一选择器</p>
</li>
<li><p>:enabled 可用的元素<br>:disabled 不可用的元素，如web表单，输入框等</p>
</li>
<li><p>:checked选择框的被选中状态</p>
</li>
<li><p>:read-only 只读元素选择器<br>:read-write 非只读元素选择器（读写）<br>eg :&lt; input type=’text’ readonly=’readonly’/&gt; <input type="text" readonly="readonly" value="只可以读，不可以写"></p>
<pre><code>&lt; input type=&apos;text&apos;/&gt; &lt;input type=&apos;text&apos; value=&apos;可以读，也可以写&apos;/&gt;
</code></pre></li>
</ul>
<h3 id="3-伪元素选择器"><a href="#3-伪元素选择器" class="headerlink" title="3. 伪元素选择器"></a><font color="#FF6060">3. 伪元素选择器</font></h3><ul>
<li>伪元素的效果是通过添加一个实际的元素才能达到的。</li>
<li>::selection 用来匹配突出显示的文本<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;.sele::selection&#123;background: red;color: green;&#125;&lt;/style&gt;</span><br><span class="line">&lt;div&gt;选中我&lt;span class = &apos;sele&apos;&gt;突出显示&lt;/span&gt;你就知道了&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><style>.sele::selection{background: red;color: green;}</style></p>
<div>选中我<span class="sele">突出显示</span>你就知道了</div>

<h3 id="4-条件选择器"><a href="#4-条件选择器" class="headerlink" title="4. 条件选择器"></a><font color="#FF6060">4. 条件选择器</font></h3><ul>
<li>直接子元素div&gt;li{}<br>后面紧挨的兄弟节点div li+p{}<br>后面的兄弟节点ul li~p{}<br>ul li~*{}</li>
</ul>
<h2 id="三、css3提升部分"><a href="#三、css3提升部分" class="headerlink" title="三、css3提升部分"></a><font color="#F33F50">三、css3提升部分</font></h2><h3 id="1、transform-可以实现元素的形状、位置、角度、缩放等的变化"><a href="#1、transform-可以实现元素的形状、位置、角度、缩放等的变化" class="headerlink" title="1、transform 可以实现元素的形状、位置、角度、缩放等的变化"></a><font color="#FF6060">1、transform 可以实现元素的形状、位置、角度、缩放等的变化</font></h3><ul>
<li><p>skew();对元素进行倾斜扭曲<br>skew(x , y);接受两个值，第一个参数对应x轴，第二个参数对应y轴，如果第二个参数未提供，则默认0<br>skewX()，skewY()。<br>translate();可以移动距离，相对于自身位置。<br>translate( x , [y] );<br>translateX() ,translateY() ,translateZ() ,translate3d(x,y,z);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  .test &#123; width: 100px;height: 100px;background-color: red;transform: skew(10deg, 10deg); &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div class=&apos;test&apos;&gt;test&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p><style>.test {width: 100px;height: 100px;background-color: red;transform: skew(10deg, 10deg);}<br></style></p>
<div class="test">test</div>
</li>
<li><p>rotate();    以x/y/z为轴进行旋转，默认<br>rotateX(); rotateY(); rotateZ(); rotate3d( x , y , z , angle );<br>scale();      以x / y轴进行缩放<br>scale( x , y ); scaleX() , scaleY() , scaleZ() , scale3d()     值是数字表示倍数，不加任何单位。</p>
<p><strong>tranform-origin 变换原点</strong><br>  transform-origin: 0% 0%;&nbsp;&nbsp;&nbsp;&nbsp;left top;&nbsp;&nbsp;&nbsp;&nbsp;top center;&nbsp;&nbsp;&nbsp;&nbsp;0 50%;</p>
<p><strong>水平垂直居中</strong><br>position: absolute; top: 50%; left: 50%;<font color="Cornislk">transform: translateX(-50%) translateY(-50%);</font></p>
<p><style>.cent{position:absolute;top:50%;left:50%;transform:translateX(-50%) translateY(-50%);text-align: center;}</style></p>
<div style="position: relative;width: 100%;height: 200px;border: 1px dotted;"><div class="cent" style="width:100px;height:100px;background:rgb(255, 215, 0);border-radius:50%;line-height:100px;color:#fff;">水平垂直居中</div></div>


</li>
</ul>
<h3 id="3-transition-过渡动画"><a href="#3-transition-过渡动画" class="headerlink" title="3. transition 过渡动画"></a><font color="#FF6060">3. transition 过渡动画</font></h3><ul>
<li>复合属性<br>transition-property<br>transition-duration<br>transition-timing-function<br>transition-delay</li>
</ul>
<h3 id="4-animation-动画"><a href="#4-animation-动画" class="headerlink" title="4. animation 动画"></a><font color="#FF6060">4. animation 动画</font></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@keyframes demoMove&#123;</span><br><span class="line">  0% &#123;</span><br><span class="line">    background-color:red;</span><br><span class="line">  &#125;</span><br><span class="line">  20% &#123;</span><br><span class="line">    background-color:yellow;</span><br><span class="line">  &#125;</span><br><span class="line">  50% &#123;</span><br><span class="line">    width:200px;</span><br><span class="line">  &#125;</span><br><span class="line">  100% &#123; </span><br><span class="line">    height:200px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>animation(name, duration, timing-function, delay, direction, iteration-count, fill-mode);<br>animation-name  keyframes动画关键帧的名，如demoMove<br>duration  动画执行时间<br>timing-function  过渡函数速率<br>delay  执行延迟时间<br>direction  动画播放方向： </p>
<blockquote>
<p>normal默认正常，reverse反向播放，alternate奇数次正向，偶数次反向，alternate-reverse奇数次反向，偶数次正向</p>
</blockquote>
<p>iteration-count  动画播放次数：n次数/infinite无限次<br>animation-fill-mode动画开始之前和结束之后的操作 ：</p>
<blockquote>
<p>none  默认值，表示动画按预期进行和结束，在动画完成最后一帧时，转到初始帧。<br>  forwards  表示动画在结束后继续应用最后的关键帧位置<br>  backwards 会在元素应用动画样式时迅速应用动画的初始帧<br>  both  元素动画同时具有forwards和backwards效果</p>
</blockquote>
</li>
</ul>
<h3 id="5-columns-多列布局"><a href="#5-columns-多列布局" class="headerlink" title="5. columns 多列布局"></a><font color="#FF6060">5. columns 多列布局</font></h3><ul>
<li>columns: [ column-width最小宽度(根据容器自适应) ][ column-count列数 ] ;<font color="Cornislk">两个不要一起用，会乱！</font><br>column-gap 列间距 默认是根据浏览器默认的font-size来定(12px)，不允许为负值或0，依旧有列间距<br>column-rule 列边框，复合值，不影响内容，不可为负值，不可为浮点数。<br>column-rule-width 默认值medium，其他值thick、thin<br>column-rule-style 默认值是none，其他值hidden、dotted、dashed、solid、double<br>column-rule-color 同border<br>column-span : 1|all;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  .colu &#123;</span><br><span class="line">    columns: 100px;</span><br><span class="line">    column-rule: 5px solid red;</span><br><span class="line">    column-gap: 30px;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div class=&apos;colu&apos;&gt;</span><br><span class="line">  &lt;div&gt;&lt;span&gt;111&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">  &lt;div&gt;&lt;span&gt;222&lt;/span&gt;&lt;/div&gt;</span><br><span class="line">  &lt;span&gt;333&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><style>.colu{columns:100px;column-rule:5px solid red;column-gap:30px;}</style></p>
<div class="colu"><div><span>111</span></div><div><span>222</span></div><span>333</span></div>

<h3 id="6-hack"><a href="#6-hack" class="headerlink" title="6. hack"></a><font color="#FF6060">6. hack</font></h3><p>column-width = (width - ( n - 1 ) * font-size ) / n  ;   (n &gt;= 2)</p>
<h3 id="7-盒模型"><a href="#7-盒模型" class="headerlink" title="7. 盒模型"></a><font color="#FF6060">7. 盒模型</font></h3><ul>
<li><p>w3c标准盒模型：元素实际宽高 = width / height + padding + border<br>IE6混杂模式下的盒模型：</p>
<ul>
<li>元素实际宽高 = width / hwight</li>
<li>元素content宽高 = width/height - padding - border</li>
</ul>
<p>box-sizing : border-box | content-box;</p>
</li>
</ul>
<h3 id="8-弹性盒子-display-flex"><a href="#8-弹性盒子-display-flex" class="headerlink" title="8. 弹性盒子 display:flex;"></a><font color="#FF6060">8. 弹性盒子 display:flex;</font></h3><font color="red" size="2">复合属性，且必须配合 display : flex;使用</font>

<ul>
<li><p>1)  以下6个属性设置在容器上</p>
<pre><code>flex-direction     row | row-reverse | column | column-reverse
flex-wrap          nowrap(默认值) | wrap | wrap-reverse
flex-flow          复合： flex-direction flex-wrap
justify-content    flex-start | flex-end | center | space-between | space-around
align-items        flex-start | flex-end | center | baseline | stretch
align-content      flex-start | flex-end | center | space-between | space-around | stretch
</code></pre><p>2)  以下6个属性设置在子元素上</p>
<pre><code>flex-grow          拓展:两栏布局
flex-shrink        缩减的宽度 = (flex-shrink * width1) / (flex-shrink1 * width1 + flex-shrink2 * width2) * morell
flex-basis         伸缩基准值   宽度( flex-basis / flex-basis相加 ) * 容器的宽度 &gt; width
flex               复合： flex-grow  flex-shrink   flex-basis；（flex: auto 等同于 flex: 1 1 auto；） 
align-self         auto(默认值) | flex-start | flex-end | center | baseline | stretch 
</code></pre></li>
</ul>
<h3 id="9-transparent-透明色颜色值"><a href="#9-transparent-透明色颜色值" class="headerlink" title="9. transparent 透明色颜色值"></a><font color="#FF6060">9. transparent 透明色颜色值</font></h3><p>利用transparent画三角:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  width:0px;</span><br><span class="line">  height:0px;</span><br><span class="line">  border:50px solid red;</span><br><span class="line">  border-top-color:green;</span><br><span class="line">  border-left-color:transparent;</span><br><span class="line">  border-bottom-color:transparent;</span><br><span class="line">  border-right-color:transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><style>.train{width:0px;height:0px;border:50px solid red;border-top-color:green;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}</style></p>
<div class="train"></div>

<h3 id="10-css3动画相关属性"><a href="#10-css3动画相关属性" class="headerlink" title="10. css3动画相关属性"></a><font color="#FF6060">10. css3动画相关属性</font></h3><ul>
<li>perspective:none; ( 默认值 )<br>perspective-origin:50% 50%; ( 默认值 )<br>backface-visibility:visible | hidden ; 在元素运动过程中，能否展示元素的背面<br>transform-style : float | preserve-3d ; <ul>
<li>1） 需设置在父元素中，高于任何嵌套的变形元素<br>2）设置了它的元素，不能再设置overflow:hidden;因为会导致preserve-3d失效</li>
</ul>
</li>
</ul>
<h2 id="四、响应式布局"><a href="#四、响应式布局" class="headerlink" title="四、响应式布局"></a><font color="#F33F50">四、响应式布局</font></h2><h3 id="1-媒体查询"><a href="#1-媒体查询" class="headerlink" title="1. 媒体查询"></a><font color="#FF6060">1. 媒体查询</font></h3><blockquote>
<p>Link和@media<br>  &lt; link rel=’stylesheet’ media=’screen and (max-width:600px)’ href=’xxx.css’/&gt;<br>  screen: 媒体类型MediaType<br>  媒体特性 Media Query = MediaType+css</p>
</blockquote>
<ul>
<li><strong>媒体类型：</strong><br>all所有设备<br>braille盲文<br>embossed盲文打印<br>handheld手持设备<br>print文档打印或打印预览模式<br>projection项目演示，比如幻灯片<br>screen彩色电脑屏幕<br>speech演讲<br>tty固定字母间距的网格媒体，比如电传打字机<br>tv电视</li>
</ul>
<p><font color="red">注：现在很少用Link和@media，因为存在兼容性问题。现在一般用直接的媒体查询@media</font><br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@media screen and (max-width:600px)&#123;...&#125;</span><br><span class="line">@media all and (max-width:100px) and (min-width:600px)&#123;...&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>指定备用功能：</strong> media = ‘screen and (min-width:769px) , print and (min-width:6in)’<br><strong>指定否定条件：</strong> media = ‘not screen and (monochrome)’<br><strong>向早期浏览器隐藏媒体查询：</strong> media = ‘only screen and (min-width:401px)’<br><strong>易混淆的宽高：</strong> device-width/height width/height</p>
<table class="textCenter"><tr><td><strong>属性</strong></td><td><strong>值</strong></td><td>Min/Max</td><td>描述</td></tr><tr><td>color</td><td>整数</td><td>yes</td><td>每种色彩的字节数</td></tr><tr><td>color-index</td><td>整数</td><td>yes</td><td>色彩表中的色彩数</td></tr><tr><td>device-aspect-ratio</td><td>整/整</td><td>yes</td><td>宽高比例</td></tr><tr><td>device-height</td><td>length</td><td>yes</td><td>设备屏幕的输出高度</td></tr><tr><td>device-width</td><td>length</td><td>yes</td><td>设备屏幕的输出宽度</td></tr><tr><td>grid</td><td>整数</td><td>no</td><td>是否是基于格栅的设备</td></tr><tr><td>height</td><td>length</td><td>yes</td><td>渲染界面的高度</td></tr><tr><td>monochrome</td><td>整数</td><td>yes</td><td>单色帧缓冲器中每像素字</td></tr><tr><td>resolution</td><td>分辨率</td><td>dpi/dpcm</td><td>分辨率</td></tr><tr><td>scan</td><td>Progressive</td><td>interlaced</td><td>tv媒体类型的扫描方式</td></tr><tr><td>width</td><td>length</td><td>yes</td><td>渲染界面的宽度</td></tr><tr><td>orientation</td><td>Portrait/landscape</td><td>no</td><td>横屏或竖屏</td></tr></table>                                      

<h3 id="2-物理像素和设备独立像素"><a href="#2-物理像素和设备独立像素" class="headerlink" title="2. 物理像素和设备独立像素"></a><font color="#FF6060">2. 物理像素和设备独立像素</font></h3><p><strong>设备像素又称物理像素（physical pixel）</strong>，设备能控制显示的最小单位。<br><strong>设备独立像素（Device Pixel）：</strong>(也叫密度无关像素)，代表一个可以由程序使用并控制的虚拟像素，然后由相关系统转换为物理像素。<br><strong>CSS像素</strong>是pixel，是编程用的单位，是实际不存在的。<br><strong>DPR(DevicePixelRatio，设备像素比)</strong> = 物理（设备）像素 / 设备独立像素 ；<br>以iphone6为例：<br>DPR是2，也就是2^2=4个物理像素对应1个设备独立像素，也就是1px对应4个物理像素。</p>
<h1 id="第三章、-积累"><a href="#第三章、-积累" class="headerlink" title="第三章、 积累"></a><font color="#DC143C">第三章、 积累</font></h1><h2 id="阴影"><a href="#阴影" class="headerlink" title="阴影"></a>阴影</h2><p>  box-shadow: 0 25px 20px #e9edf0;</p>
<h2 id="ol"><a href="#ol" class="headerlink" title="ol"></a>ol</h2><p>  自定义有序列表的样式<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ol &#123;</span><br><span class="line">  list-style: none;</span><br><span class="line">  counter-reset: li;</span><br><span class="line">&#125;</span><br><span class="line">ol li&#123;</span><br><span class="line">  position: relative;</span><br><span class="line">&#125;</span><br><span class="line">ol li::before &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  top: 6px;</span><br><span class="line">  left: -30px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 20px;</span><br><span class="line">  content: counter(li);</span><br><span class="line">  counter-increment: li;</span><br><span class="line">  color: #fff;</span><br><span class="line">  width: 20px;</span><br><span class="line">  height: 20px;</span><br><span class="line">  background: #49b1f5;</span><br><span class="line">  border-radius: 50%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/10/html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lemon">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/background22.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="小寒">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/10/html/" itemprop="url">html</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-10T09:38:38+08:00">
                2018-07-10
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/基础/" itemprop="url" rel="index">
                    <span itemprop="name">基础</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>HTML （ Hyper Text Markup Language，超文本标记语言） 是前端的三大基本语言之一。</p>
<h1 id="一、-HTML基础"><a href="#一、-HTML基础" class="headerlink" title="一、 HTML基础"></a><font color="#DC143C">一、 HTML基础</font></h1><h2 id="1-基础结构"><a href="#1-基础结构" class="headerlink" title="1. 基础结构"></a><font color="#F33F50">1. 基础结构</font></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang = <span class="string">'en'</span>&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>HTML标签：首尾呼应，相互嵌套，有特定含义。</li>
</ul>
<h2 id="2-简单标签"><a href="#2-简单标签" class="headerlink" title="2. 简单标签"></a><font color="#F33F50">2. 简单标签</font></h2><h3 id="lt-html-lt-html"><a href="#lt-html-lt-html" class="headerlink" title="&lt;html>&lt;/html>"></a><font color="#FC5603">&lt;html>&lt;/html></font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html lang = <span class="string">'en'</span>&gt; ...... &lt;/html&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>lang属性：告诉搜索引擎爬虫，我们的网站是什么语言的。如：中zh，英en，德de，法fr等。</p>
</blockquote>
<h3 id="lt-meta"><a href="#lt-meta" class="headerlink" title="&lt;meta/>"></a><font color="#FC5603">&lt;meta/></font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset = <span class="string">'UTF-8'</span>&gt;</span><br><span class="line">&lt;meta name = <span class="string">'keywords'</span> content = <span class="string">'淘宝,掏宝,网上购物,C2C,在线交易,交易市场,网上交易,交易市场,网上买,网上卖,购物网站,团购,网上贸易,安全购物,电子商务,放心买,供应,买卖信息,网店,一口价,拍卖,网上开店,网络购物,打折,免费开店,网购,频道,店铺'</span>&gt;</span><br><span class="line">&lt;meta name = <span class="string">'description'</span> content = <span class="string">'淘宝网 - 亚洲较大的网上交易平台，提供各类服饰、美容、家居、数码、话费/点卡充值… 数亿优质商品，同时提供担保交易(先收货后付款)等安全交易保障服务，并由商家提供退货承诺、破损补寄等消费者保障服务，让你安心享受网上购物乐趣！'</span>&gt;</span><br><span class="line">&lt;meta http-equiv = <span class="string">'cache-control'</span> content = <span class="string">'no-cache'</span>&gt;</span><br><span class="line">&lt;meta http-equiv = <span class="string">'expires'</span> content = <span class="string">'0'</span>&gt;</span><br><span class="line">&lt;meta http-equiv = <span class="string">'pragma'</span> content = <span class="string">'no-cache'</span>&gt;</span><br><span class="line">&lt;meta name = <span class="string">'viewport'</span> content = <span class="string">'width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no, viewport-fit=cover'</span>&gt;</span><br><span class="line">&lt;meta http-equiv = <span class="string">'X-UA-Compatible'</span> content = <span class="string">'IE=edge,chrome=1'</span>&gt;</span><br><span class="line">&lt;meta name = <span class="string">'HandheldFriendly'</span> content = <span class="string">'true'</span>&gt;</span><br><span class="line">&lt;meta name = <span class="string">'format-detection'</span> content = <span class="string">'telephone=no,email=no'</span>&gt;</span><br></pre></td></tr></table></figure>
<font size="1"> 1.charset字符集，现在一般都用UTF-8，以前还有gb2312，gbk，unicode等。<br>  2.keywords网站的关键字，便于网络爬虫检索。<br>  3.description描述，同上。<br>  4.cache-control缓存控制，content的值可以是：Public 、 Private 、 no-Cache 、 no-Store。<br>  5.expires期限，用于设定网页的到期时间。一旦网页过期，必须到服务器上重新传输。<br>  6.pragma编译，用于设定禁止浏览器从本地机的缓存中调阅页面内容，设定后一旦离开网页就无法从Cache中再调出。<br>  7.viewport视口，宽度等于设备宽度，初始视角是1倍视角，最大视角是1倍视角，最小视角是1倍视角，用户是否可以伸缩网页不可以，视角尺寸是覆盖。<br>  8.X-UA-Compatible兼容IE，如果IE有安装Google Chrome Frame，那么就走安装的组件，如果没有，Edge 模式通知 Windows Internet Explorer以最高级别的可用模式显示内容。<br>  9.HandheldFriendly手持式友好，针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓<br>  10.format-detection格式监测，禁止将页面中的一连串数字识别为电话号码并设置为手机可拨打的链接。告诉设备不识别邮箱，点击之后不自动发送。</font><br>  &lt;meta/>标签，还有更多设置，需要时可以进一步探索~<br>

<h3 id="lt-title-lt-title"><a href="#lt-title-lt-title" class="headerlink" title="&lt;title>&lt;/title>"></a><font color="#FC5603">&lt;title>&lt;/title></font></h3><h3 id="lt-h1-lt-h6"><a href="#lt-h1-lt-h6" class="headerlink" title="&lt;h1> ~ &lt;h6>"></a><font color="#FC5603">&lt;h1> ~ &lt;h6></font></h3><h3 id="lt-p-lt-p"><a href="#lt-p-lt-p" class="headerlink" title="&lt;p>&lt;/p>"></a><font color="#FC5603">&lt;p>&lt;/p></font></h3><h3 id="结构化标签-span、div"><a href="#结构化标签-span、div" class="headerlink" title="结构化标签:span、div"></a><font color="#FC5603">结构化标签:span、div</font></h3><h3 id="HTML编码"><a href="#HTML编码" class="headerlink" title="HTML编码"></a><font color="#FC5603">HTML编码</font></h3><p>文字分隔符  &amp;nbsp ;<br>左尖角号    &amp;lt ;<br>右尖角号    &amp;gt ;<br>换行     &lt;br/&gt;<br>水平线   &lt;hr/&gt;</p>
<h3 id="不建议使用的标签"><a href="#不建议使用的标签" class="headerlink" title="不建议使用的标签"></a><font color="#FC5603">不建议使用的标签</font></h3><p>&lt;strong>&lt;/strong>加粗标签<br>&lt;em>&lt;/em>斜体标签</p>
<p>&lt;address>&lt;/address>地址标签<br>&lt;del>&lt;/del>中划线（删除）标签</p>
<ul>
<li><font size="1">原则：结构样式行为相分离（html 结构，css 样式，js 交互行为）。<br>这种实现样式的标签，我们完全可以通过css操作不同标签来实现。</font><br><br></li>
</ul>
<h2 id="3-常用标签"><a href="#3-常用标签" class="headerlink" title="3. 常用标签"></a><font color="#F33F50">3. 常用标签</font></h2><h3 id="lt-img"><a href="#lt-img" class="headerlink" title="&lt;img/>"></a><font color="#FC5603">&lt;img/></font></h3><p>src: source 资源<br>alt: 占位内容<br>title: 图片标题</p>
<h3 id="lt-a-lt-a"><a href="#lt-a-lt-a" class="headerlink" title="&lt;a>&lt;/a>"></a><font color="#FC5603">&lt;a>&lt;/a></font></h3><ul>
<li><p>href : hyperText reference 超文本引用<br>1、URL（相对路径，绝对路径，链接）<a href="https://www.baidu.com" target="_blank" rel="noopener">baidu</a><br>2、锚点 <a href="#footer">↓</a><br>3、协议限定符<a href="javascript:{alert('点就点');console.log('123');}" target="_self">点我</a><br>4、tel &amp; mailTo  <a href="tel:123456" target="_blank" rel="noopener">123456</a>  <a href="mailto:123456@789.com" target="_blank" rel="noopener">123456@789.com</a></p>
</li>
<li><p>target属性: _self（默认值）、 _blank 、 _parent 、 _top</p>
</li>
</ul>
<h3 id="lt-ul-lt-li-lt-li-lt-ul"><a href="#lt-ul-lt-li-lt-li-lt-ul" class="headerlink" title="&lt;ul>&lt;li>&lt;/li>&lt;/ul>"></a><font color="#FC5603">&lt;ul>&lt;li>&lt;/li>&lt;/ul></font></h3><p>ul: unordered lists 无序列表 ( <font color=" red">不赞成使用</font> type : disc square circle )<br>ol: ordered lists 有序列表 ( type    : 1  A   a     I   i ， start : number ， reversed)<br>li: list item 列表项</p>
<h3 id="lt-table-lt-table"><a href="#lt-table-lt-table" class="headerlink" title="&lt;table>&lt;/table>"></a><font color="#FC5603">&lt;table>&lt;/table></font></h3><blockquote>
<p>&lt;table>&lt;tr>&lt;td>&lt;/td>&lt;/tr>&lt;/table><br>  简单的 HTML 表格由 table 元素以及一个或多个 tr、th 或 td 元素组成。<br>  tr 元素定义表格行，th 元素定义表头，td 元素定义表格单元。<br>  更复杂的HTML表格也可能包括 caption、col、colgroup、thead、tfoot以及 tbody 元素。</p>
</blockquote>
  <table><thead><tr><th>年</th><th>月</th><th>日</th></tr></thead><tbody><tr align="center"><td>1-1</td><td>1-2</td><td>1-3</td></tr><tr><td colspan="2">2-1</td><td rowspan="2">2-2</td></tr><tr><td>3-1</td></tr></tbody></table>


<h3 id="lt-form-lt-form"><a href="#lt-form-lt-form" class="headerlink" title="&lt;form>&lt;/form>"></a><font color="#FC5603">&lt;form>&lt;/form></font></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method = <span class="string">'get'</span> action = <span class="string">'/user/register'</span>&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      账号：</span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'text'</span> name = <span class="string">'username'</span>/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      密码：</span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'password'</span> name = <span class="string">'password'</span>/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      性别：</span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'radio'</span> name = <span class="string">'sex'</span> value = <span class="string">'1'</span> checked/&gt; 男</span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'radio'</span> name = <span class="string">'sex'</span> value = <span class="string">'2'</span>/&gt; 女</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">      爱好：</span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'checkBox'</span> name = <span class="string">'bobby'</span> value = <span class="string">'1'</span>/&gt; 唱  </span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'checkBox'</span> name = <span class="string">'bobby'</span> value = <span class="string">'2'</span> checked /&gt; 跳 </span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'checkBox'</span> name = <span class="string">'bobby'</span> value = <span class="string">'3'</span>/&gt; wrap  </span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'checkBox'</span> name = <span class="string">'bobby'</span> value = <span class="string">'4'</span>/&gt; 篮球🏀</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'submit'</span> value = <span class="string">'注册'</span> /&gt;   </span><br><span class="line">    &lt;input <span class="built_in">type</span> = <span class="string">'reset'</span> value = <span class="string">'取消'</span>/&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<p>  <form method="get" action="/user/register"><br>    账号：<input type="text" name="username" placeholder="请输入账号"><br>    密码：<input type="password" name="password" placeholder="请设置密码"><br>    民族：<select name="nation"><option name="han">汉族</option><option name="minority">少数民族</option></select><br>    性别：<input type="radio" name="sex" value="1" checked> 男 <input type="radio" name="sex" value="2"> 女<br>    爱好：<input type="checkBox" name="bobby" value="1"> 唱  <input type="checkBox" name="bobby" value="2" checked> 跳 <input type="checkBox" name="bobby" value="3"> wrap  <input type="checkBox" name="bobby" value="4"> 篮球🏀<br>    <input type="submit" value="注册">   <input type="reset" value="取消"><br>  </form></p>
<p><hr><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<h1 id="二、-HTML5"><a href="#二、-HTML5" class="headerlink" title="二、 HTML5"></a><font color="#DC143C">二、 HTML5</font></h1><h2 id="1、-canvas"><a href="#1、-canvas" class="headerlink" title="1、 canvas"></a><font color="#F33F50">1、 canvas</font></h2><p>  游戏、图表、动画、codepen.io（HTML5动效）<br>  最早在safari1.3中引入，IE9之前的浏览器不支持canvas。(<a href="http://caniuse.com，可测试兼容性" target="_blank" rel="noopener">http://caniuse.com，可测试兼容性</a>)</p>
<h3 id="1）使用"><a href="#1）使用" class="headerlink" title="1）使用"></a>1）使用</h3><h4 id="1-添加canvas标签"><a href="#1-添加canvas标签" class="headerlink" title="1. 添加canvas标签"></a>1. 添加canvas标签</h4><p>  获得canvas元素<br>  获得canvas上下文对象<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas id = <span class="string">'myCanvas'</span> width = 500 height = 500&gt;&lt;/canvas&gt;</span><br><span class="line">var canvas = document.getElementById(<span class="string">'myCanvas'</span>);</span><br><span class="line">var ctx = canvas.getContext(<span class="string">'2d'</span>);</span><br></pre></td></tr></table></figure></p>
<h4 id="2-两个对象"><a href="#2-两个对象" class="headerlink" title="2. 两个对象"></a>2. 两个对象</h4><p>  元素对象（canvas）和上下文对象（通过getContext(‘2d’)方法获取到的CanvasRenderingContext对象）。<br>  元素对象相当于画布，上下文对象相当于画笔，接下来所有操作是基于上下文对象的。</p>
<h4 id="3-线段"><a href="#3-线段" class="headerlink" title="3. 线段"></a>3. 线段</h4><p>  ctx.moveTo(x,y);   移动到x，y坐标点<br>  ctx.lineTo(x,y);从当前点绘制直线到x，y坐标<br>  ctx.stroke(); 描边<br>  ctx.strokeStyle=’red’; 设置描边颜色<br>  ctx.lineWidth = 20; 设置线段宽度<br>  ctx.closePath();闭合当前路径和回到起始点的区别<br>  ctx.fill();填充<br>  ctx.fillStyle=’green’; 设置填充颜色</p>
<ul>
<li>重点：fill 和 stroke方法都是作用在当前的所有子路径,完成一条路径后要重新开始另一条路径时，必须使用beginPath()方法（开始子路径的一个新的集合）。</li>
</ul>
<h4 id="4-矩形"><a href="#4-矩形" class="headerlink" title="4. 矩形"></a>4. 矩形</h4><p>  ctx.rect( x , y , dx , dy );<br>  ctx.fillRect( x , y , dx , dy );<br>  ctx.strokeRect( x , y , w , h );<br>  <font color="red">特殊点：strokeRect和fillRect自带beginPath属性。</font><br>  ctx.strokeStyle = ‘red’;<br>  ctx.strokeRect( 10 , 10 , 150 , 100 );<br>  ctx.strokeStyle = ‘black’;<br>  ctx.strokeRect( 200 , 10 , 100 , 150);</p>
<canvas id="myCanvas" width="600" height="200"></canvas>

<h4 id="5-擦除当前区域"><a href="#5-擦除当前区域" class="headerlink" title="5. 擦除当前区域"></a>5. 擦除当前区域</h4><p>  ctx.clearRect( x , y , dx , dy );<br>  <font color="red">不切断当前子路径，会擦除失效。</font><br>  ctx1.rect( 10 , 10 , 100 , 100 );<br>  ctx1.fill();<br>  ctx1.clearRect( 10 , 10 , 50 , 50);<br>  ctx1.beginPath();<br>  ctx1.rect(130,10,80,80);<br>  ctx1.fillStyle = ‘red’;<br>  ctx1.fill();</p>
<canvas id="myCanvas1" width="600" height="120"></canvas>

<h4 id="6-弧形"><a href="#6-弧形" class="headerlink" title="6. 弧形"></a>6. 弧形</h4><p>  arc( x , y , r , 起始弧度 ， 结束弧度 ， 弧形方向)；     角以弧度计，0顺时针，1逆时针</p>
<h4 id="7-圆角"><a href="#7-圆角" class="headerlink" title="7. 圆角"></a>7. 圆角</h4><p>  arc( x1 , y1 , x2 , y2 , r)；    角以弧度计，0顺时针，1逆时针</p>
<h4 id="8-贝塞尔曲线"><a href="#8-贝塞尔曲线" class="headerlink" title="8. 贝塞尔曲线"></a>8. 贝塞尔曲线</h4><p>  quadratucCurveTo( x1 , y1 , ex , ey); 二次贝塞尔曲线<br>  bezierCurveTo( x1 , y1 , x2 , y2 , ex , ey);三次贝塞尔曲线</p>
<h4 id="9-坐标轴转换"><a href="#9-坐标轴转换" class="headerlink" title="9. 坐标轴转换"></a>9. 坐标轴转换</h4><p>  translate( dx , dy);                    重新映射画布上的（ 0 ， 0）位置<br>  scale( sx , sy );                       缩放当前绘图及轴<br>  rotate( Math.PI )                       旋转当前绘图（弧度制）<br>  save()   restore()                      保存当前图像状态的一份拷贝，从栈中弹出存储的图形状态并恢复<br>  setTransform( a, b, c, d, e, f )   先重置再变换（水平旋转 水平倾斜 垂直倾斜 垂直缩放 水平移动 垂直移动）<br>  transform( a , b , c , d , e , f )      在之前的基础</p>
<h4 id="10-填充图案"><a href="#10-填充图案" class="headerlink" title="10. 填充图案"></a>10. 填充图案</h4><p>  createPattern( image , ‘repeat|repeat-x|repeat-y|no-repeat’ );<br>  image可以是img元素（Image对象）、canvas元素、video元素（有图形的）<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var canvas2 = document.getElementById(<span class="string">'myCanvas2'</span>);</span><br><span class="line">var ctx2 = canvas2.getContext(<span class="string">'2d'</span>);</span><br><span class="line">var oImg = document.getElementsByClassName(<span class="string">'fillPicture'</span>)[0];</span><br><span class="line">ctx2.fillStyle = ctx2.createPattern(oImg,<span class="string">'repeat-x'</span>);</span><br><span class="line">ctx2.fillRect(70,0,500,200);</span><br></pre></td></tr></table></figure></p>
<p><img class="fillPicture" style="opacity:0;width:0;height:0;" src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1577251943575&di=a4ef12d40891fb543a4b0a541b728246&imgtype=0&src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg"></p>
<canvas id="myCanvas2" width="600" height="200"></canvas>


<h4 id="11-渐变"><a href="#11-渐变" class="headerlink" title="11. 渐变"></a>11. 渐变</h4><p>  createLinearGradient( x1 , y1 , x2 , y2 );  线性渐变，必须在填充渐变的区域里定义渐变，否则无效<br>  createRadialGradient(x1,y1,r1,x2,y2,r2);    径向渐变，必须在填充渐变的区域里定义渐变，否则无效<br>  addColorStop( p , color );                  添加颜色变化<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var canvas3 = document.getElementById(<span class="string">"myCanvas3"</span>);</span><br><span class="line">var ctx3 = canvas3.getContext(<span class="string">'2d'</span>);</span><br><span class="line">var <span class="built_in">bg</span> = ctx2.createLinearGradient(0,0,0,500);</span><br><span class="line">bg.addColorStop(0,<span class="string">"red"</span>);</span><br><span class="line">bg.addColorStop(0.5,<span class="string">"green"</span>);</span><br><span class="line">ctx3.fillStyle = <span class="built_in">bg</span>;</span><br><span class="line">ctx3.fillRect(70,0,600,200);</span><br></pre></td></tr></table></figure></p>
<canvas id="myCanvas3" width="600" height="200"></canvas>

<h4 id="12-阴影"><a href="#12-阴影" class="headerlink" title="12. 阴影"></a>12. 阴影</h4><p>  shadowColor<br>  shadowOffsetX<br>  shadowOffsetY<br>  shadowBlur<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var canvas4 = document.getElementById(<span class="string">"myCanvas4"</span>);</span><br><span class="line">var ctx4 = canvas4.getContext(<span class="string">'2d'</span>);</span><br><span class="line">ctx4.fillStyle=<span class="string">"SeaGreen"</span>;</span><br><span class="line">ctx4.shadowColor = <span class="string">"pink"</span>;</span><br><span class="line">ctx4.shadowBlur = 10;</span><br><span class="line">ctx4.shadowOffsetX = 30;</span><br><span class="line">ctx4.shadowOffsetY = -20;</span><br><span class="line">ctx4.fillRect(80,30,460,140);</span><br></pre></td></tr></table></figure></p>
<canvas id="myCanvas4" width="600" height="180"></canvas>


<h4 id="13-文本"><a href="#13-文本" class="headerlink" title="13. 文本"></a>13. 文本</h4><p>  fillText(“文本” , x ,y);<br>  strokeText(“文本” , x ,y);<br>  measureText(“此属性了解就行”);<br>  font 字体<br>  textAlign : left(默认值) | center | right | start | end ;<br>  textBaseLine : top(默认值) | hanging(悬挂基线) | middle | alphabetic(标准的字母基线) | ideographic(表意字基线) | bottom;<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var canvas5 = document.getElementById(<span class="string">"myCanvas5"</span>);</span><br><span class="line">var ctx5 = canvas5.getContext(<span class="string">'2d'</span>);</span><br><span class="line">ctx5.textAlign = <span class="string">"left"</span>;</span><br><span class="line">ctx.textBaseLine = <span class="string">"hanging"</span></span><br><span class="line">ctx5.fillStyle = <span class="string">"deeppink"</span>;</span><br><span class="line">ctx5.font = <span class="string">'40px sans-serif'</span>;</span><br><span class="line">ctx5.fillText(<span class="string">"Hello World!"</span> , 70 ,50);</span><br><span class="line">ctx5.strokeText(<span class="string">"Hello World!"</span> , 320 ,50);</span><br></pre></td></tr></table></figure></p>
<canvas id="myCanvas5" width="600" height="60"></canvas>

<h4 id="14-线段样式"><a href="#14-线段样式" class="headerlink" title="14. 线段样式"></a>14. 线段样式</h4><p>  lineCap : butt | square | round ;<br>  lineJoin : miter | round | bevel ;<br>  miterLimit : 当lineJoin是miter时，用于控制斜接部分的长度，如果斜接长度超过miterLimit的值，<br>  lineCap变成bevel。注：实际上是大于limit*lineWidth/2的值，了解就好。</p>
<h4 id="15-裁剪"><a href="#15-裁剪" class="headerlink" title="15. 裁剪"></a>15. 裁剪</h4><p>  clip(); 当前路径外的区域不再绘制<br>  注：可在clip()前用save()保存，后续通过restore()恢复。</p>
<h4 id="16-合成"><a href="#16-合成" class="headerlink" title="16. 合成"></a>16. 合成</h4><p>  globalCompositeOperation = “source-over(默认值，w3c标准) | copy |  source-atop | source-in | source-out | destination-over | destination-atop | destination-out | destination-in | lighter | xor”<span style="color:red;margin-left:36px;"><br>  注：可在clip()前用save()保存，后续通过restore()恢复。</span></p>
<h4 id="17-全局透明度"><a href="#17-全局透明度" class="headerlink" title="17. 全局透明度"></a>17. 全局透明度</h4><p>  globalAlpha</p>
<h4 id="18-绘制图片"><a href="#18-绘制图片" class="headerlink" title="18. 绘制图片"></a>18. 绘制图片</h4><p>  drawImage();<br>  1个参数是img ( Image , canvas , video )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注：onload<br>  3个参数是( img , x , y ) 起始点坐标<br>  5个参数是( img , x , y , dx , dy ) 图片所存区域的宽高<br>  9个参数是( img , x1 , y1 , dx1 , dy1 , x2 , y2 , dx2 , dy2 ) canvas绘制的起始点和大小</p>
<h4 id="19-将canvas内容导出"><a href="#19-将canvas内容导出" class="headerlink" title="19. 将canvas内容导出!!!"></a>19. 将canvas内容导出!!!</h4><p>  canvas.toDataURL();   这是canvas自身的方法，不是上下文对象。<br>  将canvas的内容抽取成一张图片，base64编码格式。注：同源策略的限制。<br>  将canvas的内容放入img元素里<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;img class=<span class="string">"exportCan"</span>/&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var exportCan = document.getElementsByClassName(<span class="string">"exportCan"</span>)[0];</span><br><span class="line">exportCan.onload = <span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">    var data = canvas5.toDataURL();</span><br><span class="line">    this.src=data;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>  <img class="exportCan"></p>
<h4 id="20-获取canvas像素信息"><a href="#20-获取canvas像素信息" class="headerlink" title="20. 获取canvas像素信息"></a>20. 获取canvas像素信息</h4><p>  getImageData( x , y , dx , dy ); 受同源策略影响<br>  createImageData( w , h ); 创建新的空白ImageData对象<br>  putImageData( imgData , x , y ); 将图像数据放在画布上<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var canvas6 = document.getElementById(<span class="string">"myCanvas6"</span>);</span><br><span class="line">var ctx6 = canvas6.getContext(<span class="string">'2d'</span>);</span><br><span class="line">ctx6.fillStyle=<span class="string">"pink"</span>;</span><br><span class="line">ctx6.fillRect(70 , 0 , 100 , 100 );</span><br><span class="line">//对数据做处理，变成灰色</span><br><span class="line">var pixel = ctx6.getImageData(100 , 0 , 50 , 50);</span><br><span class="line">var row = pixel.width;</span><br><span class="line">var col = pixel.height;</span><br><span class="line">var d = pixel.data;</span><br><span class="line"><span class="keyword">for</span>(var i = 0 ; i &lt; row ; i++)&#123;</span><br><span class="line">    var c = i*col*4;</span><br><span class="line">    <span class="keyword">for</span>(var j = 0; j &lt; col ; j++)&#123;</span><br><span class="line">        d[c+j*4+3] = 100;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ctx6.putImageData(pixel,100,10);</span><br></pre></td></tr></table></figure></p>
<canvas id="myCanvas6" width="200" height="100"></canvas>

<h4 id="21-RGBA"><a href="#21-RGBA" class="headerlink" title="21. RGBA"></a>21. RGBA</h4><p>  R-red       红色 ( 0 ~ 255)<br>  G-green     绿色 ( 0 ~ 255)<br>  B-blue      蓝色 ( 0 ~ 255)<br>  A-alpha     通道 ( 0透明 ~ 255完全可见)</p>
<h4 id="22-命中检测isPointInPath-x-y-检测是否在区域内，chrome与safari的区别"><a href="#22-命中检测isPointInPath-x-y-检测是否在区域内，chrome与safari的区别" class="headerlink" title="22. 命中检测isPointInPath( x , y ); 检测是否在区域内，chrome与safari的区别"></a>22. 命中检测<div style="margin-left:46px;">isPointInPath( x , y ); 检测是否在区域内，chrome与safari的区别</div></h4><p>  isPointInStroke( x , y ); 检测是否在线上<br>  还可以通过检测当前点的像素值，如果为透明，则该点不在路径上。</p>
<h4 id="23-非零线数准则"><a href="#23-非零线数准则" class="headerlink" title="23. 非零线数准则"></a>23. 非零线数准则</h4><p>  判断点p是否在多边形内，从点p向外做一条射线（可以任意方向），多边形的边从左到右经过射线环绕数减一，多边形的边从右向左经过经过射线环绕数加一，最后环绕数不为零，即表示在多边形内部。</p>
<h4 id="24-如何解决canvas高分屏模糊问题"><a href="#24-如何解决canvas高分屏模糊问题" class="headerlink" title="24. 如何解决canvas高分屏模糊问题"></a>24. 如何解决canvas高分屏模糊问题</h4><p>  在分辨率比较高的屏幕，例如iphone6/iphone6s/mac等机器上，因为canvas绘制的是位图，所以会导致模糊，解决办法是根据屏幕分辨率修改canvas样式代码中的宽和高与canvas的width和height的比例。（大画框小画布是不对的，小画框大画布是对的）。</p>
<h3 id="2-实践"><a href="#2-实践" class="headerlink" title="2) 实践"></a>2) 实践</h3><h4 id="刮刮乐"><a href="#刮刮乐" class="headerlink" title="刮刮乐"></a>刮刮乐</h4>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas width=500 height=200 id=<span class="string">'ggl'</span>&gt;&lt;/canvas&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const oCanvas=document.getElementById(<span class="string">'ggl'</span>);</span><br><span class="line">const ctx = oCanvas.getContext(<span class="string">'2d'</span>);</span><br><span class="line">const w = oCanvas.width;</span><br><span class="line">const h = oCanvas.height;</span><br><span class="line">ctx.fillRect(0,0,w,h);</span><br><span class="line">ctx.fillStyle=<span class="string">'green'</span>;</span><br><span class="line">oCanvas.style.backgroundImage=<span class="string">'url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1577251943575&amp;di=a4ef12d40891fb543a4b0a541b728246&amp;imgtype=0&amp;src=http%3A%2F%2Fdik.img.kttpdq.com%2Fpic%2F19%2F13131%2Fc671a4a7144ee484_1024x768.jpg)'</span>;</span><br><span class="line">ctx.globalCompositeOperation=<span class="string">'destination-out'</span>;</span><br><span class="line"></span><br><span class="line">const start = (e) =&gt; &#123;</span><br><span class="line">  const x = e.clientX, y = e.clientY;</span><br><span class="line">  ctx.beginPath();</span><br><span class="line">  ctx.arc(x, y, 10, 0, Math.PI*2, 0);</span><br><span class="line">  ctx.fill();</span><br><span class="line">&#125;;</span><br><span class="line">const stop = (e) =&gt; &#123;</span><br><span class="line">  oCanvas.removeEventListener(<span class="string">'mousemove'</span>,start);</span><br><span class="line">  oCanvas.removeEventListener(<span class="string">'mouseup'</span>, stop);</span><br><span class="line">&#125;;</span><br><span class="line">oCanvas.addEventListener(<span class="string">'mousedown'</span>, () =&gt; &#123;</span><br><span class="line">  oCanvas.addEventListener(<span class="string">'mousemove'</span>, start, <span class="literal">false</span>);</span><br><span class="line">  oCanvas.addEventListener(<span class="string">'mouseup'</span>, stop, <span class="literal">false</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="高斯"><a href="#高斯" class="headerlink" title="高斯"></a>高斯</h4><p>这个有时间研究一下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas width=600 height=400 id=<span class="string">'gs'</span>&gt;&lt;/canvas&gt;</span><br><span class="line">&lt;script src=<span class="string">'./gs.js'</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  const oCanvas = document.getElementById(<span class="string">'gs'</span>);</span><br><span class="line">  const ctx = oCanvas.getContext(<span class="string">'2d'</span>);</span><br><span class="line">  const oImg = document.createElement(<span class="string">'img'</span>);</span><br><span class="line">  oImg.src = <span class="string">'https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=2248772065,1139700561&amp;fm=26&amp;gp=0.jpg'</span>;</span><br><span class="line">  oImg.onload = () =&gt; &#123;</span><br><span class="line">    ctx.drawImage(oImg, 0, 0, 500, 400);</span><br><span class="line">    const img = ctx.getImageData(0, 0, 500, 500);</span><br><span class="line">    gaussBlur(img);</span><br><span class="line">    ctx.putImageData(img, 0, 0);</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 可以再将画布变成图片输出</span></span><br><span class="line">    const data = oCanvas.toDataURL();</span><br><span class="line">    const oImg2 = new Image();</span><br><span class="line">    oImg2.src = data;</span><br><span class="line">    document.body.appendChild(oImg2);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="2、-SVG"><a href="#2、-SVG" class="headerlink" title="2、 SVG"></a><font color="#F33F50">2、 SVG</font></h2><p>  Scalable Vector Graphics 可缩放矢量图形</p>
<p>  图表、图标icon、动效、矢量图（矢量图缩放不失帧，位图缩 放会失帧，canvas画出的图是位图）</p>
<p>  最早在safari1.3中引入，IE9之前的浏览器不支持canvas。(<a href="http://caniuse.com，可测试兼容性" target="_blank" rel="noopener">http://caniuse.com，可测试兼容性</a>)</p>
<h3 id="1）使用-1"><a href="#1）使用-1" class="headerlink" title="1）使用"></a><strong>1）使用</strong></h3><h4 id="1-SVG元素"><a href="#1-SVG元素" class="headerlink" title="1. SVG元素"></a>1. SVG元素</h4>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;  svg&#123; border: 1px solid pink; &#125;&lt;/style&gt;</span><br><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"500"</span>å&gt;</span><br><span class="line">  直线&lt;line x1=<span class="string">"10"</span> y1=<span class="string">"10"</span> x2=<span class="string">"200"</span> y2=<span class="string">"10"</span>&gt;&lt;/line&gt;</span><br><span class="line">  矩形&lt;rect x=<span class="string">"20"</span> y=<span class="string">"20"</span> width=<span class="string">"100"</span> height=<span class="string">"100"</span> rx=<span class="string">"10"</span> ry=<span class="string">"20"</span>&gt;&lt;/rect&gt;</span><br><span class="line">  圆形&lt;circle r=<span class="string">"50"</span> cx=<span class="string">"70"</span> cy=<span class="string">"200"</span>&gt;&lt;/circle&gt;</span><br><span class="line">  椭圆&lt;ellipse rx=<span class="string">"100"</span> ry=<span class="string">"50"</span> cx=<span class="string">"100"</span> cy=<span class="string">"300"</span>&gt;&lt;/ellipse&gt;</span><br><span class="line">  折线&lt;polyline points=<span class="string">"20 370, 60 380, 75 365, 100 380, 125 365, 150 380, 175 365, 190 380"</span>&gt;&lt;/polyline&gt;</span><br><span class="line">  文本&lt;text x=<span class="string">"50"</span> y=<span class="string">"460"</span>&gt;helloWord&lt;/text&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>  <style>svg{border: 1px solid pink;}</style><br>  <svg width="500" height="500"><line x1="10" y1="10" x2="200" y2="10"/><rect x="20" y="20" width="100" height="100" rx="10" ry="20"/><circle r="50" cx="70" cy="200"/><ellipse rx="100" ry="50" cx="100" cy="300"/><polyline points="20 370, 60 380, 75 365, 100 380, 125 365, 150 380, 175 365, 190 380"/><text x="50" y="460">helloWord</text></svg></p>
<h4 id="2-样式属性"><a href="#2-样式属性" class="headerlink" title="2. 样式属性"></a>2. 样式属性</h4><p>  fill<br>  stroke<br>  stroke-width<br>  stroke-opacity / fill-opacity<br>  stroke-linecap (butt/round/square)<br>  stroke-linejoin (beval/round/miter)</p>
<p>  <style>svg{border:4px solid pink;}.circle{fill:black;stroke:black;}.rect,.eyek,.ellipse{fill:white;stroke:black;stroke-width:4px;}.lineduan{stroke:black;stroke-width:4px;stroke-linecap:round;}.text{font-size:20px;fill:#0ff;stroke:#0ff;}</style><br>  <svg width="350" height="300"><text class="text" x="35" y="35">A good boy!</text><polyline points="110 90,125 60, 160 90, 200 60, 240 90, 275 60,290 90"/><rect class="rect" x="90" y="90" width="220" height="200" rx="30" ry="30"/><circle class="circle eyek" r="25" cx="150" cy="160"/><circle class="circle eyek" r="25" cx="250" cy="160"/><circle calss="circle" r="10" cx="160" cy="170"/><circle class="circle" r="10" cx="260" cy="170"/><line class="lineduan" x1="200" y1="180" x2="190" y2="210"/><line class="lineduan" x1="200" y1="180" x2="210" y2="210"/><line class="lineduan" x1="190" y1="210" x2="210" y2="210"/><ellipse class="ellipse" rx="40" ry="20" cx="200" cy="260"/></svg></p>
<h4 id="3-path元素"><a href="#3-path元素" class="headerlink" title="3. path元素"></a>3. path元素</h4>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"410"</span>&gt;</span><br><span class="line">  M L &lt;path d=<span class="string">"M 10 10 L 20 10"</span>/&gt;绝对定位</span><br><span class="line">  m l &lt;path d=<span class="string">"m 10 10 l 20 10"</span>/&gt;相对定位</span><br><span class="line">  H V &lt;path d=<span class="string">"M 30 40 H 100 V 100"</span>/&gt;横 竖绝对</span><br><span class="line">  h v &lt;path d=<span class="string">"m 10 100 h 100 v 100"</span>/&gt;横 竖相对</span><br><span class="line">  Z   &lt;path d=<span class="string">"M 10 220 H 200 V 200 Z"</span>/&gt;闭合</span><br><span class="line">  A   &lt;path d=<span class="string">"M 100 300 A 70 70 90 1 1 150 400"</span>/&gt;圆弧指令</span><br><span class="line"> （</span><br><span class="line">    x1，起点x轴坐标</span><br><span class="line">    y1，起点y轴坐标</span><br><span class="line">    rx圆弧的x轴半径</span><br><span class="line">    ry圆弧的y轴半径</span><br><span class="line">    x-axis-rotation圆弧相对x轴的旋转角度默认是顺时针，可设置负值</span><br><span class="line">    large-arc-flag，从A点到B点绘制一条弧线，可以得到两条不同的弧线。一条较大，另一条较小。large-arc-flag就是用于决定到底是绘制较大的那一条弧线还是绘制较小的那一条弧线，1-&gt;大圆弧</span><br><span class="line">    sweep-flag从起点到终点是顺/逆时针，1 顺 0 逆</span><br><span class="line">    x2，终点x轴坐标</span><br><span class="line">    y2，终点y轴坐标</span><br><span class="line">  ）</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>  <style>path{fill:transparent;stroke:black;}</style><br>  <svg width="500" height="260"><path d="M 10 10 L 20 10"/><path d="m 10 10 l 20 10"/><path d="M 30 40 H 100 V 100"/><path d="m 10 100 h 100 v 100"/><path d="M 10 220 H 200 V 200 Z"/><path d="M 300 100 A 70 70 90 1 1 400 150"/></svg></p>
<ul>
<li><p>贝塞尔曲线</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">二次贝塞尔曲线</span><br><span class="line">&lt;style&gt;.one&#123;fill:transparent;stroke:green;&#125;.two&#123;fill:transparent;stroke:orange;&#125;.three&#123;fill:transparent;stroke:pink;&#125;&lt;/style&gt;</span><br><span class="line">Q &lt;path d=<span class="string">"M 100 100 Q 200 0 300 300"</span>  class=<span class="string">"one"</span>/&gt;</span><br><span class="line">T &lt;path d=<span class="string">"M 100 100 A 200 0 300 300 T 500 0"</span> class=<span class="string">"two"</span>/&gt;</span><br><span class="line"></span><br><span class="line">三次贝塞尔曲线</span><br><span class="line">C &lt;path d=<span class="string">"M 100 300 C 80 100 180 100 240 100"</span> class=<span class="string">"three"</span>/&gt;</span><br></pre></td></tr></table></figure>
<p><style>.one{fill:transparent;stroke:green;}.two{fill:transparent;stroke:orange;}.three{fill:transparent;stroke:pink;</style></p>
<svg width="500" height="410"><path d="M 0 0 Q 100 0 200 200" class="one"/><path d="M 100 100 Q 200 0 300 300 T 500 0" class="two"/><path d="M 100 300 C 80 100 180 100 240 100" class="three"/></svg>

<p>自动生成路径：<a href="https://editor.method.ac/" target="_blank" rel="noopener">https://editor.method.ac/</a></p>
</li>
</ul>
<h4 id="4-SVG渐变"><a href="#4-SVG渐变" class="headerlink" title="4. SVG渐变"></a>4. SVG渐变</h4>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">线性渐变：</span><br><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"410"</span>&gt;</span><br><span class="line">  &lt;defs&gt;</span><br><span class="line">    &lt;linearGradient id=<span class="string">"bg1"</span> x1=<span class="string">"0"</span> y1=<span class="string">"0"</span> x2=<span class="string">"0"</span> y2=<span class="string">"100%"</span>&gt;</span><br><span class="line">      &lt;stop offset=<span class="string">"0%"</span> style=<span class="string">"stop-color:rgb(155,155,0);"</span>/&gt;</span><br><span class="line">      &lt;stop offset=<span class="string">"100%"</span> style=<span class="string">"stop-color:rgb(255,0,0)"</span>/&gt;</span><br><span class="line">    &lt;/linearGradient&gt;</span><br><span class="line">  &lt;/defs&gt;</span><br><span class="line">  &lt;rect x=<span class="string">"0"</span> y=<span class="string">"0"</span> width=<span class="string">"500"</span> height=<span class="string">"410"</span> style=<span class="string">"fill:url(#bg1)"</span>/&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
  <svg width="500" height="410"><defs><lineargradient id="bg1" x1="0" y1="0" x2="0" y2="100%"><stop offset="0%" style="stop-color:rgb(155,155,0);"/><stop offset="100%" style="stop-color:rgb(255,0,0)"/></lineargradient></defs><rect x="0" y="0" width="500" height="410" style="fill:url(#bg1)"/></svg>


 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">径向渐变：</span><br><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"410"</span>&gt;</span><br><span class="line">  &lt;defs&gt;</span><br><span class="line">    &lt;radialGradient id=<span class="string">"bg3"</span> cx=<span class="string">"50%"</span> cy=<span class="string">"50%"</span> r=<span class="string">"60%"</span> fx=<span class="string">"60%"</span> fy=<span class="string">"50%"</span>&gt;</span><br><span class="line">      &lt;stop offset=<span class="string">"0%"</span> style=<span class="string">"stop-color:rgb(155,155,0);"</span>/&gt;</span><br><span class="line">      &lt;stop offset=<span class="string">"100%"</span> style=<span class="string">"stop-color:rgb(255,0,0)"</span>/&gt;</span><br><span class="line">    &lt;/radialGradient&gt;</span><br><span class="line">  &lt;/defs&gt;</span><br><span class="line">  &lt;rect x=<span class="string">"0"</span> y=<span class="string">"0"</span> width=<span class="string">"500"</span> height=<span class="string">"410"</span> style=<span class="string">"fill:url(#bg3)"</span>/&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
  <svg width="500" height="410"><defs><radialgradient id="bg2" cx="50%" cy="50%" r="50%" fx="60%" fy="60%"><stop offset="0%" style="stop-color:rgb(200,250,0);"/><stop offset="100%" style="stop-color:rgb(250,0,205)"/></radialgradient></defs><rect x="0" y="0" width="500" height="410" style="fill:url(#bg2)"/></svg>

<h4 id="5-SVG滤镜"><a href="#5-SVG滤镜" class="headerlink" title="5. SVG滤镜"></a>5. SVG滤镜</h4><p>  高斯滤镜<br>  <a href="http://www.w3cshool.com.cn/svg/svg-filters_intro.asp" target="_blank" rel="noopener">其他滤镜</a><br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"410"</span>&gt;</span><br><span class="line">  &lt;defs&gt;</span><br><span class="line">    &lt;filter id=<span class="string">"Gaussian_blur"</span>&gt;</span><br><span class="line">      &lt;feGaussianBlur <span class="keyword">in</span>=<span class="string">"SourceGraphic"</span> stdDeviation=<span class="string">"20"</span>/&gt;</span><br><span class="line">    &lt;/filter&gt;</span><br><span class="line">  &lt;/defs&gt;</span><br><span class="line">  &lt;rect x=<span class="string">"0"</span> y=<span class="string">"0"</span> width=<span class="string">"500"</span> height=<span class="string">"410"</span> fill=”yellow“ style=<span class="string">"filter:url(#Gaussian_blur)"</span> /&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></p>
  <svg width="500" height="410"><defs><filter id="Gaussian_blur"><fegaussianblur in="SourceGraphic" stddeviation="20"/></filter></defs><rect x="0" y="0" width="500" height="410" fill="”yellow“" style="filter:url(#Gaussian_blur)"/></svg>

<h4 id="6-SVG路径动画"><a href="#6-SVG路径动画" class="headerlink" title="6. SVG路径动画"></a>6. SVG路径动画</h4><p>  stroke-dasharray: 100px;     画100空100, 100px 300px画100空300  10 20 30 40 画10空20画30空40<br>  stroke-dashoffset: 15px;     左右移动<br>  动画实现原理，通过修改stroke-dashoffset的值让路径慢慢地展示出来<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  .move &#123;</span><br><span class="line">    stroke: <span class="comment">#f00;</span></span><br><span class="line">    stroke-dasharray: 80 60;</span><br><span class="line">    stroke-dashoffset: -100;</span><br><span class="line">    animation: dash 8s infinite linear forwards;</span><br><span class="line">  &#125;</span><br><span class="line">  @keyframes dash &#123;</span><br><span class="line">    from &#123;  </span><br><span class="line">      stroke-dashoffset: 2000;</span><br><span class="line">    &#125;</span><br><span class="line">    to &#123;  </span><br><span class="line">      stroke-dasharray: 10 20 30 10;  </span><br><span class="line">      stroke-dashoffset: 0;  </span><br><span class="line">      stroke: green;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"410"</span>&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 10 10 L 20 500"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 100 10 L 100 400"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 350 100 L 350 300"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 200 30 L 200 300"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 140 30 L 150 300"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 300 30 L 300 400"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 400 30 L 390 200"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">  &lt;path d=<span class="string">"M 480 30 L 480 200"</span> class=<span class="string">"move"</span> /&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></p>
<p> <style>.move {stroke: #f00;stroke-dasharray: 80 60;stroke-dashoffset: -100;animation: dash 8s infinite linear forwards;}@keyframes dash {from {  stroke-dashoffset: 2000;}to {  stroke-dasharray: 10 20 30 10;  stroke-dashoffset: 0;  stroke: green;}}</style><br>  <svg width="500" height="410"><path d="M 10 10 L 20 500" class="move"/><path d="M 100 10 L 100 400" class="move"/><path d="M 350 100 L 350 300" class="move"/><path d="M 200 30 L 200 300" class="move"/><path d="M 140 30 L 150 300" class="move"/><path d="M 300 30 L 300 400" class="move"/><path d="M 400 30 L 390 200" class="move"/><path d="M 480 30 L 480 200" class="move"/></svg></p>
<h4 id="7-SVG路径"><a href="#7-SVG路径" class="headerlink" title="7. SVG路径"></a>7. SVG路径</h4><p>getTotalLength： 获取路径长度<br>getPointAtLength： 获取路径上距离起始点距离x的点的坐标</p>
<div class="post-warning">严格来说，这两个方法只适用于path元素，但各浏览器实现起来有区别，如：chrome也能获取到line元素的路径长度</div>

<h4 id="8-viewBox"><a href="#8-viewBox" class="headerlink" title="8. viewBox"></a>8. viewBox</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg width=<span class="string">"500"</span> height=<span class="string">"410"</span> viewBox=<span class="string">'0,0,40,30'</span> preserveAspectRatio=<span class="string">"xMinYMid meet"</span>&gt;&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>xMin xMid xMax  x轴 左中右对齐<br>yMin yMid yMax  y轴 左中右对齐</p>
<ul>
<li>preserveAspectRatio 设置填充方式<br>meet    保持宽高比并将viewBox缩放为适合viewport的大小<br>slice    保持宽高比并将所有不在viewport中的viewBox剪裁掉<br>none    不保存宽高比。缩放图像适合整个viewbox，可能会发生图像变形</li>
</ul>
<h4 id="9-JS生成SVG元素"><a href="#9-JS生成SVG元素" class="headerlink" title="9. JS生成SVG元素"></a>9. JS生成SVG元素</h4><p>创建SVG元素需要指定命名空间，SVG元素对象一般通过调用setAttribute()来设定属性。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var char = <span class="string">'http://www.w3.org/2000/svg'</span>;</span><br><span class="line">var svg = document.createElementNS(char, <span class="string">'svg'</span>);</span><br><span class="line">svg.setAttribute(<span class="string">'width'</span>, 500);</span><br><span class="line">svg.setAttribute(<span class="string">'height'</span>, 500);</span><br><span class="line">svg.setAttribute(<span class="string">'viewBox'</span>, <span class="string">'0 0 500 500'</span>);</span><br><span class="line"></span><br><span class="line">var rect = document.createElementNS(char, <span class="string">'rect'</span>);</span><br><span class="line">rect.setAttribute(<span class="string">'x'</span>, 20);</span><br><span class="line">rect.setAttribute(<span class="string">'y'</span>, 30);</span><br><span class="line">rect.setAttribute(<span class="string">'width'</span>, 20);</span><br><span class="line">rect.setAttribute(<span class="string">'height'</span>, 30);</span><br><span class="line">rect.setAttribute(<span class="string">'fill'</span>, <span class="string">'red'</span>);</span><br><span class="line"></span><br><span class="line">svg.appendChild(rect);</span><br><span class="line">document.body.appendChild(svg);</span><br></pre></td></tr></table></figure></p>
<h3 id="2）SVG实例"><a href="#2）SVG实例" class="headerlink" title="2）SVG实例"></a>2）SVG实例</h3><h4 id="字"><a href="#字" class="headerlink" title="字"></a>字</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  path &#123;</span><br><span class="line">    stroke: <span class="comment">#2d5c7b;</span></span><br><span class="line">    fill: transparent;</span><br><span class="line">  &#125;</span><br><span class="line">  @keyframes show &#123;</span><br><span class="line">    to &#123;</span><br><span class="line">      stroke-dashoffset: 0;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;svg width=<span class="string">"800"</span> height=<span class="string">"600"</span> xmlns=<span class="string">"http://www.w3.org/2000/svg"</span>&gt;</span><br><span class="line">  &lt;!-- Created with Method Draw - http://github.com/duopixel/Method-Draw/ --&gt;</span><br><span class="line">  &lt;g&gt;</span><br><span class="line">   &lt;title&gt;background&lt;/title&gt;</span><br><span class="line">   &lt;rect fill=<span class="string">"#fff"</span> id=<span class="string">"canvas_background"</span> height=<span class="string">"602"</span> width=<span class="string">"802"</span> y=<span class="string">"-1"</span> x=<span class="string">"-1"</span>/&gt;</span><br><span class="line">   &lt;g display=<span class="string">"none"</span> overflow=<span class="string">"visible"</span> y=<span class="string">"0"</span> x=<span class="string">"0"</span> height=<span class="string">"100%"</span> width=<span class="string">"100%"</span> id=<span class="string">"canvasGrid"</span>&gt;</span><br><span class="line">    &lt;rect fill=<span class="string">"url(#gridpattern)"</span> stroke-width=<span class="string">"0"</span> y=<span class="string">"0"</span> x=<span class="string">"0"</span> height=<span class="string">"100%"</span> width=<span class="string">"100%"</span>/&gt;</span><br><span class="line">   &lt;/g&gt;</span><br><span class="line">  &lt;/g&gt;</span><br><span class="line">  &lt;g&gt;</span><br><span class="line">   &lt;title&gt;Layer 1&lt;/title&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m176.5,126.45313c0,1 0,2 0,3c0,2 0,4 0,7c0,3 0,7 0,10c0,3 0,6 0,9c0,3 0,9 0,13c0,4 0,7 0,11c0,4 0,8 0,12c0,5 -0.61092,9.03746 0,14c0.50377,4.09221 1,8 1,13c0,2 0,4 0,4c0,1 0,1 1,1c0,0 0,-1 0,-2c0,-2 0,-5 0,-7c0,-3 0,-5 0,-8c0,-4 0,-6 0,-8c0,-2 0,-3 0,-4c0,0 0,-1 0,-1c0,0 0,0 0,-1c0,0 0,0 1,-1c0,0 0,-1 1,-2c0,0 1,-1 2,-2c1,-1 2,-2 4,-4c2,-2 3.41885,-3.41885 5,-5c1.58115,-1.58115 3.02675,-1.77025 4,-2c2.17625,-0.51375 3,-1 4,-1c1,0 3.07613,-0.38269 4,0c1.30656,0.5412 2,1 3,2c1,1 1.67964,3.02582 2,5c0.50655,3.12144 1.51126,6.02997 2,10c0.50377,4.09221 2.49345,7.87856 3,11c0.48055,2.96126 1,5 1,8c0,1 0,2 1,2l0,1l0,0l0,-1"</span> id=<span class="string">"svg_1"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m262.5,182.45313c0,0 -1,0 -1,0c-1,0 -2,0 -4,0c-1,0 -3,-1 -4,-1c-1,0 -3,0 -4,0c-1,0 -3,0 -4,0c-1,0 -2,0 -3,0c0,0 -1,0 -1,0c-1,0 -1,0 -1,0c-1,1 -1,1 -1,1c-1,1 -0.61731,1.07613 -1,2c-0.5412,1.30656 -1.4588,1.69344 -2,3c-0.38269,0.92387 -1,2 -1,3c0,2 -1,3 -1,5c0,1 -1,3 -1,5c0,3 0,5 0,7c0,2 0.4588,3.69344 1,5c0.38269,0.92387 1.186,1.69255 3,3c1.14726,0.8269 2.07613,1.61731 3,2c1.30656,0.5412 2,1 2,1c1,0 2.02675,0.22975 3,0c2.17625,-0.51375 4.186,-0.69255 6,-2c1.14726,-0.8269 2,-2 3,-3c1,-1 0.5695,-2.133 2,-6c0.77579,-2.09717 1.31073,-4.08025 2,-7c0.51373,-2.17625 1.5405,-4.0535 2,-6c0.51373,-2.17625 1,-3 1,-4c0,-1 0,-2 0,-3c0,-1 0,-1 0,-2c0,0 0,1 0,1c0,1 0,2 0,4c0,1 0,4 0,8c0,5 1.49622,9.90779 2,14c0.48874,3.97003 1.48627,6.82375 2,9c0.22977,0.97325 0.48627,1.82375 1,4c0.22977,0.97325 1,1 1,2c0,0 1,0 1,1l-1,-1l-3,-1"</span> id=<span class="string">"svg_2"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m342.5,118.45313c0,0 0,5 0,11c0,6 0,12 0,17c0,3 0,7 0,11c0,3 0,5 0,7c0,4 0,7 0,10c0,3 0,6 0,9c0,3 0,6 0,9c0,3 0,5 0,8c0,3 0,5 0,7c0,1 0,1 0,3c0,0 0,0 0,1l0,-1l0,-1l-1,-1"</span> id=<span class="string">"svg_3"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m344.5,176.45313c0,-1 1,-1 1,-1c1,0 2,0 4,0c1,0 1.69345,-0.4588 3,-1c0.92389,-0.38269 2,0 2,0c1,0 2,0 3,0c2,0 2.69345,0.4588 4,1c0.92389,0.38269 1.69345,1.4588 3,2c0.92389,0.38269 2.1731,0.85274 3,2c1.30746,1.814 2.28857,3.86829 4,8c1.21014,2.92157 1.31073,6.08025 2,9c0.51373,2.17625 1.48627,4.82375 2,7c0.4595,1.9465 0,4 0,5c0,2 0,3 0,4c0,1 0,2 1,2c0,0 0,0 0,-1l0,-1l0,-1"</span> id=<span class="string">"svg_4"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m422.5,183.45313c-1,0 -1,0 -1,0c-1,-1 -2,-1 -4,-2c-2,-1 -4.06601,-1.87766 -6,-3c-3.11847,-1.80972 -4.90778,-3.49623 -9,-4c-0.99249,-0.12218 -2,0 -3,0c0,0 -0.29291,-0.70711 -1,0c-0.70709,0.70711 -0.4588,1.69344 -1,3c-0.76538,1.84776 -0.69125,4.07179 -2,9c-0.81165,3.05634 -1.49347,6.87856 -2,10c-0.48056,2.96126 0,6 0,9c0,3 -0.76538,5.15224 0,7c0.5412,1.30656 0.69345,2.4588 2,3c0.92389,0.38269 1.07611,0.61731 2,1c1.30655,0.5412 1.07611,0.61731 2,1c1.30655,0.5412 2,1 2,1c1,0 1,0 2,0c1,0 2,0 2,0c1,-1 2,-2 3,-3c1,-1 2,-2 3,-4c1,-2 2.48627,-3.82375 3,-6c0.4595,-1.9465 1,-3 2,-4l0,-1l0,0"</span> id=<span class="string">"svg_5"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m422.5,183.45313c0,0 0,2 0,3c0,1 0,1 0,2c0,1 0,1 0,2c0,1 0,1 0,2c0,1 0,2 1,3c1,1 0.61731,2.07613 1,3c0.5412,1.30656 1,2 1,2c1,1 1.29291,1.29289 2,2c0.70709,0.70711 0.29291,1.29289 1,2c0.70709,0.70711 0,1 1,2c0,0 0.61731,1.07613 1,2c0.5412,1.30656 1.29291,1.29289 2,2c0.70709,0.70711 1,1 1,1c1,1 0.29291,1.29289 1,2c0.70709,0.70711 1.29291,0.29289 2,1c0.70709,0.70711 1,1 1,1c1,0 1,0 2,0c0,0 1,1 2,1c0,0 1,0 2,0c0,0 1,0 2,0c1,0 1,0 2,0l0,0l0,0"</span> id=<span class="string">"svg_6"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m502.5,131.45313c0,1 0,2 0,6c0,5 0,9 0,15c0,8 0,13 0,19c0,5 0,10 0,15c0,4 0.49347,7.87856 1,11c0.48056,2.96126 0.51944,5.03874 1,8c0.50653,3.12144 2,4 2,7c0,1 1,3 1,5c0,0 1,1 1,1l0,0"</span> id=<span class="string">"svg_7"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m502.5,181.45313c0,0 1,0 2,0c2,0 4,0 6,0c2,0 4.15222,-0.76537 6,0c2.6131,1.0824 3.18604,3.69255 5,5c2.29456,1.65381 3.53491,4.31076 5,6c2.0719,2.38896 2.9176,4.38687 4,7c0.76538,1.84776 2.14429,4.93414 3,7c1.21014,2.92157 1.48627,4.82375 2,7c0.45953,1.9465 1.48627,3.82375 2,6c0.68927,2.91975 1,5 1,6c0,1 0,1 0,0l0,-1"</span> id=<span class="string">"svg_8"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">   &lt;path d=<span class="string">"m583.5,195.45313c0,0 0,0 -1,0c-1,0 -3,-1 -6,-2c-3,-1 -6.07843,-1.78986 -9,-3c-4.13171,-1.71141 -5,-3 -8,-3c-1,0 -2,-1 -3,-1c-1,0 -1,0 -1,0c-1,0 -1,1 -1,1c0,2 -1.1391,4.97418 -2,10c-1.19385,6.96956 -1,13 -1,18c0,3 0,6 0,9c0,2 1,4 2,6c1,2 2,3 3,3c1,0 2,0 3,0c0,0 1.41888,-0.41885 3,-2c1.58112,-1.58115 3.34619,-1.70546 5,-4c1.30743,-1.814 1.33746,-3.31001 3,-6c1.487,-2.40601 3,-5 4,-8c1,-3 1.54047,-6.0535 2,-8c0.51373,-2.17625 1,-4 1,-6c0,-1 0,-2 0,-3c0,-1 0,-1 0,-1c0,1 -0.48053,2.03874 0,5c0.50653,3.12144 1.84723,6.04132 3,10c0.88416,3.03616 1.57971,7.15688 4,13c0.85571,2.06586 2,5 3,7c1,2 2.41888,2.41885 4,4c1.58112,1.58115 1.0979,2.82443 3,4c1.70129,1.05147 2.69342,1.4588 4,2c0.92389,0.38269 1,0 1,0c1,0 1,0 1,0c0,-1 0.69257,-2.186 2,-4c0.8269,-1.14726 2,-2 3,-3c1,-1 1,-2 2,-2l0,0"</span> id=<span class="string">"svg_9"</span> stroke-width=<span class="string">"1.5"</span> stroke=<span class="string">"#000"</span> fill=<span class="string">"none"</span>/&gt;</span><br><span class="line">  &lt;/g&gt;</span><br><span class="line"> &lt;/svg&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  const pathList = document.getElementsByTagName(<span class="string">'path'</span>);</span><br><span class="line">  const l = pathList.length;</span><br><span class="line">  <span class="built_in">let</span> delay = 0;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="built_in">let</span> i=0; i &lt; l; i++) &#123;</span><br><span class="line">    const curLen = Math.round(pathList[i].getTotalLength());</span><br><span class="line">    pathList[i].style.strokeDasharray = curLen;</span><br><span class="line">    pathList[i].style.strokeDashoffset = curLen;</span><br><span class="line">    pathList[i].style.animation = `show <span class="variable">$&#123;curLen&#125;</span>ms linear <span class="variable">$&#123;delay&#125;</span>ms forwards`;</span><br><span class="line"></span><br><span class="line">    delay += curLen;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="仪表盘-amp-机器猫"><a href="#仪表盘-amp-机器猫" class="headerlink" title="仪表盘 &amp; 机器猫"></a>仪表盘 &amp; 机器猫</h4><!-- 仪表盘 -->
<p><style>.dash {fill: transparent;stroke: #666;stroke-width: 10px;stroke-linecap: round;}.dash-move {stroke: aqua;stroke-width: 5px;stroke-dasharray: 1000;stroke-dashoffset: 1000;}.active {transition: all 2s linear;}</style></p>
<p><input id="btn" type="text"></p>
<svg width="410" height="200"><path class="dash" d="M 160 169 A 80 80 0 1 1 240 169"/><path class="dash dash-move" d="M 160 169 A 80 80 0 1 1 240 169"/></svg><br><script>const oBtn = document.getElementById(‘btn’);const oDashMove = document.getElementsByClassName(‘dash-move’)[0];oBtn.onblur = () =&gt; {oDashMove.setAttribute(‘class’, ‘dash dash-move active’);const value = oBtn.value;const path = oDashMove.getTotalLength();const data = 1000 - value / 100 * path;oDashMove.style.strokeDashoffset = data;};oBtn.onfocus = () =&gt; {oDashMove.setAttribute(‘class’, ‘dash dash-move’); oDashMove.style.strokeDashoffset = 1000;};</script><br><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  .dash &#123;</span><br><span class="line">    fill: transparent;</span><br><span class="line">    stroke: <span class="comment">#666;</span></span><br><span class="line">    stroke-width: 10px;</span><br><span class="line">    stroke-linecap: round;</span><br><span class="line">  &#125;</span><br><span class="line">  .dash-move &#123;</span><br><span class="line">    stroke: aqua;</span><br><span class="line">    stroke-width: 5px;</span><br><span class="line">    stroke-dasharray: 1000;</span><br><span class="line">    stroke-dashoffset: 1000;</span><br><span class="line">  &#125;</span><br><span class="line">  .active &#123;</span><br><span class="line">    transition: all 2s linear;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;input id=<span class="string">'btn'</span> <span class="built_in">type</span>=<span class="string">'text'</span> /&gt;</span><br><span class="line">&lt;svg width=410 height=200&gt;</span><br><span class="line">  &lt;path class=<span class="string">'dash'</span> d=<span class="string">'M 160 169 A 80 80 0 1 1 240 169'</span> /&gt;</span><br><span class="line">  &lt;path class=<span class="string">'dash dash-move'</span> d=<span class="string">'M 160 169 A 80 80 0 1 1 240 169'</span> /&gt;</span><br><span class="line">&lt;/svg&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  const oBtn = document.getElementById(<span class="string">'btn'</span>);</span><br><span class="line">  const oDashMove = document.getElementsByClassName(<span class="string">'dash-move'</span>)[0];</span><br><span class="line">  oBtn.onblur = () =&gt; &#123;</span><br><span class="line">    oDashMove.setAttribute(<span class="string">'class'</span>, <span class="string">'dash dash-move active'</span>);</span><br><span class="line">    const value = oBtn.value;</span><br><span class="line">    const path = oDashMove.getTotalLength();</span><br><span class="line">    const data = 1000 - value / 100 * path;</span><br><span class="line">    oDashMove.style.strokeDashoffset = data;</span><br><span class="line">  &#125;;</span><br><span class="line">  oBtn.onfocus = () =&gt; &#123;</span><br><span class="line">    oDashMove.setAttribute(<span class="string">'class'</span>, <span class="string">'dash dash-move'</span>);</span><br><span class="line">    oDashMove.style.strokeDashoffset = 1000;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><br><br><style>.blueBlack {fill: #18c;stroke: #000;}.whiteBlack {fill: #fff;stroke: #000;}.white {fill: #fff;}.redBlack {fill: #f00;stroke: #000;}.red {fill: #f00;stroke-width: 15px;stroke-linecap: round;}.line {fill: transparent;stroke: #000;}.blueBlack {fill: #18c;}.yellowBlack {fill: #fe1;stroke: #000;}</style><br><svg width="500" height="500"><path class="blueBlack" d="M 160 300 A 150 150 10 1 1 340 300"/><path class="whiteBlack" d="M 170 300 A 100 120 90 1 1 330 300"/><ellipse class="whiteBlack" rx="35" ry="45" cx="215" cy="135"/><ellipse class="whiteBlack" rx="35" ry="45" cx="285" cy="135"/><ellipse rx="6" ry="10" cx="225" cy="155"/><ellipse rx="6" ry="10" cx="275" cy="155"/><circle class="redBlack" r="13" cx="250" cy="175"/><circle class="white" r="5" cx="255" cy="170"/><path class="line" d="M 250 188 L 250 278"/><path class="line" d="M 216 200 L 150 185"/><path class="line" d="M 216 215 L 145 215"/><path class="line" d="M 216 230 L 150 245"/><path class="line" d="M 284 200 L 350 185"/><path class="line" d="M 284 215 L 355 215"/><path class="line" d="M 284 230 L 350 245"/><path class="line" d="M 180 250 A 100 100 10 0 0 320 250"/><rect class="redBlack" x="146" y="293" width="206" height="14" rx="13" ry="13"/><rect class="line" x="146" y="293" width="206" height="14" rx="13" ry="13"/><rect class="blueBlack" x="152" y="307" width="194" height="150" rx="0" ry="0"/><polyline class="blueBlack" points="160 307, 98 293, 98 333, 152 347, 152 330"/><polyline class="blueBlack" points="346 307, 402 320, 402 360, 346 347, 340 330"/><circle class="whiteBlack" r="25" cx="86" cy="310"/><circle class="whiteBlack" r="25" cx="418" cy="340"/><path class="whiteBlack" d="M 180 307 A 80 80 10 1 0 320 307"/><circle class="yellowBlack" r="20" cx="250" cy="320"/><path class="line" d="M 235 307 L 265 307"/><path class="line" d="M 232 312 L 268 312"/><circle r="5" cx="250" cy="330"/><path class="line" d="M 250 335 L 250 340"/><path class="whiteBlack" d="M 210 360 A 22 24 10 1 0 290 360"/><path class="line" d="M 210 360 L 290 360"/><path class="line" d="M 152 347 L 152 460"/><path class="line" d="M 346 347 L 346 460"/><path class="whiteBlack" d="M 238 462 A 10 10 10 1 1 262 457"/><ellipse class="whiteBlack" rx="53" ry="15" cx="193" cy="465"/><ellipse class="whiteBlack" rx="53" ry="15" cx="307" cy="465"/></svg>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">   .blueBlack &#123;</span><br><span class="line">     fill: <span class="comment">#18c;</span></span><br><span class="line">     stroke: <span class="comment">#000;</span></span><br><span class="line">   &#125;</span><br><span class="line">   .whiteBlack &#123;</span><br><span class="line">     fill: <span class="comment">#fff;</span></span><br><span class="line">     stroke: <span class="comment">#000;</span></span><br><span class="line">   &#125;</span><br><span class="line">   .white &#123;</span><br><span class="line">     fill: <span class="comment">#fff;</span></span><br><span class="line">   &#125;</span><br><span class="line">   .redBlack &#123;</span><br><span class="line">     fill: <span class="comment">#f00;</span></span><br><span class="line">     stroke: <span class="comment">#000;</span></span><br><span class="line">   &#125;</span><br><span class="line">   .red &#123;</span><br><span class="line">     fill: <span class="comment">#f00;</span></span><br><span class="line">     stroke-width: 15px;</span><br><span class="line">     stroke-linecap: round;</span><br><span class="line">   &#125;</span><br><span class="line">   .line &#123;</span><br><span class="line">     fill: transparent;</span><br><span class="line">     stroke: <span class="comment">#000;</span></span><br><span class="line">   &#125;</span><br><span class="line">   .blueBlack &#123;</span><br><span class="line">     fill: <span class="comment">#18c;</span></span><br><span class="line">   &#125;</span><br><span class="line">   .yellowBlack &#123;</span><br><span class="line">     fill: <span class="comment">#fe1;</span></span><br><span class="line">     stroke: <span class="comment">#000;</span></span><br><span class="line">   &#125;</span><br><span class="line"> &lt;/style&gt;</span><br><span class="line"> &lt;svg width=500 height=500&gt;</span><br><span class="line">   &lt;path class=<span class="string">'blueBlack'</span> d=<span class="string">'M 160 300 A 150 150 10 1 1 340 300'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'whiteBlack'</span> d=<span class="string">'M 170 300 A 100 120 90 1 1 330 300'</span> /&gt;</span><br><span class="line">   &lt;ellipse class=<span class="string">'whiteBlack'</span> rx=<span class="string">'35'</span> ry=<span class="string">'45'</span> cx=<span class="string">'215'</span> cy=<span class="string">'135'</span> /&gt;</span><br><span class="line">   &lt;ellipse class=<span class="string">'whiteBlack'</span> rx=<span class="string">'35'</span> ry=<span class="string">'45'</span> cx=<span class="string">'285'</span> cy=<span class="string">'135'</span> /&gt;</span><br><span class="line">   &lt;ellipse rx=<span class="string">'6'</span> ry=<span class="string">'10'</span> cx=<span class="string">'225'</span> cy=<span class="string">'155'</span> /&gt;</span><br><span class="line">   &lt;ellipse rx=<span class="string">'6'</span> ry=<span class="string">'10'</span> cx=<span class="string">'275'</span> cy=<span class="string">'155'</span> /&gt;</span><br><span class="line">   &lt;circle class=<span class="string">'redBlack'</span> r=<span class="string">'13'</span> cx=<span class="string">'250'</span> cy=<span class="string">'175'</span> /&gt;</span><br><span class="line">   &lt;circle class=<span class="string">'white'</span> r=<span class="string">'5'</span> cx=<span class="string">'255'</span> cy=<span class="string">'170'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 250 188 L 250 278'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 216 200 L 150 185'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 216 215 L 145 215'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 216 230 L 150 245'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 284 200 L 350 185'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 284 215 L 355 215'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 284 230 L 350 245'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 180 250 A 100 100 10 0 0 320 250'</span> /&gt;</span><br><span class="line">   &lt;rect class=<span class="string">'redBlack'</span> x=<span class="string">'146'</span> y=<span class="string">'293'</span> width=<span class="string">'206'</span> height=<span class="string">'14'</span> rx=<span class="string">'13'</span> ry=<span class="string">'13'</span> /&gt;</span><br><span class="line">   &lt;rect class=<span class="string">'line'</span> x=<span class="string">'146'</span> y=<span class="string">'293'</span> width=<span class="string">'206'</span> height=<span class="string">'14'</span> rx=<span class="string">'13'</span> ry=<span class="string">'13'</span> /&gt;</span><br><span class="line">   &lt;rect class=<span class="string">'blueBlack'</span> x=<span class="string">'152'</span> y=<span class="string">'307'</span> width=<span class="string">'194'</span> height=<span class="string">'150'</span> rx=<span class="string">'0'</span> ry=<span class="string">'0'</span> /&gt;</span><br><span class="line">   &lt;polyline class=<span class="string">'blueBlack'</span> points=<span class="string">'160 307, 98 293, 98 333, 152 347, 152 330'</span> /&gt;</span><br><span class="line">   &lt;polyline class=<span class="string">'blueBlack'</span> points=<span class="string">'346 307, 402 320, 402 360, 346 347, 340 330'</span> /&gt;</span><br><span class="line">   &lt;circle class=<span class="string">'whiteBlack'</span> r=<span class="string">'25'</span> cx=<span class="string">'86'</span> cy=<span class="string">'310'</span> /&gt;</span><br><span class="line">   &lt;circle class=<span class="string">'whiteBlack'</span> r=<span class="string">'25'</span> cx=<span class="string">'418'</span> cy=<span class="string">'340'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'whiteBlack'</span> d=<span class="string">'M 180 307 A 80 80 10 1 0 320 307'</span> /&gt;</span><br><span class="line">   &lt;circle class=<span class="string">'yellowBlack'</span> r=<span class="string">'20'</span> cx=<span class="string">'250'</span> cy=<span class="string">'320'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 235 307 L 265 307'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 232 312 L 268 312'</span> /&gt;</span><br><span class="line">   &lt;circle r=<span class="string">'5'</span> cx=<span class="string">'250'</span> cy=<span class="string">'330'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 250 335 L 250 340'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'whiteBlack'</span> d=<span class="string">'M 210 360 A 22 24 10 1 0 290 360'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 210 360 L 290 360'</span> /&gt;</span><br><span class="line"></span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 152 347 L 152 460'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'line'</span> d=<span class="string">'M 346 347 L 346 460'</span> /&gt;</span><br><span class="line">   &lt;path class=<span class="string">'whiteBlack'</span> d=<span class="string">'M 238 462 A 10 10 10 1 1 262 457'</span> /&gt;</span><br><span class="line"> </span><br><span class="line">   &lt;ellipse class=<span class="string">'whiteBlack'</span> rx=<span class="string">'53'</span> ry=<span class="string">'15'</span> cx=<span class="string">'193'</span> cy=<span class="string">'465'</span> /&gt;</span><br><span class="line">   &lt;ellipse class=<span class="string">'whiteBlack'</span> rx=<span class="string">'53'</span> ry=<span class="string">'15'</span> cx=<span class="string">'307'</span> cy=<span class="string">'465'</span> /&gt;</span><br><span class="line"> &lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<h2 id="3、-requestAnimationFrame-客户端存储-历史记录-worker"><a href="#3、-requestAnimationFrame-客户端存储-历史记录-worker" class="headerlink" title="3、 requestAnimationFrame 客户端存储 历史记录 worker"></a><font color="#F33F50">3、 requestAnimationFrame 客户端存储 历史记录 worker</font></h2><h3 id="requestAnimationFrame"><a href="#requestAnimationFrame" class="headerlink" title="requestAnimationFrame"></a>requestAnimationFrame</h3><ul>
<li><p>window.requestAnimationFrame(callback);<br>告诉浏览器——你希望执行一个动画，并且要求浏览器在下次重绘之前调用指定的回调函数更新动画。该方法需要传入一个回调函数作为参数，该回调函数会在浏览器下一次重绘之前执行。</p>
</li>
<li><p>若想在浏览器下次重绘之前继续更新下一帧动画，那么回调函数自身必须再次调用window.requestAnimationFrame()。</p>
</li>
<li><p>回调函数会被传入DOMHighResTimeStamp参数，DOMHighResTimeStamp指示当前被 requestAnimationFrame() 排序的回调函数被触发的时间。在同一个帧中的多个回调函数，它们每一个都会接受到一个相同的时间戳，即使在计算上一个回调函数的工作负载期间已经消耗了一些时间。该时间戳是一个十进制数，单位毫秒，最小精度为1ms(1000μs)。</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const element = document.getElementById(<span class="string">'some-element-you-want-to-animate'</span>);</span><br><span class="line"><span class="built_in">let</span> start;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> step(timestamp) &#123;</span><br><span class="line">  <span class="keyword">if</span> (start === undefined)</span><br><span class="line">    start = timestamp;</span><br><span class="line">  const elapsed = timestamp - start;</span><br><span class="line"></span><br><span class="line">  //这里使用`Math.min()`确保元素刚好停在200px的位置。</span><br><span class="line">  element.style.transform = <span class="string">'translateX('</span> + Math.min(0.1 * elapsed, 200) + <span class="string">'px)'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (elapsed &lt; 2000) &#123; // 在两秒后停止动画</span><br><span class="line">    window.requestAnimationFrame(step);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.requestAnimationFrame(step);</span><br></pre></td></tr></table></figure>
<h3 id="客户端存储"><a href="#客户端存储" class="headerlink" title="客户端存储"></a>客户端存储</h3><h4 id="storage"><a href="#storage" class="headerlink" title="storage"></a>storage</h4><ul>
<li>localStorage</li>
<li>sessionStorage</li>
</ul>
<blockquote>
<ol>
<li><p>如何存储数据 （session同）<br>localStorage.name = ‘amy’;    必须是字符串格式<br>localStorage.info = JSON.stringfy({address:’shenzhen’}); 对象也需转成成字符串格式</p>
</li>
<li><p>如何读取数据 （session同）<br>localStorage.name<br>JSON.parse(localStorage.info)</p>
</li>
<li><p>存储有效期<br>localStorage 永久的，除非手动删除（Application-Local Storage）<br>sessionStorage 临时的，窗口关闭就自动清除掉了（Application-Session Storage）</p>
</li>
<li><p>作用域<br>localStorage    文档源限制<br>sessionStorage  文档源限制 + 窗口</p>
</li>
<li><p>setItem(name, value) 设置属性值<br>getItem(name)        获取属性值<br>removeItem(name)     移除属性<br>clear()              清除属性</p>
</li>
</ol>
</blockquote>
<h4 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h4><p>存储信息到用户的设备上，数据量较小<br>navigator.cookieEnabled 检测是否启用了cookie。</p>
<blockquote>
<ol>
<li><p>设置cookie的值<br>document.cookie = “name=value”; (每次只能设置一个值，因为浏览器会认为后面的键值对是这个cookie的属性)<br>Version 通过Set-Cookie设置的响应头创建必须符合RFC2965规范，如果通过Set-Cookie响应头设置，则默认值为0；如果要设置为1，则该Cookie要遵循RFC2109规范<br>Comment    注释项，用户说明该Cookie有何用途<br>CommentURL    服务器为此Cookie提供的URI注释<br>Discard    是否在会话结束后丢弃该Cookie项,默认为false<br>Domain    生成该Cookie的域名，如domain=“hahaha.net”<br>Max-Age    最大失效时间，与Version不同，Version设置的是在多少秒后失效，可以参数可用表达式如60 * 60 * 24,这样则是设置失效时间一天<br>Path    该Cookie是在当前哪个路径下生成的<br>Port    该Cookie在什么端口下可以传回服务器端，如果有多个端口，则以逗号隔开<br>Secure    如果设置了这个属性，那么只会在SSH连续时才会传回该Cookie</p>
</li>
<li><p>获取cookie值<br>document.cookie</p>
</li>
<li><p>expires<br>指定了cookie的生存期，默认情况下cookie存储的值只在浏览器会话期间存在，当用户退出浏览器后这些值也会丢失，如果想让 cookie 存在一段时间，就要为expires属性设置为未来的一个过期日期（毫秒）。现在已经被max-age属性所取代，max-age用秒来设置 cookie 的生存期。<br>const now = new Date();<br>now.setTime(now.getTime() + (1000 * 60 * 60 * 24 * 30));<br>document.cookie = `name=value;expires=${now.toUTCString()};path=/;SameSite=None;`;</p>
</li>
<li><p>max-age 设置cookie存储期限<br>document.cookie = “name=value;max-age=1000”; 单位：秒</p>
</li>
<li><p>SameSite<br>Cookie 往往用来存储用户的身份信息，恶意网站可以设法伪造带有正确 Cookie 的 HTTP 请求，这就是 <strong>CSRF</strong> 攻击。<br>Cookie 的SameSite属性用来限制第三方 Cookie，从而减少安全风险。<br>它可以设置三个值:Strict 、 Lax 、 None</p>
<ul>
<li>Strict最为严格，完全禁止第三方 Cookie，跨站点时，任何情况下都不会发送 Cookie。换言之，只有当前网页的 URL 与请求目标一致，才会带上 Cookie。<br>  这个规则过于严格，可能造成非常不好的用户体验。比如，当前网页有一个 GitHub 链接，用户点击跳转就不会带有 GitHub 的 Cookie，跳转过去总是未登陆状态。</li>
<li>Lax规则稍稍放宽，大多数情况也是不发送第三方 Cookie，但是导航到目标网址的 Get 请求除外。<br>  设置了Strict或Lax以后，基本就杜绝了 CSRF 攻击。当然，前提是用户浏览器支持 SameSite 属性。   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">请求类型      示例	                        正常情况	    Lax</span><br><span class="line">链接	    &lt;a href=<span class="string">"..."</span>&gt;&lt;/a&gt;	                发送 Cookie  发送 Cookie</span><br><span class="line">预加载	    &lt;link rel=<span class="string">"prerender"</span> href=<span class="string">"..."</span>/&gt;	发送 Cookie  发送 Cookie</span><br><span class="line">GET 表单     &lt;form method=<span class="string">"GET"</span> action=<span class="string">"..."</span>&gt;	发送 Cookie  发送 Cookie</span><br><span class="line">POST 表单    &lt;form method=<span class="string">"POST"</span> action=<span class="string">"..."</span>&gt;	发送 Cookie  不发送</span><br><span class="line">iframe	    &lt;iframe src=<span class="string">"..."</span>&gt;&lt;/iframe&gt;	        发送 Cookie  不发送</span><br><span class="line">AJAX        $.get(<span class="string">"..."</span>)	                发送 Cookie  不发送</span><br><span class="line">Image	    &lt;img src=<span class="string">"..."</span>&gt;	                发送 Cookie  不发送</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
</blockquote>
<blockquote>
<ul>
<li>Chrome 计划将Lax变为默认设置。这时，网站可以选择显式关闭SameSite属性，将其设为None。<br>  不过，前提是必须同时设置Secure属性（Cookie 只能通过 HTTPS 协议发送），否则无效。  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: widget_session=abc123; SameSite=None;            无效</span><br><span class="line">Set-Cookie: widget_session=abc123; SameSite=None; Secure;    有效</span><br></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<blockquote>
<ol start="6">
<li>删除cookie<br>max-age = 0;需要带上键值对</li>
</ol>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">const cookieUtil = &#123;</span><br><span class="line">  //获取cookie</span><br><span class="line">  <span class="string">"get"</span>: <span class="keyword">function</span> (name) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!name || typeof name !== <span class="string">"string"</span>) &#123;</span><br><span class="line">      <span class="built_in">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var cookieName = encodeURIComponent(name) + <span class="string">'='</span>,</span><br><span class="line">      cookieStart = document.cookie.indexOf(cookieName),</span><br><span class="line">      cookieValue = <span class="string">""</span>,</span><br><span class="line">      cookieEnd = -1;</span><br><span class="line">    <span class="keyword">if</span> (cookieStart &gt; -1) &#123;</span><br><span class="line">      cookieEnd = document.cookie.indexOf(<span class="string">";"</span>, cookieStart);</span><br><span class="line">      <span class="keyword">if</span> (cookieEnd == -1) &#123;</span><br><span class="line">        cookieEnd = document.cookie.length;</span><br><span class="line">      &#125;</span><br><span class="line">      cookieValue = document.cookie.slice(cookieStart + cookieName.length, cookieEnd);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> cookieValue;</span><br><span class="line">  &#125;,</span><br><span class="line">  //设置cookie</span><br><span class="line">  <span class="string">"set"</span>: <span class="keyword">function</span> (name, value, expires, maxAge, path, domain, secure) &#123;</span><br><span class="line">    var cookieText = encodeURIComponent(name) + <span class="string">'='</span> + encodeURIComponent(value);</span><br><span class="line">    <span class="keyword">if</span> (expires instanceof Date) &#123;</span><br><span class="line">      cookieText += <span class="string">"; expires="</span> + expires.toGTMString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (maxAge) &#123;</span><br><span class="line">      cookieText += <span class="string">"; max-age="</span> + maxAge;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (path) &#123;</span><br><span class="line">      cookieText += <span class="string">"; path="</span> + path;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (domain) &#123;</span><br><span class="line">      cookieText += <span class="string">"; domain="</span> + domain;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (secure) &#123;</span><br><span class="line">      cookieText += <span class="string">"; secure"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    document.cookie = cookieText;</span><br><span class="line">  &#125;,</span><br><span class="line">  //清除cookie</span><br><span class="line">  <span class="string">"unset"</span>: <span class="keyword">function</span> (name, expires, maxAge, path, domain, secure) &#123;</span><br><span class="line">    this.set(name, <span class="string">""</span>, new Date(0), 0, path, domain, secure);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">cookieUtil.set(<span class="string">"name"</span>, <span class="string">"test"</span>);</span><br></pre></td></tr></table></figure>
<script>
    var canvas = document.getElementById('myCanvas');
    var ctx = canvas.getContext('2d');
    ctx.strokeStyle = 'red';
    ctx.strokeRect( 110 , 10 , 150 , 100 );
    ctx.strokeStyle = 'black';
    ctx.strokeRect( 310 , 10 , 100 , 150);

    var canvas1 = document.getElementById('myCanvas1');
    var ctx1 = canvas1.getContext('2d');
    ctx1.rect( 10 , 10 , 100 , 100 );
    ctx1.fill();
    ctx1.clearRect( 10 , 10 , 50 , 50);
    ctx1.beginPath();
    ctx1.rect(130,10,80,80);
    ctx1.fillStyle = 'red';
    ctx1.fill();

    var canvas2 = document.getElementById('myCanvas2');
    var ctx2 = canvas2.getContext('2d');
    var oImg = document.getElementsByClassName('fillPicture')[0];
    ctx2.fillStyle = ctx2.createPattern(oImg,'repeat-x');
    ctx2.fillRect(21,0,535,200);

    var canvas3 = document.getElementById('myCanvas3');
    var ctx3 = canvas3.getContext('2d');
    var bg = ctx2.createLinearGradient(0,0,0,500);
    bg.addColorStop(0,'red');
    bg.addColorStop(0.5,'green');
    ctx3.fillStyle = bg;
    ctx3.fillRect(70,0,600,200);

    var canvas4 = document.getElementById('myCanvas4');
    var ctx4 = canvas4.getContext('2d');
    ctx4.fillStyle='SeaGreen';
    ctx4.shadowColor = 'pink';
    ctx4.shadowBlur = 10;
    ctx4.shadowOffsetX = 30;
    ctx4.shadowOffsetY = -20;
    ctx4.fillRect(80,30,460,140);

    var canvas5 = document.getElementById('myCanvas5');
    var ctx5 = canvas5.getContext('2d');
    ctx5.textAlign = 'left';
    ctx.textBaseLine = 'hanging'
    ctx5.fillStyle = 'deeppink';
    ctx5.font = '40px sans-serif';
    ctx5.fillText('Hello World!' , 70 ,50);
    ctx5.strokeText('Hello World!' , 320 ,50);

    var exportCan = document.getElementsByClassName('exportCan')[0];
    var data = canvas5.toDataURL();
    exportCan.src=data;

    var canvas6 = document.getElementById('myCanvas6');
    var ctx6 = canvas6.getContext('2d');
    ctx6.fillStyle='pink';
    ctx6.fillRect(70 , 0 , 100 , 100 );
    var pixel = ctx6.getImageData(100 , 0 , 50 , 50);
    var row = pixel.width;
    var col = pixel.height;
    var d = pixel.data;
    for(var i = 0 ; i < row ; i++){
        var c = i*col*4;
        for(var j = 0; j < col ; j++){
            d[c+j*4+3] = 100;
        }
    }
    ctx6.putImageData(pixel,100,10);
</script>


<table class="textCenter"><tr><td colspan="4">特性</td><td colspan="10">Cookie</td><td colspan="6">localStorage</td><td colspan="6">sessionStorage</td></tr><tr><td colspan="4">数据生命周期</td><td colspan="10">可设置失效时间，不设置默认是关闭浏览器失效。</td><td colspan="6">除非被清除，否则永久保存</td><td colspan="6">当前会话下有效，关闭页面或浏览器后清除。</td></tr><tr><td colspan="4">存放数据大小</td><td colspan="10">4k左右</td><td colspan="12">一般为5MB</td></tr><tr><td colspan="4">与服务器通信</td><td colspan="10">HTTP每次都会携带cookie信息。如果cookie保存过多数据会带来性能问题。</td><td colspan="12">仅在客户端（即浏览器）中保存，不参与和服务器的通信。</td></tr><tr><td colspan="4">易用性</td><td colspan="10">需要自己封装，原生的cookie接口不友好。</td><td colspan="12">原生接口可以接受，亦可再次封装对Object和Array有更好的支持。</td></tr></table>


<h3 id="history"><a href="#history" class="headerlink" title="history"></a>history</h3><ul>
<li><p>history.back()<br>history.forward()<br>history.go(n)</p>
</li>
<li><p>pushState() 和 replaceState()<br><font color="#FC5603">HTML5新接口，可以改变网址(存在跨域限制)而不刷新页面，这个强大的特性后来用到了单页面应用如：vue-router，react-router-dom中。</font><br>注意:仅改变网址,网页不会真的跳转,也不会获取到新的内容,本质上网页还停留在原页面!</p>
<p>history.pushState(state, title, url); 添加一条历史记录<br>history.replaceState(state, title, url); 替换当前历史记录</p>
<p>state: 一个与指定网址相关的状态对象。popstate事件触发时，该对象会传入回调函数中，如果不需要可传null。<br>title: 新页面标题，但是所有浏览器目前都忽略这个值，故可传null。<br>url: 新的网址，必须与当前页面处在同一域，浏览器的地址栏将显示这个网址。</p>
</li>
<li><p>popstate事件 和 hashchange事件<br>popstate事件： 历史记录发生改变时触发。popstate事件会在点击后退、前进按钮(或调用history.back()、history.forward()、history.go()方法)时触发。前提是不能真的发生了页面跳转,而是在由history.pushState()或者history.replaceState()形成的历史节点中前进后退<br>注意:调用history.pushState()或history.replaceState()不会触发popstate事件。<br>hashChange事件： 当页面的hash值改变的时候触发，常用于构建单页面应用。</p>
</li>
</ul>
<h3 id="Worker"><a href="#Worker" class="headerlink" title="Worker"></a>Worker</h3><p>  var worker = new Worker(‘worker.js’);<br>  worker文件必须和主文件满足同源策略<br>  worker和主线程之间的通信，发：postMessages(n)方法，收：message事件。<br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">主进程代码：</span><br><span class="line">  &lt;script src=<span class="string">'./worker.js'</span>&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    var worker = new Worker(<span class="string">'worker.js'</span>);     // Worker &#123;onmessage: (e) =&gt; &#123; console.log(<span class="string">'e.data:'</span>, e.data); &#125;, onerror: null&#125;</span><br><span class="line"></span><br><span class="line">    worker.postMessage(&#123;</span><br><span class="line">      num: 10,</span><br><span class="line">    &#125;);</span><br><span class="line">    worker.onmessage = (e) =&gt; &#123;</span><br><span class="line">      console.log(e.data);                    // &#123;num: 200&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">worker代码：</span><br><span class="line">onmessage = (e) =&gt; &#123;</span><br><span class="line">  const &#123; data &#125; = e;</span><br><span class="line">  console.log(data);                          // &#123;num: 10&#125;  </span><br><span class="line"></span><br><span class="line">  postMessage(&#123;</span><br><span class="line">    num: data.num * 20</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>结束一个worker<br>    close()在worker作用域中调用（worker.js）   暂时不会使用，如有用到再研究。<br>    terminate()在worker对象上调用（主进程的worker对象上worker.terminate），这个试了一下，是没问题的。</p>
</blockquote>
<blockquote>
<p>其他特性<br>    importScripts(‘./match1.js’, ‘./math2.js’);<br>    作用域 global Worker Scope<br>    navigator<br>    XMLHttpRequest</p>
</blockquote>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">  document.getElementById(<span class="string">'test'</span>).addEventListener(<span class="string">'click'</span>, <span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">    window.history.pushState(&#123;page: 1&#125;, <span class="string">'test'</span>, <span class="string">'#test1'</span>);</span><br><span class="line">    window.history.pushState(&#123;page: 2&#125;, <span class="string">'test'</span>, <span class="string">'#test2'</span>);</span><br><span class="line">    <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  window.onpopstate = <span class="keyword">function</span>(e) &#123;</span><br><span class="line">    console.log(e.state);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h2 id="4、-geolocation-devicemotion"><a href="#4、-geolocation-devicemotion" class="headerlink" title="4、 geolocation devicemotion"></a><font color="#F33F50">4、 geolocation devicemotion</font></h2><h3 id="geolocation"><a href="#geolocation" class="headerlink" title="geolocation"></a>geolocation</h3><p>window.navigator.geolocation</p>
<h4 id="1、getCurrentPosition-s-e-p"><a href="#1、getCurrentPosition-s-e-p" class="headerlink" title="1、getCurrentPosition(s, e, p)"></a>1、getCurrentPosition(s, e, p)</h4><p>navigator.geolocation.getCurrentPosition(success成功回调函数, error失败回调函数, options可传一些参数);</p>
<ul>
<li><p>p 配置参数对象<br>enableHighAccurary 是否需要高精度位置，默认为false。<br>timeout 单位ms，请求超时时间，默认infinity。<br>maximumAge 单位ms，位置信息过期时间，设置为0就无条件获取新的地理位置信息，默认为0.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">* 需要fq，successFn -&gt; pos</span><br><span class="line">  Geoposition &#123;</span><br><span class="line">    coords: Coordonate &#123;</span><br><span class="line">      accuracy: 14988703,      // 精确度（米）</span><br><span class="line">      altitude: null,          // 海拔</span><br><span class="line">      altitudeAccuracy: null,  // 海拔精确度</span><br><span class="line">      heading: null,           // 航向（方向）</span><br><span class="line">      latitude: 37.09024,      // 维度</span><br><span class="line">      longitude: =95.712891,   // 经度</span><br><span class="line">      speed: null,             // 速度</span><br><span class="line">      __proto__: Coordinate</span><br><span class="line">    &#125;,</span><br><span class="line">    timeStamp: 1500862907040,</span><br><span class="line">    __proto__: Geoposition</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">没fq：获取您的位置【允许】【禁止】</span><br><span class="line">  允许：</span><br><span class="line">      PositionError &#123;</span><br><span class="line">        code: 2,</span><br><span class="line">        message: <span class="string">"NetWork location provider at 'https://www.googleapis.com/': No response received"</span></span><br><span class="line">      &#125;</span><br><span class="line">  禁止：</span><br><span class="line">      PositionError &#123;</span><br><span class="line">        code: 1,</span><br><span class="line">        message: <span class="string">"User denied Geolocation"</span></span><br><span class="line">      &#125;</span><br><span class="line">  超时：</span><br><span class="line">      PositionError &#123;</span><br><span class="line">        code: 3,</span><br><span class="line">        message: <span class="string">"Timeout expired"</span></span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2、watchPosition-s-e-p"><a href="#2、watchPosition-s-e-p" class="headerlink" title="2、watchPosition(s, e, p);"></a>2、watchPosition(s, e, p);</h4><p>const id = navigator.geolocation.watchPosition(s, e, p);<br>持续定期的自动获取用户的当前地理位置信息，并同计时器一样有个位置标识。<br>可以连续获取，利用canvas点连线做成图，做成运动轨迹。</p>
<h4 id="3、clearWatch"><a href="#3、clearWatch" class="headerlink" title="3、clearWatch"></a>3、clearWatch</h4><p>navigator.geolocation.clearWatch(id);<br>停止获取位置信息</p>
<h3 id="devicemotion"><a href="#devicemotion" class="headerlink" title="devicemotion"></a>devicemotion</h3><p>提供设备的加速度信息，表示为定义在设备上的坐标系中的笛卡尔坐标，其还提供了设备在坐标系中的自转速率。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(<span class="string">'devicemotion'</span>, e =&gt; console.log(e));</span><br><span class="line"></span><br><span class="line">DeviceMotionEvent &#123;</span><br><span class="line">  acceleration: DeviceAcceleration,                 // 重力加速度</span><br><span class="line">  accelerationIncludingGravity: DeviceAcceleration, // 重力加速度（包括中心引力）</span><br><span class="line">  rotationRate: DeviceRotation,                     // 旋转速率（需要陀螺仪支持）rotationRate(alpha, beta, gamma) </span><br><span class="line">  interval: 0,                                      // 获取时间间隔</span><br><span class="line">  <span class="built_in">type</span>: <span class="string">'devicemotion'</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>摇一摇，摇到外婆桥<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">   <span class="comment">#ball &#123;</span></span><br><span class="line">     position: relative;</span><br><span class="line">     width: 20px;</span><br><span class="line">     height: 20px;</span><br><span class="line">     border-radius: 50%;</span><br><span class="line">     background: rgb(72, 25, 133);</span><br><span class="line">   &#125;</span><br><span class="line"> &lt;/style&gt;</span><br><span class="line"> &lt;div id=<span class="string">"ball"</span>&gt;&lt;/div&gt;</span><br><span class="line"> &lt;div id = <span class="string">'cal'</span>&gt;&lt;/div&gt;</span><br><span class="line"> &lt;script&gt;</span><br><span class="line">   var shakeThreshold = 15;</span><br><span class="line">   var lastUpdate = 0;</span><br><span class="line">   var lastX=0;</span><br><span class="line">   var lastY=0;</span><br><span class="line">   var lastZ=0;</span><br><span class="line">   <span class="keyword">function</span> deviceMotionHandler(eventData) &#123;</span><br><span class="line">     var acceleration = eventData.accelerationIncludingGravity;</span><br><span class="line">     var curTime = (new Date()).getTime();</span><br><span class="line">     <span class="keyword">if</span> (curTime - lastUpdate &gt; 300) &#123;</span><br><span class="line">       var diffTime = curTime;</span><br><span class="line">       var x = acceleration.x;</span><br><span class="line">       var y = acceleration.y;</span><br><span class="line">       var z = acceleration.z;</span><br><span class="line">       var speed = Math.abs(x + y + z - lastX -lastY - lastZ);</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (speed &gt; shakeThreshold) &#123;</span><br><span class="line">         var oDiv = document.getElementById(<span class="string">'ball'</span>);</span><br><span class="line">         var oCal = document.getElementById(<span class="string">'cal'</span>);</span><br><span class="line">         oCal.innerHTML = `<span class="variable">$&#123;oDiv.offsetLeft&#125;</span>, <span class="variable">$&#123;window.screen.width&#125;</span>, <span class="variable">$&#123;oDiv.offsetTop&#125;</span>, <span class="variable">$&#123;window.screen.height&#125;</span>`;</span><br><span class="line">         oDiv.style.left = (oDiv.offsetLeft &gt; window.screen.width) ? 0 : (oDiv.offsetLeft + speed/4 + <span class="string">'px'</span>);</span><br><span class="line">         oDiv.style.top = (oDiv.offsetTop &gt; window.screen.height) ? 0 : (oDiv.offsetTop + speed/4 + <span class="string">'px'</span>);</span><br><span class="line">         // oDiv.style.left = oDiv.offsetLeft + speed + <span class="string">'px'</span>;</span><br><span class="line">         // oDiv.style.top = oDiv.offsetTop + speed + <span class="string">'px'</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       lastX = x;</span><br><span class="line">       lastY = y;</span><br><span class="line">       lastZ = z;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> (window.DeviceMotionEvent) &#123;</span><br><span class="line">     window.addEventListener(<span class="string">'devicemotion'</span>, deviceMotionHandler, <span class="literal">false</span>);</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     document.getElementById(<span class="string">'domEvent'</span>).innerHTML = <span class="string">'Not supported on your device.'</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="5、-drag-amp-drop-FileReader-WebSocket"><a href="#5、-drag-amp-drop-FileReader-WebSocket" class="headerlink" title="5、 drag &amp; drop FileReader WebSocket"></a><font color="#F33F50">5、 drag &amp; drop FileReader WebSocket</font></h2><h3 id="1）-drag-amp-drop"><a href="#1）-drag-amp-drop" class="headerlink" title="1） drag &amp; drop"></a>1） drag &amp; drop</h3><ul>
<li><p>常用于各种拖动操作中<br>创建可拖动元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div draggable=&quot;true&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>拖动的相关事件<br>dragstart 被拖动元素开始被拖动时触发<br>dragend   被拖动元素完成时触发<br>dragenter 被拖动元素进入目标元素<br>dragover  被拖动元素在目标元素上移动<br>drop      被拖动元素和鼠标在目标元素上同时鼠标放开时触发（*需阻止dragover的默认行为才会触发 e.preventDefault）</p>
<p>e.dataTransfer.setData(attr, value’);<br>e.dataTransfer.getData(attr);</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  <span class="comment">#ball1 &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 40px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background: rgb(72, 25, 133);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;div id=<span class="string">"ball1"</span> draggable=<span class="string">"true"</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  var oBall1 = document.getElementById(<span class="string">'ball1'</span>);</span><br><span class="line">  oBall1.addEventListener(<span class="string">'dragstart'</span>, (e) =&gt; &#123;</span><br><span class="line">    e.dataTransfer.setData(<span class="string">'text'</span>, <span class="string">'测试'</span>);</span><br><span class="line">    console.log(<span class="string">'dragstart'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  oBall1.addEventListener(<span class="string">'dragend'</span>, (e) =&gt; &#123;</span><br><span class="line">    console.log(<span class="string">'dragend'</span>, e.dataTransfer.getData(<span class="string">'text'</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">  oBall1.addEventListener(<span class="string">'dragover'</span>, (e) =&gt; &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    console.log(<span class="string">'dragover'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  oBall1.addEventListener(<span class="string">'dragenter'</span>, () =&gt; &#123;</span><br><span class="line">    console.log(<span class="string">'dragenter'</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  oBall1.addEventListener(<span class="string">'drop'</span>, (e) =&gt; &#123;</span><br><span class="line">    console.log(<span class="string">'drop'</span>, e.dataTransfer.getData(<span class="string">'text'</span>));</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h4 id="拖拽上传文件"><a href="#拖拽上传文件" class="headerlink" title="拖拽上传文件"></a>拖拽上传文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">oBall1.addEventListener(&apos;dragover&apos;, (e) =&gt; &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  console.log(&apos;dragover&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">oBall1.addEventListener(&apos;dragenter&apos;, () =&gt; &#123;</span><br><span class="line">  console.log(&apos;dragenter&apos;);</span><br><span class="line">&#125;);</span><br><span class="line">oBall1.addEventListener(&apos;drop&apos;, (e) =&gt; &#123;</span><br><span class="line">  e.preventDefault();</span><br><span class="line">  console.log(e.dataTransfer.files, &apos;123&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">FileList &#123;</span><br><span class="line">  0: File &#123;</span><br><span class="line">    lastModified: 1595569605192</span><br><span class="line">    lastModifiedDate: Fri Jul 24 2020 13:46:45 GMT+0800 (中国标准时间) &#123;&#125;</span><br><span class="line">    name: &quot;1.png&quot;</span><br><span class="line">    size: 158520</span><br><span class="line">    type: &quot;image/png&quot;</span><br><span class="line">    webkitRelativePath: &quot;&quot;</span><br><span class="line">    __proto__: File</span><br><span class="line">  &#125;,</span><br><span class="line">  length: 1</span><br><span class="line">  __proto__: FileList</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  <span class="comment">#ball2,  #ball3, .ball4 &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 40px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    background-color: rgb(133, 59, 25);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">#ball2 &#123;</span></span><br><span class="line">    background-color: rgb(72, 25, 133);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">#ball3 &#123;</span></span><br><span class="line">    background-color: rgb(25, 108, 133);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">#bow &#123;</span></span><br><span class="line">    position: relative;</span><br><span class="line">    width: 400px;</span><br><span class="line">    height: 400px;</span><br><span class="line">    border: 1px solid rgb(72, 25, 133);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"ball2"</span> draggable=<span class="string">"true"</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;div id=<span class="string">"ball3"</span> draggable=<span class="string">"true"</span>&gt;&lt;/div&gt;</span><br><span class="line">&lt;div class=<span class="string">"ball4"</span> draggable=<span class="string">"true"</span>&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div id=<span class="string">"bow"</span>&gt;快到碗里来&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  const oBow = document.getElementById(<span class="string">'bow'</span>);</span><br><span class="line"></span><br><span class="line">  window.addEventListener(<span class="string">'dragstart'</span>, (e) =&gt; &#123;</span><br><span class="line">    console.log(<span class="string">'123'</span>);</span><br><span class="line">    e.dataTransfer.setData(<span class="string">'domID'</span>, e.target.id);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  oBow.addEventListener(<span class="string">'dragover'</span>, (e) =&gt; &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  oBow.addEventListener(<span class="string">'drop'</span>, (e) =&gt; &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    const id = e.dataTransfer.getData(<span class="string">'domID'</span>);</span><br><span class="line">    <span class="keyword">if</span> (id) &#123;</span><br><span class="line">      const oDom = document.getElementById(id);</span><br><span class="line">      oBow.appendChild(oDom);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2）-FileReader-用于读取文件"><a href="#2）-FileReader-用于读取文件" class="headerlink" title="2） FileReader 用于读取文件"></a>2） FileReader 用于读取文件</h3><ol>
<li><p>FileReader的方法<br>abort() 终止读取<br>readAsBinaryString(file) 将文件读取为二进制编码<br>readAsDataURL(file)  将文件读取为DataURL编码<br>readAsText(file, []encoding) 将文件读取为文本<br>readAsArrayBuffer(file) 将文件读取为arraybuffer</p>
</li>
<li><p>FileReader的事件<br>onloadstart 读取开始时触发<br>onprogress 读取中<br>onloadend 读取完成时触发（无论成功失败）<br>onload 文件读取成功完成时触发<br>onabort 中断时触发<br>onerror 出错时触发</p>
</li>
<li><p>获取读取的结果<br>fr.onload = function(){this.result;}</p>
</li>
</ol>
<h4 id="demo-读取文件"><a href="#demo-读取文件" class="headerlink" title="demo: 读取文件"></a>demo: 读取文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">'#'</span>&gt;</span><br><span class="line">    &lt;filedset&gt;</span><br><span class="line">      &lt;legend&gt;读取文件&lt;/legend&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">'file'</span> id=<span class="string">'File'</span> /&gt;</span><br><span class="line">      &lt;input <span class="built_in">type</span>=<span class="string">'button'</span> value=<span class="string">'中断'</span> id=<span class="string">'Abort'</span> /&gt;</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;lable&gt;读取进度：&lt;/lable&gt;</span><br><span class="line">        &lt;progress id=<span class="string">'Progress'</span> value=<span class="string">'0'</span> max=<span class="string">'100'</span>&gt;&lt;/progress&gt;</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">    &lt;/filedset&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">  &lt;!-- 文件读取模块 --&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    var FileLoader = <span class="keyword">function</span> (file, events) &#123;</span><br><span class="line">      this.reader = new FileReader(); //传建一个FileREader对象</span><br><span class="line">      this.file = file;</span><br><span class="line">      this.loaded = 0;</span><br><span class="line">      this.total = file.size;</span><br><span class="line">      this.step = 1024*1024; //每次读取1M</span><br><span class="line">      this.events = events || &#123;&#125;;</span><br><span class="line">      this.readBlob(0);  // 读取第一块</span><br><span class="line">      this.bindEvent();</span><br><span class="line">    &#125;;</span><br><span class="line">    FileLoader.prototype = &#123;</span><br><span class="line">      bindEvent: <span class="keyword">function</span>(events) &#123;</span><br><span class="line">        var _this = this;</span><br><span class="line">        var reader = this.reader;</span><br><span class="line">        reader.onload = <span class="keyword">function</span>(e)&#123;</span><br><span class="line">          _this.onLoad();</span><br><span class="line">        &#125;;</span><br><span class="line">        reader.onprogress = <span class="keyword">function</span>(e) &#123;</span><br><span class="line">          _this.onProgress(e.loaded);</span><br><span class="line">        &#125;;</span><br><span class="line">        // start，abort，error回调暂时不加</span><br><span class="line">      &#125;,</span><br><span class="line">      onLoad: <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">        var handler = this.events.load;</span><br><span class="line">        handler &amp;&amp; handler(this.reader.result); // 应该在这里发送读取的数据</span><br><span class="line">        console.log(this.loaded, this.total, <span class="string">'🍉'</span>);</span><br><span class="line">        <span class="keyword">if</span>(this.loaded &lt; this.total) &#123; // 如果未读取完毕则继续读取</span><br><span class="line">          this.readBlob(this.loaded);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          this.loaded = this.total;</span><br><span class="line">          this.events.success &amp;&amp; this.events.success();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      onProgress: <span class="keyword">function</span>(loaded) &#123;</span><br><span class="line">        var parent;</span><br><span class="line">        var handler = this.events.progress;</span><br><span class="line">        this.loaded += loaded;</span><br><span class="line">        percent = (this.loaded / this.total) * 100;</span><br><span class="line">        handler &amp;&amp; handler(percent);</span><br><span class="line">      &#125;,</span><br><span class="line">      readBlob: <span class="keyword">function</span> (start) &#123; // 读取文件内容</span><br><span class="line">        var blob, file = this.file;</span><br><span class="line">        <span class="keyword">if</span> (file.slice) &#123;</span><br><span class="line">          blob = file.slice(start, start + this.step);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          blob = file;</span><br><span class="line">        &#125;</span><br><span class="line">        this.reader.readAsText(blob);</span><br><span class="line">      &#125;,</span><br><span class="line">      abort: <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">        var reader = this.reader;</span><br><span class="line">        <span class="keyword">if</span> (reader) &#123;</span><br><span class="line">          reader.abort();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    var progress = document.getElementById(<span class="string">'Progress'</span>);</span><br><span class="line">    var events = &#123;</span><br><span class="line">      load: <span class="function"><span class="title">function</span></span>()&#123;console.log(<span class="string">'loaded'</span>);&#125;,</span><br><span class="line">      progress: <span class="keyword">function</span>(percent)&#123;console.log(percent);progress.value=percent;&#125;,</span><br><span class="line">      success:  <span class="function"><span class="title">function</span></span>()&#123;console.log(<span class="string">'success'</span>);&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    var loader;</span><br><span class="line">    // 选择好要上传的文件后，触发onchange事件</span><br><span class="line">    document.getElementById(<span class="string">'File'</span>).onchange = <span class="keyword">function</span> (e) &#123;</span><br><span class="line">      var file = this.files[0];</span><br><span class="line">      console.log(<span class="string">'首选获取文件：'</span>, file);</span><br><span class="line"></span><br><span class="line">      loader = new FileLoader(file, events);</span><br><span class="line">    &#125;;</span><br><span class="line">    document.getElementById(<span class="string">'Abort'</span>).onclick = <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">      loader.abort();</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="3）-WebSocket"><a href="#3）-WebSocket" class="headerlink" title="3） WebSocket"></a>3） WebSocket</h3><ul>
<li><p>WebSocket 对象提供一组API，用于创建和管理WebSocket连接，以及通过连接发送和接收数据。<br>新协议，为了兼容现有浏览器的握手规范，借用了HTTP的协议完成握手，跟HTTP协议基本没有关系。</p>
</li>
<li><p>产生原因：</p>
<pre><code>在HTTP 1.0中，大多实现为每个请求/响应交换使用新的连接
在HTTP 1.1中，一个连接可用于一次或多次请求/响应交换
HTTP协议中，服务器端不能主动联系客户端，只能由客户端发起请求。
webSocket中，服务器端和客户端均可主动发送数据。
</code></pre></li>
<li><p>建立连接的握手：当web应用程序调用new WebSocket(url)接口时，Browser就开始与地址url的WebSocket建立握手连接的过程。</p>
<ol>
<li>Browser与WebSocket服务器通过TCP握手建立连接，如果这个建立连接失败，那么后面过程就不会执行，Web应用程序将收到错误消息通知。</li>
<li>在TCP建立成功连接后，Browser通过http协议传送WebSocket支持的版本号，协议的字版本号，原始地址、主机地址的等一系列字段给服务器端。</li>
<li>WebSocket服务器收到Browser发送来的请求后，如果数据包内容和格式正确，服务端和客户端的协议版本号匹配等等，就接受本次握手连接，并给出去相应的数据回复。同样回复的数据包也采用http协议传输。</li>
<li>Browser收到服务器回复的数据包后，如果数据包内容和格式都没有问题，就表示本次连接成功，触发onopen消息，此时web开发者就可以在此时通过WebSocket的send接口向服务器发送数据。否则，握手连接失败，Web应用程序会受到onerror消息，并且能知道连接失败的原因。</li>
</ol>
</li>
<li><p>三次握手</p>
<ol>
<li>建立连接时，客户端A发送SYN包（SYN=j）到服务器B，进入SYN_SEND状态，等待B确认。 （Synchronize Sequence Numbers）</li>
<li>服务器收到SYN包，必须确认客户端A的SYN(ACK=j+1)，同时自己也发送一个SYN包（SYN=k），即SYN+ACK包，此时服务器B进入STN_RECV状态。</li>
<li>客户端A收到服务器B的SYN+ACK包，向服务器B发送确认包ACK(ACK=k+1)。此包发送完毕，客户端A和服务器B进入ESTABLISHED状态，完成三次握手。</li>
</ol>
</li>
<li><p>创建webSockt   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var Socket = new WebSocked(url);</span><br></pre></td></tr></table></figure></p>
<p>WebSocket方法  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Socket.send(data);   // 传输数据</span><br><span class="line">Socket.close();      // 终止任何现有连接</span><br></pre></td></tr></table></figure></p>
<p>WebSocket事件  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Socket.onopen();     // 建立socket连接时触发</span><br><span class="line">Socket.onmessage();  // 客户端从服务器接收数据时触发</span><br><span class="line">Socket.onerror();    // 连接发生错误时触发</span><br><span class="line">Socket.onclose();    // 连接关闭时触发</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>WebSocket的优点<br>客户端与服务器都可以主动传送数据给对方。<br>不用频繁创建TCP请求及销毁请求，减少网络带宽资源占用，同时也节省服务器资源。</p>
</li>
<li><p>demo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// WeebSocket.org提供了一个专门用来测试WebSocket的服务器ws://echo.websocket.org/</span><br><span class="line">var socket = new WebSocket(<span class="string">'ws://echo.websocket.org/'</span>);</span><br><span class="line">socket.onopen=<span class="keyword">function</span>(e)&#123;</span><br><span class="line">  socket.send(<span class="string">'Test!'</span>, e);</span><br><span class="line">  socket.close();</span><br><span class="line">&#125;;</span><br><span class="line">socket.onclose=<span class="keyword">function</span>(e) &#123;</span><br><span class="line">  console.log(<span class="string">'close'</span>, e);</span><br><span class="line">&#125;;</span><br><span class="line">socket.onerror=<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">  console.log(<span class="string">'error'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="6、-离线缓存应用"><a href="#6、-离线缓存应用" class="headerlink" title="6、 离线缓存应用"></a><font color="#F33F50">6、 离线缓存应用</font></h2><h3 id="1）MVC"><a href="#1）MVC" class="headerlink" title="1）MVC"></a>1）MVC</h3><p>M 模型 Model 代表业务数据和业务逻辑。封装数据操作，通知控制器调用视图部分将数据更新。一个模型能为多个数据提供数据，提高了应用的可重用性。<br>V 视图 View 显示模型数据，接收用户的输入并发送给控制器，但是它并不进行任何实际的业务处理。<br>C 控制器 Control 通过view来接收用户输入，之后利用Model来处理用户输入，最后把结果返回给view。Control就是View和Model之间的一个协调者，控制者。</p>
<h3 id="2）涉及的H5技术"><a href="#2）涉及的H5技术" class="headerlink" title="2）涉及的H5技术"></a>2）涉及的H5技术</h3><ul>
<li>Local storage &amp; session storage 键值对存储数据</li>
<li>Application Cache 本地缓存应用所需的文件</li>
<li>Web SQL 关系数据库</li>
</ul>
<h4 id="1-Web-存储"><a href="#1-Web-存储" class="headerlink" title="1. Web 存储"></a>1. Web 存储</h4><p>local Storage，没有时间限制的数据存储<br>session Storage，针对一个session的数据存储</p>
<h4 id="2-Application-Cache"><a href="#2-Application-Cache" class="headerlink" title="2. Application Cache"></a>2. Application Cache</h4><p>应用程序缓存（Application Cache），用户缓存web应用的部分资源，从而达到没有互联网的情况下也可以进行访问。</p>
<p>优势： 离线浏览，用户可在应用里不连接网络时使用它们<br>      速度，已缓存资源的加载速度更快<br>      减少服务器负载，浏览器将只从服务器下载更新过或更改过的资源</p>
<p>浏览器上只需要设置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html manifest=&apos;demo.cache&apos;&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p>Mainfest文件可分为三部分：<br>CACHE MANIFEST 在首次下载后进行缓存<br>NETWORK        需要与服务器连接，且不会被缓存<br>FALLBACK       当页面无法访问时的回退页面（比如404页面）</p>
<p>服务器端需维护一个mainfest清单<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CACHE MANIFEST:</span><br><span class="line"><span class="comment"># 2016-11-13 v1.0.0 注释</span></span><br><span class="line">theme.css</span><br><span class="line">logo.giff</span><br><span class="line">main.js</span><br><span class="line"></span><br><span class="line">NETWORK:(*)</span><br><span class="line">login.png</span><br><span class="line"></span><br><span class="line">FALLBACK:</span><br><span class="line">*.html/404.html</span><br></pre></td></tr></table></figure></p>
<p>配置正确的MIME-type：mainfest文件需配置正确的MIME-type,即“text/cache-mainfest”，必须在Web服务器上进行配置，同服务器不一样。</p>
<h4 id="3-Web-SQL"><a href="#3-Web-SQL" class="headerlink" title="3. Web SQL"></a>3. Web SQL</h4><ol>
<li><p>openDatabase<br>使用现有数据库或新建数据库来创建数据库对象。<br>openDatabase(“APP”, “1.0”, “Not the FT Web App”, (5<em>1024</em>1024));<br>数据库名称   数据库版本号     对数据库的描述     数据库存储大小  回调函数（可选）</p>
</li>
<li><p>transaction<br>这个方法允许我们根据情况控制事务提交或回滚。<br>smallDatabase.transaction(querysql, errorCallback, successCallback);<br>包含事务内容的一个方法（querysql中任何一句sql语句出错，都会回滚），<br>出错回调函数（可选），成功回调函数（可选）。</p>
</li>
<li><p>executeSql<br>用于执行SQL查询。<br>tx.executeSql(query, data[],innerSuccessCallback, errorCallback);<br>表示查询的字符串，使用的SQL语言是SQLite 3.6.19（必选），<br>插入到查询中问号所在处的字符串数据（可选），<br>成功时执行的回调函数，返回两个参数：tx和执行的结果（可选），<br>失败时执行的回调函数（可选）。</p>
</li>
</ol>
<h3 id="3）-离线缓存应用"><a href="#3）-离线缓存应用" class="headerlink" title="3） 离线缓存应用"></a>3） 离线缓存应用</h3><h4 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h4><ol>
<li><p>创建一个本地数据库 &amp; 建表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">smallDatabase = openDatabase(&quot;APP&quot;, &quot;1.0&quot;, &quot;Not The FT Web App&quot;, (5*1024*1024));</span><br><span class="line"></span><br><span class="line">smallDatabase.transaction(function(tx)&#123;</span><br><span class="line">  for(i=0, l=data.length; i&lt;l; i++) &#123;</span><br><span class="line">    tx.executeSql(query, data[i], innerSuccessCallback, errorCallback);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示逻辑<br>建库建表后，绑定hashChange事件，加载主体结构（主标题和#body标签），移除loading。</p>
<blockquote>
<p>绑定hashChange事件<br>1）!hash，装载页面，查询数据，显示文章列表，设置刷新功能。<br>调用template.home将刷新按钮和headlines标签装载在#body标签中，调用articlesController.showArticleList在表中找到所有的id，headline，author，date，成功后调用templates.articleList显示在headline中。<br>点击刷新按钮，如果在线，请求接口（articleController.synchronizeWithServer），删除旧数据（article.deleteArticles）把返回来的新数据插入表中（article.insertAritcles），成功后更新首页文章列表（templates.articleList）。如果离线，则给出提示（offlineWarning），不刷新数据。</p>
<p>2）如果hash &amp;&amp; hash&gt;0,则显示对应的文章详情。<br>  articlesController.showArticle(id) -&gt; article.selectFullArticles -&gt; database.runQuery(“SELECT id, headline, date, author, body FROM articles WHERE id=?”…) -&gt; #body templates.article(article)</p>
<p>3） 如果hash &amp;&amp; hash&gt;0,则提示未找到相应的页面(pageNotFound)。</p>
</blockquote>
</li>
</ol>
<h4 id="SQL-语句"><a href="#SQL-语句" class="headerlink" title="SQL 语句"></a>SQL 语句</h4><p>CREATE TABLE IF NOT EXISTS articles (id INTEGER PRIMARY KEY ASC, date TIMESTAMP, author TEXT, headline TEXT, body TEXT)<br>DELETE FROM ARTICLES<br>INSERT INTO articles (id, date, headline, author, body) VALUES (?, ?, ?, ?, ?)<br>SELECT id, headline, date, author, body FROM articles WHERE id=?<br>DROP TABLE articles</p>
<!-- 
  一级 #DC143C
  二级 #F33F50

  显色 #FC5603
-->

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/background22.jpg" alt="Lemon">
            
              <p class="site-author-name" itemprop="name">Lemon</p>
              <p class="site-description motion-element" itemprop="description">乘风破浪</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lemon</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
